<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>ç»™Gitä¸Šä¸ªä»£ç†è¯•è¯•æé€Ÿ</title>
    <url>/2020/05/03/20200503-git-add-proxy/</url>
    <content><![CDATA[<h1 id="ç»™GITç”¨ä¸Šä»£ç†"><a href="#ç»™GITç”¨ä¸Šä»£ç†" class="headerlink" title="ç»™GITç”¨ä¸Šä»£ç†"></a>ç»™GITç”¨ä¸Šä»£ç†</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨çœ‹ç€æ•™ç¨‹æ­å»ºè¿™ä¸ªåšå®¢çš„æ—¶å€™ï¼Œæˆ‘åœ¨GITä¸Šä¹Ÿæ‹–äº†ä¸å°‘çš„åŒ…ã€‚ç›´è¿æœ‰æ—¶å€™çœŸçš„é€Ÿåº¦æ…¢åˆ°åè¡€ï¼ŒåŸå› å¾ˆå¤æ‚ä¹Ÿè«å¾—åŠæ³•ã€‚<br>ä¸è¿‡è¿˜å¥½ï¼Œæˆ‘ä»¬å…¶å®å¯ä»¥ç»™GITä¸Šä¸ªä»£ç†ï¼Œè¿™æ ·èƒ½ç»™é€Ÿåº¦ä¸€äº›æ”¹å–„ã€‚</p>
<h2 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h2><p>æˆ‘æ˜¯åœ¨æœ¬æœºå™¨å®‰è£…æœ‰ä»£ç†å®¢æˆ·ç«¯ï¼Œå°ğŸ›©å’ŒV2éƒ½å½³äºã€‚<br>æˆ‘è¿™è¾¹çš„æƒ…å†µæ˜¯è¿™æ ·çš„ï¼Œå°é£æœºèµ°SOCK5ä»£ç†ï¼ŒV2èµ°çš„HTTPä»£ç†ã€‚<br>å› ä¸ºå¹³æ—¶æˆ‘åªå¯èƒ½å¼€ç€ä¸€ä¸ªï¼Œæ‰€ä»¥ç«¯å£éƒ½æ˜¯1080ã€‚</p>
<h2 id="å‘½ä»¤"><a href="#å‘½ä»¤" class="headerlink" title="å‘½ä»¤"></a>å‘½ä»¤</h2><p>åºŸè¯ä¸å¤šè¯´äº†ï¼Œç›´æ¥ä¸Šå‘½ä»¤ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬çœ‹çœ‹å·²æœ‰çš„è®¾ç½®.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å…¨å±€é…ç½®ä¸­çš„ä»£ç†</span></span><br><span class="line">git config --global --get http.proxy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å½“å‰ç”Ÿæ•ˆé…ç½®ä¸­çš„ä»£ç†</span></span><br><span class="line">git config --get http.proxy</span><br></pre></td></tr></table></figure>
<p>ç„¶åæˆ‘ä»¬åŠ ä¸Šè‡ªå·±çš„ä»£ç†ã€‚<br>å½“å‰æˆ‘ä»¬å‡è®¾çš„çŠ¶æ€æ˜¯æœ¬æœºå¼€ç€å°âœˆæˆ–è€…V2ï¼Œä¸”ä»£ç†ç«¯å£ä¸º1080çš„æƒ…å†µã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ‹¬å·ä¸­çš„éƒ½æ˜¯å¯é€‰é¡¹</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è‹¥ç”¨çš„å°é£æœº, --global æ„å‘³ç€åº”ç”¨åˆ°å…¨å±€è®¾ç½®</span></span><br><span class="line">git config (--global) http.proxy sock5://127.0.0.1:1080</span><br><span class="line">git config (--global) https.proxy sock5://127.0.0.1:1080</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™æ ·åº”ç”¨åï¼Œæ²¡å¼€ä»£ç†GITå°±ä¼šæŠ½é£äº†ï¼Œæ‰€ä»¥å¦‚æœå¹³æ—¶é€Ÿåº¦è¿˜ä¸é”™çš„è¯è®°å¾—ç”¨å®Œå–æ¶ˆä»£ç†</span></span><br><span class="line">git config (--global) --<span class="built_in">unset</span> http.proxy (sock5://127.0.0.1:1080)</span><br><span class="line">git config (--global) --<span class="built_in">unset</span> https.proxy (sock5://127.0.0.1:1080)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è‹¥ç”¨çš„V2, --global æ„å‘³ç€åº”ç”¨åˆ°å…¨å±€è®¾ç½®</span></span><br><span class="line">git config (--global) http.proxy  http://127.0.0.1:1080</span><br><span class="line">git config (--global) https.proxy https://127.0.0.1:1080</span><br><span class="line"></span><br><span class="line"><span class="comment"># å–æ¶ˆ</span></span><br><span class="line">git config (--global) --<span class="built_in">unset</span> http.proxy  ï¼ˆhttp://127.0.0.1:1080ï¼‰</span><br><span class="line">git config (--global) --<span class="built_in">unset</span> https.proxy ï¼ˆhttps://127.0.0.1:1080ï¼‰</span><br></pre></td></tr></table></figure>
<p>æŒ‚äº†ä»£ç†çœŸçš„é£é€Ÿï¼Œçˆ½åˆ°ã€‚</p>
]]></content>
      <categories>
        <category>Git</category>
      </categories>
      <tags>
        <tag>Git</tag>
        <tag>Misc</tag>
      </tags>
  </entry>
  <entry>
    <title>ç»™Unityä¸Šä»£ç†</title>
    <url>/2020/05/18/20200518-unity-hub-w-proxy/</url>
    <content><![CDATA[<h1 id="ç»™Unityç”¨ä¸Šä»£ç†"><a href="#ç»™Unityç”¨ä¸Šä»£ç†" class="headerlink" title="ç»™Unityç”¨ä¸Šä»£ç†"></a>ç»™Unityç”¨ä¸Šä»£ç†</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä¹‹å‰æœ‰æ®µæ—¶é—´å…¬å¸çš„ç½‘ç»œä¸æ˜¯å¾ˆç¨³å®šï¼Œä»UnityHubä¸Šæ‹–ä¸œè¥¿99%å¤±è´¥ã€‚è‡ªå·±åˆå¤ªèœä¸æƒ³å®‰è£…Android Studioæ‰‹åŠ¨è®¾ç½®å®‰å“æ‰“åŒ…çš„ä¸œè¥¿ï¼Œäºæ˜¯ä¹åªèƒ½æƒ³åŠæ³•ç»™ä¸‹è½½åŠ é€Ÿã€‚</p>
<h2 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h2><p>é¦–å…ˆä½ è¦æœ‰é‚£ä¸ªï¼Œå°±æ˜¯é‚£ä¸ªä½ ä¸ºäº†çœ‹PHæ‰å¼„çš„å°å·¥å…·ï¼šï¼‰</p>
<h2 id="å‘½ä»¤"><a href="#å‘½ä»¤" class="headerlink" title="å‘½ä»¤"></a>å‘½ä»¤</h2><p>é¦–å…ˆé»˜è®¤æˆ‘ä»¬çš„å°âœˆä»£ç†ç«¯å£æ˜¯1080ã€‚<br>ä¼¼ä¹V2å¯ä»¥åŒæ—¶æœ‰SOCK5å’ŒHTTPä»£ç†çš„æ ·å­ï¼Œé‚£ä¹ŸæŠŠHTTPä»£ç†çš„ç«¯å£è®¾ç½®æˆ1080.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®ä»£ç†</span></span><br><span class="line"><span class="built_in">set</span> HTTP_PROXY=http://127.0.0.1:1080</span><br><span class="line"><span class="built_in">set</span> HTTPS_PROXY=http://127.0.0.1:1080</span><br><span class="line"></span><br><span class="line">start <span class="string">""</span> <span class="string">"your unity hub path"</span></span><br><span class="line"><span class="comment"># like path is like -&gt; D:\Unity\Unity Hub\Unity Hub.exe</span></span><br></pre></td></tr></table></figure>
<h2 id="çˆ†ç‚¸"><a href="#çˆ†ç‚¸" class="headerlink" title="çˆ†ç‚¸"></a>çˆ†ç‚¸</h2><p>éå¸¸ç®€å•å°±æ˜¯è¿™æ ·ã€‚</p>
<p>å…¶å®ä¸œè¥¿éƒ½æ˜¯ä»æœ‰æœ¨æ¡‘åšå®¢çœ‹æ¥çš„<br><a href="https://www.yomunchan.moe/archives/320" target="_blank" rel="noopener">https://www.yomunchan.moe/archives/320</a></p>
<p>è¿™è¾¹æœ‰è›®å¤šæ¸¸æˆå¼€å‘ç›¸å…³çš„æ–‡ç« ï¼Œå¸®äº†æˆ‘ä¸å°‘ï¼Œååˆ†æ„Ÿè°¢äº†ã€‚</p>
]]></content>
      <tags>
        <tag>Misc</tag>
      </tags>
  </entry>
  <entry>
    <title>æ‘¸ä¸€ä¸ªç®€å•çš„ Unity Log Console (1)</title>
    <url>/2020/05/31/20200531-CloneUnityConsole1/</url>
    <content><![CDATA[<p>æœ¬èœç‹—åœ¨ä¸Šå‘¨é¢†äº†ä¸€ä¸ªåšLogManagerçš„ä»»åŠ¡ã€‚å¾ˆé«˜å…´ä¹Ÿå¾ˆæ…Œï¼Œæ¯•ç«Ÿä»æ¥æ²¡åšè¿‡ç¼–è¾‘å™¨å¼€å‘ï¼Œäºæ˜¯é¢å‘æœç´¢å¼•æ“ç¼–ç¨‹å¼€å§‹è¾£ï¼Œæ‰¾äº†ä¸€äº›æ•™ç¨‹å­¦ç€åšï¼Œé¡ºä¾¿åˆ†äº«ä¸€ä¸‹ã€‚</p>
<h1 id="éœ€æ±‚åˆ†æï¼ˆï¼Ÿ"><a href="#éœ€æ±‚åˆ†æï¼ˆï¼Ÿ" class="headerlink" title="éœ€æ±‚åˆ†æï¼ˆï¼Ÿ"></a>éœ€æ±‚åˆ†æï¼ˆï¼Ÿ</h1><p>ç»„é‡Œå¯¹è¿™ä¸ªLogManagerçš„è¦æ±‚æ˜¯åœ¨UnityåŸæ¥çš„LogåŠŸèƒ½ä¸Šå†åŠ ä¸Šæ ¹æ®æ ‡ç­¾å’Œå±é™©åº¦(?)æ¥ç­›é€‰ã€‚<br>ä»”ç»†æƒ³æƒ³è¿˜æŒºéº»çƒ¦ã€‚éœ€è¦ç­›é€‰çš„è¯ï¼Œé‚£è‡ªç„¶éœ€è¦ä¸€ä¸ªConsoleé¢æ¿ï¼Œä¼¼ä¹UnityåŸæœ¬çš„Consoleä¸æ–¹ä¾¿æ‰©å±•ï¼Œç´¢æ€§è·Ÿç€ç½‘ä¸Šçš„æ•™ç¨‹é‡æ–°åšä¸€ä¸ªã€‚</p>
<h1 id="å¼¹å‡ºçª—å£"><a href="#å¼¹å‡ºçª—å£" class="headerlink" title="å¼¹å‡ºçª—å£"></a>å¼¹å‡ºçª—å£</h1><p>é¦–å…ˆæˆ‘ä»¬å…ˆæŠŠçª—å£å¼¹å‡ºæ¥ã€‚ä»£ç å¾ˆç®€å•ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ä»Unityå¤´é¡¶çš„èœå•æ ä¸­çš„Windowä¸­æ‰¾åˆ°è¿™ä¸ªé¢æ¿å¹¶æ‰“å¼€ã€‚æ‰“å¼€äº†æ˜¯ç©ºç™½çš„ï¼Œå½“ç„¶å•¦ï¼Œå› ä¸ºè¿˜ä»€ä¹ˆéƒ½æ²¡ç”»ä¸Šå»ã€‚</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TempConsoleWindow</span> : <span class="title">EditorWindow</span></span><br><span class="line">&#123;</span><br><span class="line">	[<span class="meta">MenuItem(<span class="meta-string">"Window/Temp Console"</span>)</span>]</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">OpenWindow</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>	&#123;</span><br><span class="line">		TempConsoleWindow window = GetWindow&lt;TempConsoleWindow&gt;();</span><br><span class="line">		GUIContent titleContent = <span class="keyword">new</span> GUIContent(<span class="string">"TempConsole"</span>, EditorGUIUtility.Load(<span class="string">"icons/UnityEditor.ConsoleWindow.png"</span>) <span class="keyword">as</span> Texture2D, <span class="string">"a clone sonsole"</span>);</span><br><span class="line">		window.titleContent = titleContent;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="åˆ†å‰²åŒºå—"><a href="#åˆ†å‰²åŒºå—" class="headerlink" title="åˆ†å‰²åŒºå—"></a>åˆ†å‰²åŒºå—</h1><img src="/2020/05/31/20200531-CloneUnityConsole1/20200531-Unity01.png" class="" title="split">
<p>æˆ‘ä»¬æŠŠåŸæœ¬çš„é¢æ¿åˆ†æˆ4å—ï¼š1.èœå•æ ï¼›2. LogåŒºï¼›3. è°ƒæ•´æ£’(ä¸Šä¸‹ç§»åŠ¨è°ƒæ•´åŒºåŸŸå¤§å°)ï¼›4. è¯¦æƒ…åŒºã€‚äºæ˜¯ä¹æˆ‘ä»¬ç»™è¿™ä¸ª4ä¸ªåŒºåˆ›å»ºå“åº”çš„å˜é‡ä¸ºäº†æ–¹ä¾¿ç»˜åˆ¶ã€‚</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> Rect m_menuUpperBar = <span class="keyword">default</span>;</span><br><span class="line"><span class="keyword">private</span> Rect m_upperPanel = <span class="keyword">default</span>;</span><br><span class="line"><span class="keyword">private</span> Rect m_lowerPanel = <span class="keyword">default</span>;</span><br><span class="line"><span class="keyword">private</span> Rect m_resizer = <span class="keyword">default</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">readonly</span> <span class="keyword">float</span> MENU_BAR_HEIGHT = <span class="number">20.0f</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">float</span> m_upperSizeRatio = <span class="number">0.5f</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">readonly</span> <span class="keyword">float</span> RESIZER_HEIGHT = <span class="number">4.0f</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">float</span> PanelGroupHeight =&gt; position.height - MENU_BAR_HEIGHT;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">bool</span> m_isResizing = <span class="literal">false</span>;</span><br></pre></td></tr></table></figure>
<h1 id="å·çš®"><a href="#å·çš®" class="headerlink" title="å·çš®"></a>å·çš®</h1><p>Unityçš„ç»˜åˆ¶GUIæ–¹æ³•ä¸­å¯ä»¥å¡«å†™é£æ ¼å‚æ•°ï¼Œæˆ‘ä»¬ç»˜åˆ¶å››ä¸ªåŒºå—çš„æ—¶å€™è‡ªç„¶ä¹Ÿéœ€è¦ä¸ºåŒºå—å‡†å¤‡çš®å’Œæ–‡å­—é¢œè‰²ã€‚</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// logåŒºé£æ ¼ä»¥åŠlogåŒºçš„æ ‡é¢˜é£æ ¼</span></span><br><span class="line"><span class="keyword">private</span> GUIStyle m_panelLabelStyle = <span class="keyword">default</span>;</span><br><span class="line"><span class="keyword">private</span> GUIStyle m_panelStyle = <span class="keyword">default</span>;</span><br><span class="line"><span class="comment">// è°ƒæ•´æ£’å„¿çš„é£æ ¼</span></span><br><span class="line"><span class="keyword">private</span> GUIStyle m_resizerStyle = <span class="keyword">default</span>;</span><br><span class="line"><span class="comment">// box item å…¶å®æ˜¯åœ¨logåŒºæ˜¾ç¤ºçš„æ¯ä¸€ä¸ªlog item</span></span><br><span class="line"><span class="keyword">private</span> GUIStyle m_boxItemStyle = <span class="keyword">default</span>;</span><br><span class="line"><span class="comment">// è¿™æ˜¯ logè¯¦æƒ…çš„æ–‡å­—é£æ ¼</span></span><br><span class="line"><span class="keyword">private</span> GUIStyle m_textAreaStyle = <span class="keyword">default</span>;</span><br><span class="line"><span class="comment">// è¿™æ˜¯ä¸€ä¸ªæ— è¾¹æ¡†çš„æŒ‰é’®é£æ ¼ï¼Œä¸ºä»£ç è·³è½¬å‡†å¤‡</span></span><br><span class="line"><span class="keyword">private</span> GUIStyle m_labelButtonStyle = <span class="keyword">default</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å„ç§å›¾æ ‡</span></span><br><span class="line"><span class="keyword">private</span> Texture2D m_infoIcon = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">private</span> Texture2D m_infoIconSmall = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">private</span> Texture2D m_warningIcon = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">private</span> Texture2D m_warningIconSmall = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">private</span> Texture2D m_errorIcon = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">private</span> Texture2D m_errorIconSmall = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> Texture2D m_boxBgOdd = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">private</span> Texture2D m_boxBgEven = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">private</span> Texture2D m_boxBgSelected = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">private</span> Texture2D m_boxIcon = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–å„ç§çš®</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">GetAssets</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    m_panelLabelStyle = <span class="keyword">new</span> GUIStyle();</span><br><span class="line">    m_panelLabelStyle.fixedHeight = <span class="number">30.0f</span>;</span><br><span class="line">    m_panelLabelStyle.richText = <span class="literal">true</span>;</span><br><span class="line">    m_panelLabelStyle.normal.textColor = Color.white;</span><br><span class="line">    m_panelLabelStyle.fontSize = <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line">    m_infoIcon = EditorGUIUtility.Load(<span class="string">"icons/console.infoicon.png"</span>) <span class="keyword">as</span> Texture2D;</span><br><span class="line">    m_infoIconSmall = EditorGUIUtility.Load(<span class="string">"icons/console.infoicon.sml.png"</span>) <span class="keyword">as</span> Texture2D;</span><br><span class="line">    m_warningIcon = EditorGUIUtility.Load(<span class="string">"icons/console.warnicon.png"</span>) <span class="keyword">as</span> Texture2D;</span><br><span class="line">    m_warningIconSmall = EditorGUIUtility.Load(<span class="string">"icons/console.warnicon.sml.png"</span>) <span class="keyword">as</span> Texture2D;</span><br><span class="line">    m_errorIcon = EditorGUIUtility.Load(<span class="string">"icons/console.erroricon.png"</span>) <span class="keyword">as</span> Texture2D;</span><br><span class="line">    m_errorIconSmall = EditorGUIUtility.Load(<span class="string">"icons/console.erroricon.sml.png"</span>) <span class="keyword">as</span> Texture2D;</span><br><span class="line"></span><br><span class="line">    m_resizerStyle = <span class="keyword">new</span> GUIStyle();</span><br><span class="line"></span><br><span class="line">    m_panelStyle = <span class="keyword">new</span> GUIStyle();</span><br><span class="line">    m_panelStyle.normal.background = EditorGUIUtility.Load(<span class="string">"builtin skins/darkskin/images/projectbrowsericonareabg.png"</span>) <span class="keyword">as</span> Texture2D;</span><br><span class="line">    <span class="comment">// è¿™è¡Œæ˜¯åŒäº‹å‘Šè¯‰æˆ‘çš„ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸ç®¡ç”¨ï¼Œç›´æ¥ç”¨ä¼šæœ‰ç©ºå¼•ç”¨æŠ¥é”™ï¼Œè¦åœ¨GUIé‡Œç”¨</span></span><br><span class="line">    <span class="comment">// m_panelStyle.normal.background = GUI.skin.window.normal.background; </span></span><br><span class="line"></span><br><span class="line">    m_boxItemStyle = <span class="keyword">new</span> GUIStyle();</span><br><span class="line">    m_boxItemStyle.normal.textColor = <span class="keyword">new</span> Color(<span class="number">0.7f</span>, <span class="number">0.7f</span>, <span class="number">0.7f</span>);</span><br><span class="line"></span><br><span class="line">    m_boxBgOdd = EditorGUIUtility.Load(<span class="string">"builtin skins/darkskin/images/cn entrybackodd.png"</span>) <span class="keyword">as</span> Texture2D;</span><br><span class="line">    m_boxBgEven = EditorGUIUtility.Load(<span class="string">"builtin skins/darkskin/images/cnentrybackeven.png"</span>) <span class="keyword">as</span> Texture2D;</span><br><span class="line">    m_boxBgSelected = EditorGUIUtility.Load(<span class="string">"builtin skins/darkskin/images/menuitemhover.png"</span>) <span class="keyword">as</span> Texture2D;</span><br><span class="line"></span><br><span class="line">    m_textAreaStyle = <span class="keyword">new</span> GUIStyle();</span><br><span class="line">    m_textAreaStyle.normal.textColor = <span class="keyword">new</span> Color(<span class="number">0.9f</span>, <span class="number">0.9f</span>, <span class="number">0.9f</span>);</span><br><span class="line">    m_textAreaStyle.normal.background = EditorGUIUtility.Load(<span class="string">"builtin skins/darkskin/images/projectbrowsericonareabg.png"</span>) <span class="keyword">as</span> Texture2D;</span><br><span class="line"></span><br><span class="line">    m_labelButtonStyle = <span class="keyword">new</span> GUIStyle();</span><br><span class="line">    m_labelButtonStyle.normal.textColor = Color.green;</span><br><span class="line">    m_labelButtonStyle.normal.background = m_textAreaStyle.normal.background;</span><br><span class="line">    m_labelButtonStyle.alignment = TextAnchor.MiddleLeft;</span><br><span class="line">    m_labelButtonStyle.stretchWidth = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">var</span> b = m_labelButtonStyle.border;</span><br><span class="line">    b.left = <span class="number">0</span>;</span><br><span class="line">    b.right = <span class="number">0</span>;</span><br><span class="line">    b.top = <span class="number">0</span>;</span><br><span class="line">    b.bottom = <span class="number">0</span>;</span><br><span class="line">    m_labelButtonStyle.border = b;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnEnable</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    GetAssets();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è·å–å›¾åƒçš„å‚æ•°éƒ½æ˜¯magic numberï¼Œè¿™é‡Œä¸å¤šæã€‚å›¾æ ‡æµè§ˆå’Œè·å–å‚æ•°å¯ä»¥å‚è€ƒä¸‹é¢ä¸¤ä¸ªé¡µé¢ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥å‡†å¤‡è‡ªå·±çš„ç´ æã€‚</p>
<p><a href="https://unitylist.com/p/5c3/Unity-editor-icons" target="_blank" rel="noopener">https://unitylist.com/p/5c3/Unity-editor-icons</a><br><a href="https://gist.github.com/rus89/375e107ed8c6db79d0c41b8612e5dbf3" target="_blank" rel="noopener">https://gist.github.com/rus89/375e107ed8c6db79d0c41b8612e5dbf3</a></p>
<h1 id="ç»˜åˆ¶èœå•æ "><a href="#ç»˜åˆ¶èœå•æ " class="headerlink" title="ç»˜åˆ¶èœå•æ "></a>ç»˜åˆ¶èœå•æ </h1><p>èœå•æ ä¸Šæœ‰å‡ ä¸ªæŒ‰é’®ï¼Œæˆ‘ä»¬æŠŠæœ€å¸¸ç”¨çš„å¦‚æ¸…ç†ï¼ŒPlayå¼€å§‹æ¸…é™¤ä»¥åŠå³è¾¹ä¸‰ä¸ªFilteré€‰é¡¹ã€‚é™¤äº†â€™Clearâ€™æ˜¯Buttonï¼Œå…¶å®ƒçš„éƒ½æ˜¯Toggleã€‚æ‰€ä»¥å¾—å‡†å¤‡ä¸€äº›å¸ƒå°”å˜é‡ã€‚</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">bool</span> m_isClearOnPlay = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">bool</span> m_isClearOnBuild = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">bool</span> IsClearOnBuild =&gt; m_isClearOnBuild;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">bool</span> m_isErrorPause = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">bool</span> m_isShowLog = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">bool</span> m_isShowWarning = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">bool</span> m_isShowError = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> m_normalLogCount = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> m_warningLogCount = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> m_errorLogCount = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">private</span> HashSet&lt;LogType&gt; m_logTypeForUnshow = <span class="literal">null</span>;</span><br></pre></td></tr></table></figure>
<p>å‡†å¤‡å¥½äº†ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¼€å§‹ç»˜åˆ¶èœå•æ äº†ã€‚</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">DrawMenuUpperBar</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    m_menuUpperBar = <span class="keyword">new</span> Rect(<span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="keyword">this</span>.position.width, MENU_BAR_HEIGHT);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¼€å§‹ç»˜åˆ¶</span></span><br><span class="line">    GUILayout.BeginArea(m_menuUpperBar, EditorStyles.toolbar);</span><br><span class="line">    <span class="comment">// æ¨ªå‘ç»˜åˆ¶ï¼ï¼ï¼</span></span><br><span class="line">    GUILayout.BeginHorizontal();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (GUILayout.Button(<span class="keyword">new</span> GUIContent(<span class="string">"Clear"</span>), EditorStyles.toolbarButton, GUILayout.Width(<span class="number">40.0f</span>)))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ç”¨äºæ¸…ç©ºæ‰€æœ‰çš„ log</span></span><br><span class="line">        ClearLogs();</span><br><span class="line">    &#125;</span><br><span class="line">    GUILayout.Space(<span class="number">5.0f</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// m_isCollapse = GUILayout.Toggle(m_isCollapse, new GUIContent("Collapse"), EditorStyles.toolbarButton, GUILayout.Width(55.0f));</span></span><br><span class="line">    m_isClearOnPlay = GUILayout.Toggle(m_isClearOnPlay, <span class="keyword">new</span> GUIContent(<span class="string">"Clear On Play"</span>), EditorStyles.toolbarButton, GUILayout.Width(<span class="number">80.0f</span>));</span><br><span class="line">    m_isClearOnBuild = GUILayout.Toggle(m_isClearOnBuild, <span class="keyword">new</span> GUIContent(<span class="string">"Clear On Build"</span>), EditorStyles.toolbarButton, GUILayout.Width(<span class="number">85.0f</span>));</span><br><span class="line">    m_isErrorPause = GUILayout.Toggle(m_isErrorPause, <span class="keyword">new</span> GUIContent(<span class="string">"Error Pause"</span>), EditorStyles.toolbarButton, GUILayout.Width(<span class="number">70.0f</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¼¹æ€§ç©ºç™½ï¼Œæˆ‘ä¸å¤ªæ¸…æ¥šåº”è¯¥æ€ä¹ˆæè¿°ï¼Œä½†æ˜¯å®ƒå¯ä»¥æŠŠåé¢çš„å‡ ä¸ªToggleéƒ½å°½å¯èƒ½å¾€åé¢æ¨</span></span><br><span class="line">    GUILayout.FlexibleSpace();</span><br><span class="line"></span><br><span class="line">    m_normalLogCount = Mathf.Clamp(m_normalLogCount, <span class="number">0</span>, <span class="number">100</span>);</span><br><span class="line">    m_warningLogCount = Mathf.Clamp(m_warningLogCount, <span class="number">0</span>, <span class="number">100</span>);</span><br><span class="line">    m_errorLogCount = Mathf.Clamp(m_errorLogCount, <span class="number">0</span>, <span class="number">100</span>);</span><br><span class="line">    m_isShowLog = GUILayout.Toggle(m_isShowLog, <span class="keyword">new</span> GUIContent(m_numStrs[m_normalLogCount], m_infoIconSmall), EditorStyles.toolbarButton, GUILayout.Width(<span class="number">30.0f</span>));</span><br><span class="line">    m_isShowWarning = GUILayout.Toggle(m_isShowWarning, <span class="keyword">new</span> GUIContent(m_numStrs[m_warningLogCount], m_warningIconSmall), EditorStyles.toolbarButton, GUILayout.Width(<span class="number">30.0f</span>));</span><br><span class="line">    m_isShowError = GUILayout.Toggle(m_isShowError, <span class="keyword">new</span> GUIContent(m_numStrs[m_errorLogCount], m_errorIconSmall), EditorStyles.toolbarButton, GUILayout.Width(<span class="number">30.0f</span>));</span><br><span class="line"></span><br><span class="line">    m_logTypeForUnshow.Clear();</span><br><span class="line">    <span class="keyword">if</span> (!m_isShowLog)</span><br><span class="line">    &#123;</span><br><span class="line">        m_logTypeForUnshow.Add(LogType.Log);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!m_isShowWarning)</span><br><span class="line">    &#123;</span><br><span class="line">        m_logTypeForUnshow.Add(LogType.Warning);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!m_isShowError)</span><br><span class="line">    &#123;</span><br><span class="line">        m_logTypeForUnshow.Add(LogType.Error);</span><br><span class="line">        m_logTypeForUnshow.Add(LogType.Assert);</span><br><span class="line">        m_logTypeForUnshow.Add(LogType.Exception);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¨ªå‘ç»˜åˆ¶ç»“æŸ</span></span><br><span class="line">    GUILayout.EndHorizontal();</span><br><span class="line">    <span class="comment">// åŒºåŸŸç»˜åˆ¶ç»“æŸ</span></span><br><span class="line">    GUILayout.EndArea();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®é™…è°ƒç”¨ç»˜åˆ¶</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnGUI</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    DrawMenuUpperBar();</span><br><span class="line">    <span class="comment">//DrawUpperPanel();</span></span><br><span class="line">    <span class="comment">//DrawLowerPanel();</span></span><br><span class="line">    <span class="comment">//DrawResizer();</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å°±æŠŠèœå•æ ç»˜åˆ¶å¥½äº†ã€‚</p>
<h1 id="ç®€å•ç»˜åˆ¶ä¸Šä¸‹åŒºæ "><a href="#ç®€å•ç»˜åˆ¶ä¸Šä¸‹åŒºæ " class="headerlink" title="ç®€å•ç»˜åˆ¶ä¸Šä¸‹åŒºæ "></a>ç®€å•ç»˜åˆ¶ä¸Šä¸‹åŒºæ </h1><p>æ¥ä¸‹æ¥å†ç»˜åˆ¶è°ƒæ•´æ£’ä¹‹å‰å…ˆç®€å•ç»˜åˆ¶ä¸Šä¸‹åŒºï¼Œå¾…ä¼šå„¿åšå¥½è°ƒæ•´æ£’ä¹‹åå°±èƒ½ç›´æ¥æµ‹è¯•æ•ˆæœã€‚è¦æ³¨æ„ç»™èœå•æ ä»¥åŠè°ƒæ•´ç‰ˆé¢„ç•™çš„é«˜åº¦ï¼Œä¸ç„¶ä¼šå¾—åˆ°é”™è¯¯çš„åŒºåŸŸå¤§å°ï¼Œæ·»åŠ è°ƒæ•´æ£’åä¼šæ›´ä¼šå‡ºç°å¥‡æ€ªç°è±¡ã€‚<br>ç°åœ¨åªéœ€è¦ç»™ä¸Šä¸‹åŒºç»˜åˆ¶ç©ºç™½å°±å¯ä»¥äº†ã€‚</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">DrawUpperPanel</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    m_upperPanel = <span class="keyword">new</span> Rect(<span class="number">0</span>, MENU_BAR_HEIGHT, <span class="keyword">this</span>.position.width, (<span class="keyword">this</span>.position.height - MENU_BAR_HEIGHT) * m_upperSizeRatio);</span><br><span class="line">    GUILayout.BeginArea(m_upperPanel, m_panelStyle);</span><br><span class="line">    GUILayout.Label(<span class="string">"Log"</span>, m_panelLabelStyle);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸ºäº†ç”»log itemè€Œå‡†å¤‡çš„ ScrollView</span></span><br><span class="line">    m_upperPanelScroll = GUILayout.BeginScrollView(m_upperPanelScroll);</span><br><span class="line">    GUILayout.EndScrollView();</span><br><span class="line"></span><br><span class="line">    GUILayout.EndArea();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">DrawLowerPanel</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">float</span> yPos = PanelGroupHeight * m_upperSizeRatio + MENU_BAR_HEIGHT + RESIZER_HEIGHT;</span><br><span class="line">    m_lowerPanel = <span class="keyword">new</span> Rect(<span class="number">0</span>, yPos, <span class="keyword">this</span>.position.width, PanelGroupHeight * (<span class="number">1.0f</span> - m_upperSizeRatio));</span><br><span class="line">    GUILayout.BeginArea(m_lowerPanel, m_panelStyle);</span><br><span class="line">    GUILayout.Label(<span class="string">"Log Detail"</span>, m_panelLabelStyle);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸º logè¯¦æƒ…å‡†å¤‡çš„ ScrollView</span></span><br><span class="line">    m_lowerPanelScroll = GUILayout.BeginScrollView(m_lowerPanelScroll);</span><br><span class="line">    GUILayout.EndScrollView();</span><br><span class="line"></span><br><span class="line">    GUILayout.EndArea();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®é™…è°ƒç”¨ç»˜åˆ¶</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnGUI</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    DrawMenuUpperBar();</span><br><span class="line">    DrawUpperPanel();</span><br><span class="line">    DrawLowerPanel();</span><br><span class="line">    <span class="comment">//DrawResizer();</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="ç»˜åˆ¶è°ƒæ•´æ£’-æ·»åŠ åŒºåŸŸè°ƒæ•´"><a href="#ç»˜åˆ¶è°ƒæ•´æ£’-æ·»åŠ åŒºåŸŸè°ƒæ•´" class="headerlink" title="ç»˜åˆ¶è°ƒæ•´æ£’ æ·»åŠ åŒºåŸŸè°ƒæ•´"></a>ç»˜åˆ¶è°ƒæ•´æ£’ æ·»åŠ åŒºåŸŸè°ƒæ•´</h1><figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">DrawResizer</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">float</span> yPos = (<span class="keyword">this</span>.position.height - MENU_BAR_HEIGHT) * m_upperSizeRatio + MENU_BAR_HEIGHT;</span><br><span class="line">    m_resizer = <span class="keyword">new</span> Rect(<span class="number">0</span>, yPos, <span class="keyword">this</span>.position.width, RESIZER_HEIGHT);</span><br><span class="line"></span><br><span class="line">    GUILayout.BeginArea(<span class="keyword">new</span> Rect(m_resizer.position + (Vector2.up * RESIZER_HEIGHT), <span class="keyword">new</span> Vector2(<span class="keyword">this</span>.position.width, <span class="number">2.0f</span>)), m_resizerStyle);</span><br><span class="line">    GUILayout.EndArea();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŠŠ m_resizer åŒºåŸŸå†…çš„å…‰æ ‡æ¢æˆæ‹‰ä¼¸æŒ‡ç¤ºå…‰æ ‡</span></span><br><span class="line">    EditorGUIUtility.AddCursorRect(m_resizer, MouseCursor.ResizeVertical);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Resize</span>(<span class="params">Event currentEvent</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (m_isResizing)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// é€šè¿‡é¼ æ ‡ä½ç½®æ”¹å˜è°ƒæ•´æ£’ä½ç½®</span></span><br><span class="line">        <span class="keyword">float</span> pos = currentEvent.mousePosition.y - MENU_BAR_HEIGHT;</span><br><span class="line"></span><br><span class="line">        m_upperSizeRatio = pos / PanelGroupHeight;</span><br><span class="line">        m_upperSizeRatio = Mathf.Clamp(m_upperSizeRatio, <span class="number">0.5f</span>, <span class="number">0.8f</span>);</span><br><span class="line">        <span class="comment">//Debug.Log($"next upper ratio &#123;m_upperSizeRatio&#125;");</span></span><br><span class="line">        Repaint();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ProcessEvents</span>(<span class="params">Event currentEvent</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (EventType.MouseDown == currentEvent.type)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// if press mouse left in resizer</span></span><br><span class="line">        m_isResizing = (<span class="number">0</span> == currentEvent.button &amp;&amp; m_resizer.Contains(currentEvent.mousePosition));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (EventType.MouseUp == currentEvent.type)</span><br><span class="line">    &#123;</span><br><span class="line">        m_isResizing = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Resize(currentEvent);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>å…¶å®æ„Ÿè§‰ç¼–è¾‘å™¨å¼€å‘æŒºéº»çƒ¦çš„ï¼Œé™¤äº†åŒºåŸŸç»˜åˆ¶è¦æ³¨æ„ï¼Œè¿˜æœ‰ä¸€å †APIä¸å¥½æŸ¥ä¸ä¼šç”¨ã€‚ä¸‹ä¸€æœŸå°†ä¼šå°†Logä¿¡æ¯æ•è·å¹¶æ˜¾ç¤ºåœ¨æˆ‘ä»¬è‡ªå·±çš„è¿™ä¸ªConsoleä¸Šã€‚</p>
<hr>
<p>å®Œæ•´å·¥ç¨‹é“¾æ¥(æŒç»­æ›´æ–°ä¸­) :<br><a href="https://github.com/2C2C2C/TempUnityLogConsoleClone" target="_blank" rel="noopener">https://github.com/2C2C2C/TempUnityLogConsoleClone</a></p>
<p>P.S : æˆ‘åœ¨åšçš„æ—¶å€™æ˜¯å‚è€ƒäº†æŸä¸ªæ¸¸æˆå·¥ä½œå®¤å‘å¸ƒçš„æ•™ç¨‹ï¼Œæˆ‘ä¹Ÿé¡ºä¾¿æŠŠè¿™ä¸ªæ•™ç¨‹åˆ†äº«å‡ºæ¥ã€‚<br><a href="https://gram.gs/gramlog/creating-editor-windows-in-unity/" target="_blank" rel="noopener">https://gram.gs/gramlog/creating-editor-windows-in-unity/</a></p>
]]></content>
      <categories>
        <category>UnityEditor</category>
      </categories>
      <tags>
        <tag>Unity</tag>
        <tag>UnityEditor</tag>
      </tags>
  </entry>
  <entry>
    <title>æ‘¸ä¸€ä¸ªç®€å•çš„ Unity Log Console (2)</title>
    <url>/2020/05/31/20200531-CloneUnityConsole2/</url>
    <content><![CDATA[<p>ä¸Šä¸€æœŸæˆ‘ä»¬åšå®Œäº†åŸºæœ¬çš„é¢æ¿ç»˜åˆ¶ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥å¾€é‡Œé¢æ·»åŠ ç®€å•çš„å†…å®¹äº†ã€‚</p>
<h1 id="å®šä¹‰æ˜¾ç¤ºå•ä½"><a href="#å®šä¹‰æ˜¾ç¤ºå•ä½" class="headerlink" title="å®šä¹‰æ˜¾ç¤ºå•ä½"></a>å®šä¹‰æ˜¾ç¤ºå•ä½</h1><p>æ—¢ç„¶æˆ‘ä»¬è¦æ˜¾ç¤ºLogï¼Œé‚£å°±å®šä¹‰ä¸€äº›æ•°æ®ç»“æ„ç”¨äºå­˜å‚¨è¿™äº›Logã€‚å› ä¸ºè¿™äº›ä¸œè¥¿åœ¨æˆ‘ä»¬çš„consoleä¸­åªéœ€è¦æ˜¾ç¤ºå°±è¡Œäº†ï¼Œæˆ‘ä»¬åªéœ€è¦å®šä¹‰åªè¯»çš„æ•°æ®å°±å¯ä»¥ï¼Œæˆ–è®¸è¿˜èƒ½æé«˜æ€§èƒ½ã€‚</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">LogItem</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">bool</span> IsSelected &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">readonly</span> <span class="keyword">string</span> LogInfo = <span class="keyword">string</span>.Empty; <span class="comment">// Logç®€è¦ä¿¡æ¯</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">readonly</span> <span class="keyword">string</span> LogMessage = <span class="keyword">string</span>.Empty; <span class="comment">// Log è°ƒç”¨æ ˆï¼</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">readonly</span> LogType GetLogType = LogType.Log;</span><br><span class="line">	</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LogItem</span>(<span class="params"><span class="keyword">bool</span> isSelected, <span class="keyword">string</span> info, <span class="keyword">string</span> message, LogType type</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        IsSelected = isSelected;</span><br><span class="line">        <span class="comment">// è®°å¾—åŠ ä¸Šæ—¶é—´ï¼ï¼ï¼</span></span><br><span class="line">        LogInfo = <span class="keyword">string</span>.Format(<span class="string">"[&#123;0&#125;] &#123;1&#125;"</span>, System.DateTime.Now.ToLongTimeString(), info);</span><br><span class="line">        LogMessage = message;</span><br><span class="line">        GetLogType = type;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TempConsoleWindow</span> : <span class="title">EditorWindow</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">LogMessageReceived</span>(<span class="params"><span class="keyword">string</span> condition, <span class="keyword">string</span> stackTrace, LogType type</span>)</span></span><br><span class="line"><span class="function"></span>	&#123;</span><br><span class="line">            LogItem log = <span class="keyword">new</span> LogItem(<span class="literal">false</span>, condition, stackTrace, type);</span><br><span class="line">            m_logItems.Add(log);</span><br><span class="line">            <span class="keyword">switch</span> (type)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">case</span> LogType.Error:</span><br><span class="line">                    m_errorLogCount++;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> LogType.Assert:</span><br><span class="line">                    m_errorLogCount++;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> LogType.Warning:</span><br><span class="line">                    m_warningLogCount++;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> LogType.Log:</span><br><span class="line">                    m_normalLogCount++;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> LogType.Exception:</span><br><span class="line">                    m_errorLogCount++;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    m_errorLogCount++;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// ä¸»åŠ¨åˆ·æ–°ï¼Œå› ä¸ºå½“æ­¤çª—å£æ²¡æœ‰ç„¦ç‚¹æ—¶ä¼¼ä¹æ— æ³•èµ° OnGUI() åˆ·æ–°ã€‚</span></span><br><span class="line">            Repaint();</span><br><span class="line">            <span class="comment">//GUI.changed = true;</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnEnable</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>	&#123;</span><br><span class="line">		<span class="comment">// ....</span></span><br><span class="line">		<span class="comment">// ç›‘å¬æ­¤äº‹ä»¶ï¼Œå½“Debug.Log("")è¢«è°ƒç”¨çš„æ—¶å€™å°±ä¼šå“åº”</span></span><br><span class="line">		Application.logMessageReceived += LogMessageReceived;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnDestroy</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>	&#123;</span><br><span class="line">		<span class="comment">// ....</span></span><br><span class="line">		Application.logMessageReceived -= LogMessageReceived;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="åœ¨ä¸Šéƒ¨é¢æ¿æ˜¾ç¤ºLog"><a href="#åœ¨ä¸Šéƒ¨é¢æ¿æ˜¾ç¤ºLog" class="headerlink" title="åœ¨ä¸Šéƒ¨é¢æ¿æ˜¾ç¤ºLog"></a>åœ¨ä¸Šéƒ¨é¢æ¿æ˜¾ç¤ºLog</h1><p>åƒåŸæœ¬Unity Consoleä¸€æ ·ï¼Œæ¯ä¸€æ¡Logä»¥ä¸€ä¸ªæ–¹æ¡itemçš„å½¢å¼æ˜¾ç¤ºåœ¨ä¸ŠåŠéƒ¨åˆ†é¢æ¿ã€‚<br>æˆ‘ä»¬å…ˆæŠŠè¿™ä¸ªitemç”»å‡ºæ¥ã€‚<br>m_selectedLogItem æ˜¯æˆ‘ä»¬é€‰ä¸­çš„ LogItemã€‚</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">bool</span> <span class="title">DrawLogBox</span>(<span class="params"><span class="keyword">in</span> <span class="keyword">string</span> content, LogType logType, <span class="keyword">bool</span> isOdd, <span class="keyword">bool</span> isSelected</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (isSelected)</span><br><span class="line">    &#123;</span><br><span class="line">        m_boxItemStyle.normal.background = m_boxBgSelected;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (isOdd)</span><br><span class="line">        &#123;</span><br><span class="line">            m_boxItemStyle.normal.background = m_boxBgOdd;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            m_boxItemStyle.normal.background = m_boxBgEven;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span> (logType)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">case</span> LogType.Error:</span><br><span class="line">            m_boxIcon = m_errorIcon;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> LogType.Assert:</span><br><span class="line">            m_boxIcon = m_errorIcon;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> LogType.Warning:</span><br><span class="line">            m_boxIcon = m_warningIcon;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> LogType.Log:</span><br><span class="line">            m_boxIcon = m_infoIcon;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> LogType.Exception:</span><br><span class="line">            m_boxIcon = m_errorIcon;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è¿™ä¸ªæŒ‰é’®æ˜¯å› ä¸ºè¿™æ¡box itemæ˜¯å¯ä»¥è¢«ç‚¹å‡»é€‰æ‹©çš„ï¼ï¼ï¼</span></span><br><span class="line">    <span class="keyword">return</span> GUILayout.Button(<span class="keyword">new</span> GUIContent(content, m_boxIcon), m_boxItemStyle, GUILayout.ExpandWidth(<span class="literal">true</span>), GUILayout.Height(<span class="number">30.0f</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">DrawUpperPanel</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    m_upperPanel = <span class="keyword">new</span> Rect(<span class="number">0</span>, MENU_BAR_HEIGHT, <span class="keyword">this</span>.position.width, (<span class="keyword">this</span>.position.height - MENU_BAR_HEIGHT) * m_upperSizeRatio);</span><br><span class="line">    GUILayout.BeginArea(m_upperPanel, m_panelStyle);</span><br><span class="line">    GUILayout.Label(<span class="string">"Log"</span>, m_panelLabelStyle);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åœ¨scrollviewé‡Œå¡«å……logï¼Œunity</span></span><br><span class="line">    m_upperPanelScroll = GUILayout.BeginScrollView(m_upperPanelScroll);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m_logItems.Count; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (m_logTypeForUnshow.Contains(m_logItems[i].GetLogType))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç”»çš„æ—¶å€™ï¼Œé¡ºä¾¿æ¥å—itemçš„ç‚¹å‡»çš„ç»“æœ</span></span><br><span class="line">        <span class="keyword">if</span> (DrawLogBox(m_logItems[i].LogInfo, m_logItems[i].GetLogType, i % <span class="number">2</span> == <span class="number">0</span>, m_logItems[i].IsSelected))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> != m_selectedLogItem)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (m_logItems[i] == m_selectedLogItem)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">// click a some one, open code</span></span><br><span class="line">                    <span class="comment">// JumpToCurrentLogPos(); // è·³è½¬åˆ°ä½ ç‚¹å‡»çš„Logçš„é¡¶éƒ¨çš„ä»£ç æ–‡ä»¶ï¼ˆå¦‚æœå¯ä»¥</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    m_selectedLogItem.IsSelected = <span class="literal">false</span>;</span><br><span class="line">                    m_selectedLogItem = m_logItems[i];</span><br><span class="line">                    m_selectedLogItem.IsSelected = <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                m_selectedLogItem = m_logItems[i];</span><br><span class="line">                m_selectedLogItem.IsSelected = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å‡†å¤‡åˆ·æ–°</span></span><br><span class="line">            GUI.changed = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    GUILayout.EndScrollView();</span><br><span class="line">    GUILayout.EndArea();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnGUI</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// .....</span></span><br><span class="line">    <span class="keyword">if</span> (GUI.changed)</span><br><span class="line">    &#123;</span><br><span class="line">        Repaint();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="æ˜¾ç¤ºLogè¯¦æƒ…ä»¥åŠè°ƒç”¨æ ˆ"><a href="#æ˜¾ç¤ºLogè¯¦æƒ…ä»¥åŠè°ƒç”¨æ ˆ" class="headerlink" title="æ˜¾ç¤ºLogè¯¦æƒ…ä»¥åŠè°ƒç”¨æ ˆ"></a>æ˜¾ç¤ºLogè¯¦æƒ…ä»¥åŠè°ƒç”¨æ ˆ</h1><p>ç”±äºæˆ‘è„‘å­ä¸å¥½ä½¿ï¼Œæˆ‘ä¸çŸ¥é“å¦‚ä½•å®Œç¾å¤åˆ»Unity Consoleçš„è¯¦æƒ…ï¼ŒUnityè‡ªå¸¦Consoleä¸­æ˜¾ç¤ºçš„ä»£ç é“¾æ¥æ—¢å¯ä»¥å¤åˆ¶ä¹Ÿå¯ä»¥ç‚¹å‡»è·³è½¬ï¼Œæˆ‘åªåšäº†ç®€å•çš„è·³è½¬ã€‚å¦‚æœæœ‰æ¯”è¾ƒç†Ÿæ‚‰ç¼–è¾‘å™¨å¼€å‘çš„æœ‹å‹ï¼Œå¯ä»¥æä¾›ä¿®æ”¹çš„æ–¹æ³•ã€‚</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">DrawLowerPanel</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">float</span> yPos = PanelGroupHeight * m_upperSizeRatio + MENU_BAR_HEIGHT + RESIZER_HEIGHT;</span><br><span class="line">    m_lowerPanel = <span class="keyword">new</span> Rect(<span class="number">0</span>, yPos, <span class="keyword">this</span>.position.width, PanelGroupHeight * (<span class="number">1.0f</span> - m_upperSizeRatio));</span><br><span class="line">    GUILayout.BeginArea(m_lowerPanel, m_panelStyle);</span><br><span class="line">    GUILayout.Label(<span class="string">"Log Detail"</span>, m_panelLabelStyle);</span><br><span class="line"></span><br><span class="line">    m_lowerPanelScroll = GUILayout.BeginScrollView(m_lowerPanelScroll);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">string</span> logDetail = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">string</span>[] logDetailMutiLine = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// TODO : code clean here</span></span><br><span class="line">    <span class="keyword">string</span> pathline = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">string</span> tempCase = <span class="string">".cs:"</span>;</span><br><span class="line">    <span class="keyword">string</span> path = <span class="keyword">string</span>.Empty;</span><br><span class="line">    <span class="keyword">int</span> line = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> splitwa = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != m_selectedLogItem)</span><br><span class="line">    &#123;</span><br><span class="line">        logDetail = m_selectedLogItem.LogMessage;</span><br><span class="line">        GUILayout.TextArea(<span class="keyword">string</span>.Format(<span class="string">"&#123;0&#125;\n"</span>, m_selectedLogItem.LogInfo), m_textAreaStyle);</span><br><span class="line"></span><br><span class="line">        logDetailMutiLine = logDetail.Split(<span class="string">'\n'</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; logDetailMutiLine.Length; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// Regex match 'at xxx'</span></span><br><span class="line">            Match matches = Regex.Match(logDetailMutiLine[i], <span class="string">@"\(at (.+)\)"</span>, RegexOptions.Multiline);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (matches.Success)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">while</span> (matches.Success)</span><br><span class="line">                &#123;</span><br><span class="line">                    pathline = matches.Groups[<span class="number">1</span>].Value;</span><br><span class="line">                    <span class="keyword">if</span> (pathline.Contains(tempCase))</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">int</span> splitIndex = pathline.LastIndexOf(<span class="string">":"</span>);</span><br><span class="line">                        path = pathline.Substring(<span class="number">0</span>, splitIndex);</span><br><span class="line">                        line = Convert.ToInt32(pathline.Substring(splitIndex + <span class="number">1</span>));</span><br><span class="line">                        <span class="keyword">string</span> fullpath = Application.dataPath.Substring(<span class="number">0</span>, Application.dataPath.LastIndexOf(<span class="string">"Assets"</span>));</span><br><span class="line">                        fullpath = fullpath + path;</span><br><span class="line">                        splitwa = logDetailMutiLine[i].LastIndexOf(<span class="string">"("</span>);</span><br><span class="line">                        logDetailMutiLine[i] = logDetailMutiLine[i].Substring(<span class="number">0</span>, splitwa);</span><br><span class="line"></span><br><span class="line">                        GUILayout.BeginHorizontal();</span><br><span class="line">                        GUILayout.TextArea(<span class="keyword">string</span>.Format(<span class="string">" (at : &#123;0&#125;)\n"</span>, logDetailMutiLine[i]), m_textAreaStyle);</span><br><span class="line">                        <span class="keyword">if</span> (GUILayout.Button(<span class="keyword">string</span>.Format(<span class="string">" ( &#123;0&#125; )\n"</span>, pathline), m_labelButtonStyle))</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="comment">// æ‰“å¼€æ–‡ä»¶çš„é­”æ³•</span></span><br><span class="line">                            UnityEditorInternal.InternalEditorUtility.OpenFileAtLineExternal(fullpath.Replace(<span class="string">'/'</span>, <span class="string">'\\'</span>), line);</span><br><span class="line">                        &#125;</span><br><span class="line">                        GUILayout.FlexibleSpace();</span><br><span class="line">                        GUILayout.EndHorizontal();</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                GUILayout.TextArea(logDetailMutiLine[i], m_textAreaStyle);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    GUILayout.EndScrollView();</span><br><span class="line">    GUILayout.EndArea();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™è¾¹ç”¨äº†æ­£åˆ™è¡¨è¾¾å¼å»åŒ¹é…å»å¯»æ‰¾ä»£ç æ–‡ä»¶ï¼Œæ˜¯ä»ç½‘ä¸ŠæŸ¥åˆ°çš„ï¼Œæˆ‘ç”¨ç€è¿˜ä¸å¤ªç†Ÿç»ƒã€‚æ‰€ä»¥å†™å¾—å¾ˆä¹±ï¼Œåç»­ä¼šåœ¨å·¥ç¨‹ä¸­æ›´æ–°å¹²å‡€äº›çš„ç‰ˆæœ¬ã€‚</p>
<h1 id="å®Œå–„èœå•æ åŠŸèƒ½"><a href="#å®Œå–„èœå•æ åŠŸèƒ½" class="headerlink" title="å®Œå–„èœå•æ åŠŸèƒ½"></a>å®Œå–„èœå•æ åŠŸèƒ½</h1><p>æ—¢ç„¶æˆ‘ä»¬èƒ½æ˜¾ç¤ºLogäº†ï¼Œé‚£å°±åˆ«å¿˜äº†è¡¥ä¸Šæ¸…é™¤Logçš„åŠŸèƒ½ã€‚</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ClearLogs</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != m_selectedLogItem)</span><br><span class="line">    &#123;</span><br><span class="line">        m_selectedLogItem.IsSelected = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    m_selectedLogItem = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    m_normalLogCount = <span class="number">0</span>;</span><br><span class="line">    m_warningLogCount = <span class="number">0</span>;</span><br><span class="line">    m_errorLogCount = <span class="number">0</span>;</span><br><span class="line">    m_logItems.Clear();</span><br><span class="line">    GUI.changed = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">DrawMenuUpperBar</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// .....</span></span><br><span class="line">    <span class="keyword">if</span> (GUILayout.Button(<span class="keyword">new</span> GUIContent(<span class="string">"Clear"</span>), EditorStyles.toolbarButton, GUILayout.Width(<span class="number">40.0f</span>)))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ç”¨äºæ¸…ç©ºæ‰€æœ‰çš„ log</span></span><br><span class="line">        ClearLogs();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// .....</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>è¿™ä¸€æœŸå°±åˆ°è¿™é‡Œã€‚æ„Ÿè§‰å·¥å…·å¼€å‘ä¹Ÿæœ‰ç‚¹æ¬ç –ï¼Œä½†æ˜¯ä¼šç”¨åˆ°å„ç§å„æ ·çš„æ¬ç –å·¥å…·å»æ¬è¿å¥‘åˆä¸åŒçš„ç –ï¼Œèƒ½æ¥è§¦åˆ°å¾ˆå¤šä¸œè¥¿ï¼Œè¿˜è›®æœ‰è¶£çš„ã€‚<br>ä¸‹ä¸€æœŸæˆ‘ä¼šå°è¯•æŠŠå½“å‰è¿™ä¸ªä¹ä¸Log Consoleçš„åŠŸèƒ½éƒ½è¡¥é½ã€‚<br>ä»£ç æœ‰ç¼ºæ¼å¯ä»¥å…ˆå‚è€ƒå·¥ç¨‹ã€‚</p>
<hr>
<p>å®Œæ•´å·¥ç¨‹é“¾æ¥</p>
<p><a href="https://github.com/2C2C2C/TempUnityLogConsoleClone" target="_blank" rel="noopener">https://github.com/2C2C2C/TempUnityLogConsoleClone</a></p>
]]></content>
      <categories>
        <category>UnityEditor</category>
      </categories>
      <tags>
        <tag>Unity</tag>
        <tag>UnityEditor</tag>
      </tags>
  </entry>
  <entry>
    <title>UnityEditor EasyButton ç®€æ˜“ç¼–è¾‘å™¨æŒ‰é’®</title>
    <url>/2020/06/05/20200605-Unity-EasyButton/</url>
    <content><![CDATA[<p>ä¸€ä¸ªæ¯”è¾ƒç®€å•ä½†æ˜¯æ–¹ä¾¿çš„ä¸œè¥¿</p>
<h1 id="è¿™æ˜¯å•¥"><a href="#è¿™æ˜¯å•¥" class="headerlink" title="è¿™æ˜¯å•¥"></a>è¿™æ˜¯å•¥</h1><p>æˆ‘ä»¬å¹³æ—¶äº›å†™äº†ä¸€äº›å‡½æ•°åœ¨MonoBehavioré‡Œæƒ³æµ‹è¯•ï¼Œè¿™è¾¹å¯ä»¥æ•´ä¸€ä¸ªç‰¹æ€§æ”¾åœ¨éœ€è¦å¿«é€Ÿè°ƒç”¨çš„æ–¹æ³•ä¸Š(é™äºæ— å‚æ•°çš„å‡½æ•°)ã€‚<br>è¿™è¾¹å¯ä»¥åšä¸€ä¸ªç¼–è¾‘å™¨çš„æŒ‰é’®ï¼Œç›´æ¥æ”¾åœ¨MonoBehaviorçš„ç»„ä»¶é¢æ¿ä¸Šã€‚</p>
<h1 id="ä¸Šä»£ç "><a href="#ä¸Šä»£ç " class="headerlink" title="ä¸Šä»£ç "></a>ä¸Šä»£ç </h1><p>å…ˆå®šä¹‰æˆ‘ä»¬éœ€è¦çš„è¿™ä¸ªç‰¹æ€§ï¼Œæ—¢ç„¶æ˜¯åšä¸ªæŒ‰é’®ï¼Œé‚£å°±å«Buttonå¥½äº†ã€‚é‚£ä¹ˆè¿™ä¸ªç‰¹æ€§å°±åº”è¯¥å«åšButtonAttributeã€‚</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line">[<span class="meta">AttributeUsage(AttributeTargets.Method)</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ButtonAttribute</span> : <span class="title">Attribute</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> m_methodName = <span class="keyword">string</span>.Empty;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ButtonAttribute</span>(<span class="params"><span class="keyword">string</span> methodName</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        m_methodName = methodName;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ—¢ç„¶æˆ‘ä»¬è¦åœ¨Inspectoré¢æ¿ä¸ŠåŠ ä¸œè¥¿ï¼Œé‚£æˆ‘ä»¬ä¹Ÿè¦æ“ä½œä¸€ä¸‹Inspectoré¢æ¿ã€‚<br>æˆ‘ä»¬åšä¸€ä¸ªCustomEditoré¢æ¿ç»™æˆ‘ä»¬çš„MonoBehaviorï¼Œè¿™ä¸ªé¢æ¿ä¼šä½œç”¨äºæ‰€æœ‰çš„MonoBehaviorã€‚</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line">[<span class="meta">CustomEditor(typeof(MonoBehaviour), true), CanEditMultipleObjects</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">BaseEditor</span> : <span class="title">Editor</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> Type m_targetType = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnInspectorGUI</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">// draw default stuff</span></span><br><span class="line">        <span class="keyword">base</span>.OnInspectorGUI();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> == m_targetType)</span><br><span class="line">            m_targetType = target.GetType();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (m_targetType != <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// try find member function and static function :)</span></span><br><span class="line">            MethodInfo[] methods = m_targetType.GetMethods(BindingFlags.Instance | BindingFlags.Static | BindingFlags.NonPublic | BindingFlags.Public);</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> method <span class="keyword">in</span> methods)</span><br><span class="line">            &#123;</span><br><span class="line">                ButtonAttribute button = method.GetCustomAttribute&lt;ButtonAttribute&gt;();</span><br><span class="line">                <span class="keyword">if</span> (button != <span class="literal">null</span> &amp;&amp; method.GetParameters().Length &gt; <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    EditorGUILayout.HelpBox(<span class="string">"ButtonAttribute: method cant have parameterz."</span>, MessageType.Warning);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (button != <span class="literal">null</span> &amp;&amp; GUILayout.Button(button.m_methodName))</span><br><span class="line">                &#123;</span><br><span class="line">                    method.Invoke(target, <span class="keyword">new</span> <span class="keyword">object</span>[] &#123; &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            m_targetType = m_targetType.BaseType;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åæ–°å»ºä¸€ä¸ªMonoBehaviorè„šæœ¬ï¼Œè¯•è¯•</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ToxicTester</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">Button(<span class="meta-string">"try exec public method"</span>)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ExecPublicMethod</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        Debug.Log(<span class="string">"try exec public method wa"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">Button(<span class="meta-string">"try exec protected method"</span>)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">ExecProtectedMethod</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        Debug.Log(<span class="string">"try exec protected method wa"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    [<span class="meta">Button(<span class="meta-string">"try exec private method"</span>)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ExecPrivateMethod</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        Debug.Log(<span class="string">"try exec private method wa"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">Button(<span class="meta-string">"try exec public static method"</span>)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ExecPublicStaticMethod</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        Debug.Log(<span class="string">"try exec public static method wa"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<img src="/2020/06/05/20200605-Unity-EasyButton/20200605-pic001.png" class="" title="split">
<p>æ•ˆæœå¦‚å›¾</p>
]]></content>
      <categories>
        <category>UnityEditor</category>
      </categories>
      <tags>
        <tag>Unity</tag>
        <tag>UnityEditor</tag>
      </tags>
  </entry>
  <entry>
    <title>ç®€æ˜“æ£€æµ‹ï¼Œç›®æ ‡æ˜¯å¦åœ¨æ‰‡å½¢åŒºåŸŸ(2D)</title>
    <url>/2020/06/14/20200614-check-target-fan-shape/</url>
    <content><![CDATA[<p>æœ€è¿‘åœ¨é¡¹ç›®ç»„é‡Œåšä¸€äº›å°æ¸¸æˆåŸå‹ï¼Œæ·±æ„Ÿè‡ªå·±èœå¾—å¦‚è™«è±¸ã€‚ä¸ºäº†æ…¢æ…¢æå‡è¿˜æ˜¯å†³å®šåšä¸€äº›è®°å½•ï¼Œè™½ç„¶åªæ˜¯å¾ˆåƒåœ¾çš„åŠŸèƒ½ã€‚<br>å› ä¸ºåšçš„æ˜¯æ‰‹æ¸¸ï¼Œæ‰€ä»¥å¯¹æ€§èƒ½è›®çœ‹é‡çš„ï¼Œè¯´æ˜¯åŸå‹ï¼Œä¸ºäº†å¿«ä¹Ÿåªæ˜¯é¡¹ç›®é‡Œå¼€äº†ä¸ªå•ç‹¬çš„æ–°åœºæ™¯åšçš„ï¼Œ3Céƒ½æœ‰ï¼Œåšå¥½äº†å¯ä»¥ç›´æ¥æ‰“åŒ…APKè¯•ç©ã€‚<br>åºŸè¯ä¸å¤šè¯´ï¼Œè¿™æ¬¡åšçš„äº‹å¾ˆç®€å•ï¼Œåœ¨æ‰‡å½¢åŒºåŸŸå†…æ£€æµ‹ä¸€äº›ç›®æ ‡ã€‚å› ä¸ºå¬è¯´Vector3. Angle()é‡Œä¼šè·‘å¼€æ–¹çš„è®¡ç®—ï¼Œæ•…å°è¯•é¿å…ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ã€‚</p>
<img src="/2020/06/14/20200614-check-target-fan-shape/20200614-pic001.png" class="" title="split">
<h1 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h1><p>éœ€è¦è§£å†³çš„éœ€æ±‚æ˜¯åœ¨æ£€æµ‹è€… å‰æ–¹ çš„ä¸€ä¸ªæ‰‡å½¢å†…æ£€æµ‹ç›®æ ‡ç‰©ä½“ï¼Œå…¶å®å¯ä»¥åŒ–ç®€ä¸º2Då¹³é¢çš„æ£€æµ‹ã€‚<br>æˆ‘å†³å®šå¤šæ¬¡ä½¿ç”¨ç‚¹ä¹˜å’Œå‰ä¹˜æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>å·²çŸ¥æ•°æ®ï¼š<br>æ£€æµ‹è€…çš„ä½ç½®ï¼Œæœå‘ï¼Œæ£€æµ‹è§’åº¦å¤§å°ï¼ŒåŠå¾„å¤§å°<br>æ£€æµ‹ç›®æ ‡çš„ä½ç½®</p>
<p>æ­¥éª¤ï¼š</p>
<ol>
<li>ç”¨æ£€æµ‹è€…çš„å‰æ–¹å‘é‡å’Œæ£€æµ‹è€…åˆ°ç›®æ ‡çš„æ–¹å‘å‘é‡ç‚¹ä¹˜æ¥åˆ¤æ–­ç›®æ ‡ç‰©ä½“æ˜¯å¦åœ¨æ£€æµ‹è€…å‰æ–¹ã€‚</li>
<li>ç”¨æ£€æµ‹è€…å‰æ–¹æ–¹å‘å‘é‡å’Œæ£€æµ‹åŒºåŸŸçš„ä¸¤ä¸ªè¾¹ç•Œæ–¹å‘åˆ†åˆ«å‰ä¹˜å¾—åˆ°ä¸¤ä¸ªæ³•å‘å‘é‡A,Bã€‚</li>
<li>ç”¨æ£€æµ‹è€…åˆ°ç›®æ ‡çš„æ–¹å‘å‘é‡å’Œæ£€æµ‹åŒºåŸŸçš„ä¸¤ä¸ªè¾¹ç•Œæ–¹å‘åˆ†åˆ«å‰ä¹˜å¾—åˆ°ä¸¤ä¸ªæ³•å‘å‘é‡C,Dã€‚</li>
<li>ç”¨ç‚¹ä¹˜æ£€æµ‹C,Dæ˜¯å¦åŒå‘ï¼Œæ˜¯ï¼Œåˆ™åœ¨æ£€æµ‹åŒºå¤–</li>
<li>æ˜¯å¦åŒæ—¶æ»¡è¶³å‘é‡A,CåŒå‘ï¼Œå‘é‡B,DåŒå‘ï¼Œæ˜¯ï¼Œåˆ™åœ¨æ£€æµ‹åŒºå†…</li>
</ol>
<p>å…¶å®æˆ‘è‡ªå·±éƒ½æ„Ÿè§‰è¿™ä¸­æ–‡ï¼Œå†™å¾—å¾ˆä¹±ï¼Œè¿˜ä¸å¦‚ç›´æ¥çœ‹ä»£ç 23333<br>å…¨éƒ¨ä»£ç ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TargetCheckTester</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> Transform m_transform = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">SerializeField</span>]</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> m_checkAngle = <span class="number">60.0f</span>;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">SerializeField</span>]</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> m_checkRadius = <span class="number">6.0f</span>;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">SerializeField</span>]</span><br><span class="line">    <span class="keyword">private</span> Transform m_targetTransform = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">CheckTarget1</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> == m_targetTransform)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        Vector3 myPos = m_transform.position;</span><br><span class="line">        Vector3 myForward = m_transform.forward;</span><br><span class="line">        <span class="keyword">float</span> halfAngle = m_checkAngle * <span class="number">0.5f</span>;</span><br><span class="line">        Vector3 dirUp = Quaternion.Euler(<span class="number">0.0f</span>, -halfAngle, <span class="number">0.0f</span>) * myForward;</span><br><span class="line">        Vector3 dirDown = Quaternion.Euler(<span class="number">0.0f</span>, halfAngle, <span class="number">0.0f</span>) * myForward;</span><br><span class="line"></span><br><span class="line">        Vector3 upCheck = Vector3.Cross(myForward, dirUp);</span><br><span class="line">        Vector3 downCheck = Vector3.Cross(myForward, dirDown);</span><br><span class="line"></span><br><span class="line">        Vector3 targetPos = m_targetTransform.position;</span><br><span class="line">        <span class="comment">// hack, to make them on a 2d plane :)</span></span><br><span class="line">        targetPos.y = myPos.y;</span><br><span class="line">        Vector3 toTargetDir = targetPos - myPos;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// draw line</span></span><br><span class="line">        Vector3 point1 = myPos + dirUp * m_checkRadius;</span><br><span class="line">        Vector3 point2 = myPos + dirDown * m_checkRadius;</span><br><span class="line">        Vector3 point0 = myPos + myForward * m_checkRadius;</span><br><span class="line"></span><br><span class="line">        Debug.DrawLine(myPos, point1, Color.yellow, Time.deltaTime);</span><br><span class="line">        Debug.DrawLine(myPos, point2, Color.yellow, Time.deltaTime);</span><br><span class="line">        Debug.DrawLine(myPos, point0, Color.yellow, Time.deltaTime);</span><br><span class="line">        Debug.DrawLine(point1, point0, Color.yellow, Time.deltaTime);</span><br><span class="line">        Debug.DrawLine(point2, point0, Color.yellow, Time.deltaTime);</span><br><span class="line">        Debug.DrawLine(myPos, targetPos, Color.red, Time.deltaTime);</span><br><span class="line">        <span class="comment">// draw line</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (Vector3.Dot(toTargetDir, myForward) &lt; <span class="number">0.0f</span> || toTargetDir.sqrMagnitude &gt; m_checkRadius * m_checkRadius)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        Vector3 targetUpCheck = Vector3.Cross(toTargetDir, dirUp);</span><br><span class="line">        Vector3 targetDownCheck = Vector3.Cross(toTargetDir, dirDown);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">float</span> selfCheck = Vector3.Dot(targetUpCheck, targetDownCheck);</span><br><span class="line">        <span class="keyword">float</span> dotCheckUp = Vector3.Dot(upCheck, targetUpCheck);</span><br><span class="line">        <span class="keyword">float</span> dotCheckDown = Vector3.Dot(targetDownCheck, downCheck);</span><br><span class="line">        <span class="keyword">if</span> (selfCheck &lt;= <span class="number">0.0f</span> &amp;&amp; dotCheckUp * dotCheckDown &gt;= <span class="number">0.0f</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Debug.Log(<span class="string">"target in sight"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> mono method</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Awake</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        m_transform = <span class="keyword">this</span>.transform;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Update</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        CheckTarget1();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<img src="/2020/06/14/20200614-check-target-fan-shape/20200614-pic002.png" class="" title="split">]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>Unity</tag>
        <tag>Gameplay</tag>
      </tags>
  </entry>
  <entry>
    <title>UnityObject ç©ºå¼•ç”¨æ£€æŸ¥å°æµ‹è¯•</title>
    <url>/2020/06/20/20200620-unity-obj-null-check/</url>
    <content><![CDATA[<blockquote>
<p>Classes deriving from Unity. Object inherit equality operators that change the behaviour of the == and != operators.<br>While these operators will perform standard . NET reference equality, if comparing one side to null, these operators will call native code to check if the underlying native engine object is still alive. </p>
</blockquote>
<p>è¿™æ®µè§£é‡Šæ¥è‡ªRiderçš„æç¤ºï¼š<br><a href="https://github.com/JetBrains/resharper-unity/wiki/Avoid-null-comparisons-against-UnityEngine.Object-subclasses" target="_blank" rel="noopener">https://github.com/JetBrains/resharper-unity/wiki/Avoid-null-comparisons-against-UnityEngine.Object-subclasses</a></p>
<p>UnityEngine åº•å±‚æ˜¯C++å†™çš„ï¼Œæ‰€ä»¥è¯´ï¼Œå…¶å®æˆ‘ä»¬å¯¹UnityObjectçš„ç©ºå¼•ç”¨æ£€æŸ¥éƒ½ä¼šå†æ·±å…¥åˆ°é‡Œé¢C++é‚£ä¸€å±‚å»å†æ£€æŸ¥ï¼Œè¿™ä¸ªæ£€æŸ¥æ˜¯æ¯”è¾ƒæ¶ˆè€—çš„ã€‚<br>ä¹‹å‰æ›¾ç»é‡åˆ°å› ä¸ºä½¿ç”¨äº† ?. è¯­æ³•ç³–è€Œå¯¼è‡´çš„ this æŒ‡é’ˆä¸ºnullçš„å¥‡å¦™bugï¼Œå¤§æ¦‚ä¹Ÿæ˜¯å› ä¸ºè¿™ä¸ªåŸå› ã€‚</p>
<p>ç°åœ¨çš„å…¬å¸æ˜¯åšæ‰‹æ¸¸çš„ï¼Œå¤§å®¶å¯¹æ€§èƒ½éƒ½æ¯”è¾ƒçœ‹é‡ï¼Œä¸è¿‡æˆ‘ä¹ŸçœŸçš„å¥½å¥‡è¿™ä¸ªæ£€æŸ¥åˆ°åº•æœ‰å¤šæ¶ˆè€—ï¼Œå†³å®šè·‘ä¸€è·‘è¯•è¯•ã€‚</p>
<h1 id="Test-Case"><a href="#Test-Case" class="headerlink" title="Test Case"></a>Test Case</h1><p>å› ä¸ºæ˜¯åšæ‰‹æ¸¸ï¼Œéšæ„å¹²è„†å°±åœ¨æ‰‹æœºä¸Šæµ‹è¯•å¥½äº†ã€‚<br>å¤§æ¦‚æ˜¯è¿™æ ·çš„ç¯å¢ƒ:<br>Unity 2019.4 LTS</p>
<p>ç§»åŠ¨è®¾å¤‡è¿™è¾¹æ˜¯<br>Google Pixel Verzion(ä¿ºç©·ä¹°ç¾ç‰ˆ)<br>Android 9 (å·²è·å–Rootæƒé™)</p>
<p>TestCase è¿™è¾¹å…¶å®æˆ‘éƒ½æ˜¯çå¼„çš„ã€‚</p>
<p>åˆ†åˆ«è¿›è¡Œä¸‰ç§æµ‹è¯•ï¼š<br>Unity Object çš„ç©ºå¼•ç”¨æ£€æŸ¥ï¼›<br>POCO Object çš„ç©ºå¼•ç”¨æ£€æŸ¥ï¼›<br>bool çš„ç›´æ¥æ£€æŸ¥ï¼›(å› ä¸ºæˆ‘è§‰å¾—è¿™æ˜¯ä¸€ä¸ªä»£æ›¿Unity Objectç©ºå¼•ç”¨æ£€æŸ¥çš„ä¸€ä¸ªæ–¹æ³•</p>
<p>æ¯ä¸€ç§æ£€æŸ¥éƒ½æœ‰æ£€æŸ¥åˆ°trueå’Œfalseçš„ä¸¤ç§æƒ…å†µï¼Œå¹¶å¾ªç¯è·‘å¤šæ¬¡ã€‚</p>
<p>ç„¶åï¼Œä¸Šä»£ç ï¼</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">TempCheckTest</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TempObjA</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> m_tempNum = <span class="number">56</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">NullCheckTester</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// unity obj null check</span></span><br><span class="line">        <span class="keyword">private</span> Transform m_emptyTransform = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">private</span> Transform m_selfTransform = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// poco obj null check</span></span><br><span class="line">        <span class="keyword">private</span> TempObjA m_emptyObjA = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">private</span> TempObjA m_objA = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// bool check</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">bool</span> m_boolTrue = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">bool</span> m_boolFalse = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">        [<span class="meta">Header(<span class="meta-string">"test"</span>)</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">int</span> m_checkTimes = <span class="number">100000</span>;</span><br><span class="line"></span><br><span class="line">        [<span class="meta">Header(<span class="meta-string">"UI side"</span>)</span>]</span><br><span class="line">        <span class="keyword">public</span> UnityEngine.UI.Text m_outPutText = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">public</span> UnityEngine.UI.Button m_doUnityObjTestButton = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">public</span> UnityEngine.UI.Button m_doPocoObjTestButton = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">public</span> UnityEngine.UI.Button m_doBoolTestButton = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> UnityEngine.UI.InputField m_inputField = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        [<span class="meta">Button(<span class="meta-string">"init awake"</span>)</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">InitTester</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            m_emptyTransform = <span class="literal">null</span>;</span><br><span class="line">            m_selfTransform = <span class="keyword">this</span>.transform;</span><br><span class="line"></span><br><span class="line">            m_emptyObjA = <span class="literal">null</span>;</span><br><span class="line">            m_objA = <span class="keyword">new</span> TempObjA();</span><br><span class="line"></span><br><span class="line">            m_boolTrue = <span class="literal">true</span>;</span><br><span class="line">            m_boolFalse = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">            m_outPutText.text = <span class="keyword">string</span>.Empty;</span><br><span class="line"></span><br><span class="line">            m_doUnityObjTestButton.onClick.RemoveAllListeners();</span><br><span class="line">            m_doPocoObjTestButton.onClick.RemoveAllListeners();</span><br><span class="line">            m_doBoolTestButton.onClick.RemoveAllListeners();</span><br><span class="line"></span><br><span class="line">            m_doUnityObjTestButton.onClick.AddListener(DoUnityObjNullCheckTest);</span><br><span class="line">            m_doPocoObjTestButton.onClick.AddListener(DoPOCOObjNullCheckTest);</span><br><span class="line">            m_doBoolTestButton.onClick.AddListener(DoBoolObjNullCheckTest);</span><br><span class="line"></span><br><span class="line">            m_inputField.onValueChanged.RemoveAllListeners();</span><br><span class="line">            m_inputField.onValueChanged.AddListener(OnInputNumberChanged);</span><br><span class="line">            m_checkTimes = <span class="number">100000</span>;</span><br><span class="line">            m_inputField.text = m_checkTimes.ToString();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        [<span class="meta">Button(<span class="meta-string">"do unity.object null check test"</span>)</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">DoUnityObjNullCheckTest</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            System.Diagnostics.Stopwatch watcher = <span class="keyword">new</span> System.Diagnostics.Stopwatch();</span><br><span class="line">            watcher.Start();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m_checkTimes; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="literal">null</span> == m_emptyTransform) &#123;&#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (<span class="literal">null</span> == m_selfTransform) &#123;&#125;</span><br><span class="line">            &#125;</span><br><span class="line">            watcher.Stop();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">string</span> outPut = <span class="string">$"do unity.object null check test 2*<span class="subst">&#123;m_checkTimes&#125;</span> cost <span class="subst">&#123;watcher.ElapsedMilliseconds&#125;</span>ms"</span>;</span><br><span class="line">            m_outPutText.text = outPut;</span><br><span class="line">            Debug.Log(outPut);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        [<span class="meta">Button(<span class="meta-string">"do poco object null check test"</span>)</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">DoPOCOObjNullCheckTest</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            System.Diagnostics.Stopwatch watcher = <span class="keyword">new</span> System.Diagnostics.Stopwatch();</span><br><span class="line">            watcher.Start();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m_checkTimes; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="literal">null</span> == m_emptyObjA) &#123;&#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (<span class="literal">null</span> == m_objA) &#123;&#125;</span><br><span class="line">            &#125;</span><br><span class="line">            watcher.Stop();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">string</span> outPut = <span class="string">$"do poco object null check test 2*<span class="subst">&#123;m_checkTimes&#125;</span> cost <span class="subst">&#123;watcher.ElapsedMilliseconds&#125;</span>ms"</span>;</span><br><span class="line">            m_outPutText.text = outPut;</span><br><span class="line">            Debug.Log(outPut);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        [<span class="meta">Button(<span class="meta-string">"do bool check test"</span>)</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">DoBoolObjNullCheckTest</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            System.Diagnostics.Stopwatch watcher = <span class="keyword">new</span> System.Diagnostics.Stopwatch();</span><br><span class="line">            watcher.Start();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m_checkTimes; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (m_boolFalse) &#123;&#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (m_boolTrue) &#123;&#125;</span><br><span class="line">            &#125;</span><br><span class="line">            watcher.Stop();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">string</span> outPut = <span class="string">$"do bool check test 2*<span class="subst">&#123;m_checkTimes&#125;</span> cost <span class="subst">&#123;watcher.ElapsedMilliseconds&#125;</span>ms"</span>;</span><br><span class="line">            m_outPutText.text = outPut;</span><br><span class="line">            Debug.Log(outPut);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">OnInputNumberChanged</span>(<span class="params"><span class="keyword">string</span> arg0</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">int</span> result = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> (!Int32.TryParse(arg0, <span class="keyword">out</span> result))</span><br><span class="line">                result = Int32.MaxValue;</span><br><span class="line"></span><br><span class="line">            m_checkTimes = result;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> mono method</span></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Reset</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            InitTester();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Awake</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            InitTester();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnEnable</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">this</span>.enabled = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Test-Result"><a href="#Test-Result" class="headerlink" title="Test Result"></a>Test Result</h1><img src="/2020/06/20/20200620-unity-obj-null-check/20200620-pic001.png" class="" title="split">
<p>åˆ†åˆ«è¿›è¡Œ10wæ¬¡å’Œ100wæ¬¡æµ‹è¯•çœ‹çœ‹ç»“æœã€‚</p>
<p>10wæ¬¡:<br>Unity Object null check 4~7ms<br>POCO Object null check 0ms<br>bool check 0ms</p>
<p>100wæ¬¡:<br>Unity Object null check 45~60ms<br>POCO Object null check 3~4ms<br>bool check 2ms</p>
<p>å½“æ£€æµ‹æ•°é‡éå¸¸å¤šçš„æ—¶å€™ï¼ŒUnity Object ç©ºå¼•ç”¨æ£€æŸ¥çš„æ€§èƒ½æ¶ˆè€—æ¯”å…¶ä»–ä¸¤ä¸ªå¤§äº†å¾ˆå¤šå¾ˆå¤šã€‚ç°åœ¨çš„é¡¹ç›®é‡Œå¤§éƒ¨åˆ†ä¸œè¥¿å…¶å®éƒ½æ˜¯POCOçš„ã€‚<br>ä¼¼ä¹æŠŠUnityObject Destroyä¹‹åå†æ‰‹åŠ¨æŠŠå˜é‡ç½®ç©ºæ˜¯ä¸ªå¥½ä¹ æƒ¯ï¼ˆ</p>
]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>Unity</tag>
        <tag>UnityOptimization</tag>
      </tags>
  </entry>
  <entry>
    <title>Unityå‡½æ•°Awakeå’ŒOnEnableæ‰§è¡Œé¡ºåºå°å‘</title>
    <url>/2020/06/22/20200622-awake-enable-order/</url>
    <content><![CDATA[<blockquote>
<p>Awake: This function is always called before any Start functions and also just after a prefabis instantiated. (If a GameObject is inactive during start up Awake is not called until it is made active.)</p>
<p>OnEnable: (only called if the Object is active): This function is called just after the object is enabled. This happens when a MonoBehaviour instance is created, such as when a level is loaded or a GameObject with the script component is instantiated.</p>
</blockquote>
<p><a href="https://docs.unity3d.com/Manual/ExecutionOrder.html" target="_blank" rel="noopener">check the exec order here</a></p>
<img src="/2020/06/22/20200622-awake-enable-order/20200622-pic001.png" class="" title="split">
<p>ä»Šå¤©åšå·¥æ—¶å€™é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘åœ¨Mono Açš„ Awake ä¸­æŠŠMono Açš„å®ä¾‹ç»‘å®šåˆ°äº†GameManageré‡Œï¼Œç„¶åå†Mono Bçš„ OnEnable ä¸­è·å–Mono Açš„å®ä¾‹ï¼Œç»“æœè·³äº†ä¸ªç©ºå¼•ç”¨å¼‚å¸¸ã€‚<br>æŠŠæˆ‘æƒŠäº†ï¼ŒåŸæ¥è¿™ä¸€å¹´å¤šæ¥æˆ‘ä¸€ç›´åœ¨ä¸€ä¸ªè¯¯åŒºé‡Œã€‚</p>
<p>æˆ‘ä»¥å‰ä¸€ç›´è®¤ä¸ºæ˜¯å½“åœºæ™¯é‡Œæ‰€æœ‰çš„ Awake è·‘å®Œæ‰å¼€å§‹è·‘ OnEnable()ã€‚ä½†å…¶å®ä¸æ˜¯è¿™æ ·çš„ã€‚</p>
<p><strong>å½“ä¸€ä¸ªMonoçš„ Awake è·‘å®Œä»¥åä¼šæ¥ç€è·‘ä»–çš„ OnEnable , æ¥ç€æ‰å»è·‘å…¶ä»–ç‰©ä½“çš„ Awake å’Œ OnEnableã€‚</strong></p>
<p>éšä¾¿å†™ä¸¤è¡Œæµ‹è¯•ä¸€ä¸‹å°±çŸ¥é“äº†ã€‚</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TesterA1</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> Type m_type = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Awake</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        m_type = <span class="keyword">this</span>.GetType();</span><br><span class="line">        Debug.Log(<span class="string">$"<span class="subst">&#123;m_type.Name&#125;</span> awake"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnEnable</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        Debug.Log(<span class="string">$"<span class="subst">&#123;m_type.Name&#125;</span> on enable"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TesterB1</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Start is called before the first frame update</span></span><br><span class="line">    <span class="keyword">private</span> Type m_type = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Awake</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        m_type = <span class="keyword">this</span>.GetType();</span><br><span class="line">        Debug.Log(<span class="string">$"<span class="subst">&#123;m_type.Name&#125;</span> awake"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnEnable</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        Debug.Log(<span class="string">$"<span class="subst">&#123;m_type.Name&#125;</span> on enable"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TesterC1</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> Type m_type = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Awake</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        m_type = <span class="keyword">this</span>.GetType();</span><br><span class="line">        Debug.Log(<span class="string">$"<span class="subst">&#123;m_type.Name&#125;</span> awake"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnEnable</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        Debug.Log(<span class="string">$"<span class="subst">&#123;m_type.Name&#125;</span> on enable"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>éƒ½æ•´ä¸Šä¸€æ ·çš„å†…å®¹ï¼ŒAå’ŒCç»‘åœ¨ç‰©ä½“tester01ä¸Šï¼ŒBç»‘åœ¨ç‰©ä½“tester02ä¸Šã€‚</p>
<img src="/2020/06/22/20200622-awake-enable-order/20200622-pic002.png" class="" title="split">
]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title>Unity OnAudioFilterRead å­¦ä¹ ç¬”è®°</title>
    <url>/2020/10/17/20201017-unity-onaudiofilterread/</url>
    <content><![CDATA[<p>æœ€è¿‘æƒ³ç€åšä¸€ä¸ªéŸ³ä¹æ¸¸æˆçš„DEMOè¯•è¯•ï¼Œä½†æ˜¯æ¯«æ— å¤´ç»ªä¸çŸ¥é“æ€ä¹ˆå¼€å§‹ã€‚çœ‹äº†ä¸‹é‚¦é‚¦çš„è§†é¢‘å†³å®šå…ˆæŠŠèŠ‚æ‹å™¨åšå‡ºæ¥ï¼Œå†ç”¨èŠ‚æ‹å™¨æä¾›çš„äº‹ä»¶å»æ”¯æ’‘èµ·å…¶å®ƒçš„éƒ¨åˆ†ã€‚</p>
<p>å› ä¸ºå®Œå…¨æ²¡åšè¿‡éŸ³ä¹æ¸¸æˆï¼Œè€Œä¸”ä¹Ÿå¯¹æ¸¸æˆå¼•æ“ä»¥åŠå£°éŸ³æ–¹é¢æ²¡æœ‰ä»€ä¹ˆäº†è§£ï¼Œæ‰€ä»¥å¼€å§‹åœ¨ç½‘ä¸Šæµ·æœèŠ‚æ‹å™¨çš„ä»£ç å¹¶æ‹¿æ¥æµ‹è¯•ã€‚</p>
<p>æœ€åå¾—åˆ°ä¿©è§£å†³æ–¹æ¡ˆï¼š1.åœ¨Unityé‡Œå†™ä¸€ä¸ªï¼›2.ä½¿ç”¨ä¸“ä¸šçš„éŸ³é¢‘æ’ä»¶ï¼ˆå¦‚CRIWAREæˆ–è€…WWISEï¼‰ï¼Œä½¿ç”¨é‡Œé¢çš„èŠ‚æ‹å™¨ã€‚<br>å› ä¸ºåªæ˜¯å°è¯•åšåšDEMOï¼Œå†³å®šå…ˆä¸å¼•å…¥éŸ³é¢‘æ’ä»¶äº†ã€‚</p>
<p>åœ¨å†²æµªæŸ¥è¯¢çš„æ—¶å€™å‘ç°Unityçš„å®˜æ–¹æ–‡æ¡£ä¸­å·²ç»å†™å¥½äº†ä¸€ä¸ªï¼çœŸæ˜¯å¤ªæ£’äº†ï¼Œé©¬ä¸Šå«–è¿‡æ¥ç”¨ã€‚ä¸ºäº†æ–¹ä¾¿ä¹‹åä½¿ç”¨ï¼Œæˆ‘ä¹Ÿå†³å®šæŠŠè¿™ä»½ä»£ç å°½å¯èƒ½çœ‹æ‡‚ã€‚</p>
<p>ä¸‹é¢æ˜¯Unityçš„æºç <br><a href="https://docs.unity3d.com/ScriptReference/MonoBehaviour.OnAudioFilterRead.html" target="_blank" rel="noopener">MonoBehaviour.OnAudioFilterRead(float[], int)</a><br><a href="https://docs.unity3d.com/ScriptReference/AudioSettings-dspTime.html" target="_blank" rel="noopener">AudioSettings.dspTime</a></p>
<h1 id="æå–åŸºæœ¬ä»£ç "><a href="#æå–åŸºæœ¬ä»£ç " class="headerlink" title="æå–åŸºæœ¬ä»£ç "></a>æå–åŸºæœ¬ä»£ç </h1><p>é¦–å…ˆæˆ‘å¤§æ¦‚è·‘äº†ä¸€ä¸‹ï¼Œçœ‹äº†ä¸€ä¸‹ï¼Œæå–å‡ºäº†æˆ‘è®¤ä¸ºæ˜¯èŠ‚æ‹å™¨æœ€åŸºæœ¬çš„éƒ¨åˆ†ã€‚</p>
<p>signatureHi / signatureLo =&gt; è¿™ä¸ªå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„å‡ å‡ æ‹ã€‚<br>signatureHiæ˜¯æ¯å°èŠ‚çš„æ‹å­æ•°ï¼ŒsignatureLoæ˜¯æŒ‡xåˆ†éŸ³ç¬¦ä¸º1æ‹ã€‚accentæ˜¯æŒ‡å½“å‰å°ç»“å†…çš„æ‹å­æ•°ã€‚</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">[<span class="meta">RequireComponent(typeof(AudioSource))</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MetronomeExample</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">double</span> bpm = <span class="number">128.0f</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> signatureHi = <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> signatureLo = <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> nextTick = <span class="number">0.0F</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> sampleRate = <span class="number">0.0F</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> accent= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">bool</span> running = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">event</span> System.Action&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; OnBeatTick;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Start</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        accent = signatureHi;</span><br><span class="line">        sampleRate = AudioSettings.outputSampleRate;</span><br><span class="line">        nextTick = AudioSettings.dspTime * sampleRate;</span><br><span class="line">        running = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnAudioFilterRead</span>(<span class="params"><span class="keyword">float</span>[] data, <span class="keyword">int</span> channels</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!running)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">double</span> samplesPerTick = sampleRate * (<span class="number">60.0f</span> / bpm) * (<span class="number">4.0f</span> / signatureLo);</span><br><span class="line">        <span class="keyword">double</span> sample = AudioSettings.dspTime * sampleRate;</span><br><span class="line">        <span class="keyword">int</span> dataLen = data.Length / channels;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (n &lt; dataLen)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">while</span> (sample + n &gt;= nextTick)</span><br><span class="line">            &#123;</span><br><span class="line">                nextTick += samplesPerTick;</span><br><span class="line">                <span class="keyword">if</span> (++accent &gt; signatureHi)</span><br><span class="line">                &#123;</span><br><span class="line">                    accent = <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                OnBeatTick?.Invoke(accent, signatureHi);</span><br><span class="line">                Debug.Log(<span class="string">$"Tick: <span class="subst">&#123;accent&#125;</span> / <span class="subst">&#123;signatureHi&#125;</span>"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            n++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line">nextTick = AudioSettings.dspTime * sampleRate; </span><br><span class="line">``` </span><br><span class="line">ä» Start() å¼€å§‹ï¼Œå…ˆåšèŠ‚æ‹å™¨çš„åˆå§‹åŒ–ã€‚ å› ä¸ºéœ€è¦å‡†ç¡®çš„éŸ³é¢‘æ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šä½¿ç”¨éŸ³é¢‘ç›¸å…³çš„å‡½æ•°æ¥æ“ä½œï¼Œè€Œä¸æ˜¯ä½¿ç”¨ Update()ã€‚</span><br><span class="line">é€šè¿‡å½“å‰çš„æ—¶é—´ * å½“å‰çš„é‡‡æ ·ç‡ï¼Œå¤§æ¦‚å°±èƒ½å¾—åˆ°å½“å‰çš„éŸ³é¢‘ä¿¡æ¯æ€»é‡ã€‚</span><br><span class="line"></span><br><span class="line">``` CSharp</span><br><span class="line">OnAudioFilterRead(<span class="keyword">float</span>[] data, <span class="keyword">int</span> channels)</span><br><span class="line">``` </span><br><span class="line">æ¥ç€æˆ‘ä»¬å¯ä»¥æŠŠ OnAudioFilterRead() çœ‹ä½œ Update() æ¥ä½¿ç”¨ã€‚ </span><br><span class="line">channels å¤§æ¦‚æ˜¯å£°é“æ•°,æ¯”å¦‚æˆ‘å¹³æ—¶ç”¨çš„è¾£é¸¡æœºå™¨æ˜¯åŒå£°é“ï¼ˆå·¦å³çš„ï¼‰ï¼Œé‚£ä¹ˆ channels çš„å€¼å°±æ˜¯<span class="number">2</span>ã€‚</span><br><span class="line">data[] ä¸­å­˜å‚¨çš„æ˜¯å½“å‰è¿™ä¸€æ¬¡éå†çš„éŸ³é¢‘æ•°æ®ï¼Œä¹Ÿä¼šåŒ…å«ä¸åŒå£°é“çš„éŸ³é¢‘ä¿¡æ¯ï¼Œæ¯”å¦‚\[<span class="number">0L</span>, <span class="number">1</span>R, <span class="number">2L</span>, <span class="number">3</span>R....\]ä¹‹ç±»çš„ã€‚</span><br><span class="line"></span><br><span class="line">``` CSharp</span><br><span class="line"><span class="keyword">double</span> samplesPerTick = sampleRate * (<span class="number">60.0f</span> / bpm) * (<span class="number">4.0f</span> / signatureLo);</span><br><span class="line"><span class="keyword">double</span> sample = AudioSettings.dspTime * sampleRate;</span><br><span class="line">``` </span><br><span class="line">è¿™é‡Œæ˜¯ç”¨ä¸è®¡ç®—æ‹å­çš„é—´éš”æ—¶é—´ã€‚(<span class="number">60.0f</span> / bpm) æ‰€è®¡ç®—çš„æ˜¯å¯¹äº <span class="number">4</span>/<span class="number">4</span> æ‹è€Œè¨€çš„æ‹å­é—´éš”æ—¶é—´ã€‚</span><br><span class="line">è€Œ (<span class="number">4.0f</span> / signatureLo) å¯ä»¥ç®—å‡ºä¸€ä¸ªå‚æ•°ï¼Œå¹¶ä¹˜ç»™ <span class="number">4</span>/<span class="number">4</span> æ‹è€Œè¨€çš„æ‹å­é—´éš”æ—¶é—´ã€‚</span><br><span class="line">sample å¯ä»¥ç²—æµ…çš„è®¤ä¸ºæ˜¯å½“å‰çš„æ—¶é—´ã€‚</span><br><span class="line"></span><br><span class="line">``` CSharp</span><br><span class="line"><span class="keyword">while</span> (n &lt; dataLen)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">while</span> (sample + n &gt;= nextTick)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ç”¨èµ·æ¥å°±ç›¸å½“äº</span></span><br><span class="line">        <span class="comment">// nextTime = Time.time * timeInterval; </span></span><br><span class="line">        nextTick += samplesPerTick;</span><br><span class="line">        <span class="keyword">if</span> (++accent &gt; signatureHi)</span><br><span class="line">        &#123;</span><br><span class="line">            accent = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        OnBeatTick?.Invoke(accent, signatureHi);</span><br><span class="line">        Debug.Log(<span class="string">$"Tick: <span class="subst">&#123;accent&#125;</span> / <span class="subst">&#123;signatureHi&#125;</span>"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    n++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™è¾¹éå†ä¸€ä¸‹æ¥ä¸‹æ¥ä¼šæ’­æ”¾çš„éŸ³é¢‘æ•°æ®ã€‚æ ¹æ®æ•°æ®çš„é•¿åº¦æ¥åˆ¤æ–­æ˜¯å¦ä¼šéœ€è¦å‘å‡ºèŠ‚æ‹å™¨çš„ tickã€‚</p>
<h1 id="èŠ‚æ‹å™¨éŸ³æ•ˆ"><a href="#èŠ‚æ‹å™¨éŸ³æ•ˆ" class="headerlink" title="èŠ‚æ‹å™¨éŸ³æ•ˆ"></a>èŠ‚æ‹å™¨éŸ³æ•ˆ</h1><p>åœ¨å®˜æ–¹æºç ä¸­è¿˜ç”¨åˆ°äº†ä¸€äº›å…¶ä»–çš„å˜é‡ï¼Œå¹¶ç»™dataèµ‹å€¼ï¼Œå…¶å®è¿™äº›å°±æ˜¯ä¸ºäº†æ’­æ”¾èŠ‚æ‹å™¨éŸ³æ•ˆè€Œå­˜åœ¨çš„ã€‚</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">while</span> (n&lt;dataLen)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">float</span> x = gain * amp * Mathf.Sin(phase);</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (i &lt; channels)</span><br><span class="line">    &#123;</span><br><span class="line">        data[n * channels + i] += x;</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (sample + n &gt;= nextTick)</span><br><span class="line">    &#123;</span><br><span class="line">        nextTick += samplesPerTick;</span><br><span class="line">        amp = <span class="number">1.0F</span>;</span><br><span class="line">        <span class="keyword">if</span> (++accent &gt; signatureHi)</span><br><span class="line">        &#123;</span><br><span class="line">            accent = <span class="number">1</span>;</span><br><span class="line">            amp *= <span class="number">2.0F</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        OnBeatTick?.Invoke(accent, signatureHi);</span><br><span class="line">        Debug.Log(<span class="string">$"Tick: <span class="subst">&#123;accent&#125;</span> / <span class="subst">&#123;signatureHi&#125;</span>"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    phase += amp* <span class="number">0.3F</span>;</span><br><span class="line">    amp *= <span class="number">0.993F</span>;</span><br><span class="line">    n++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="æ‘¸äº†"><a href="#æ‘¸äº†" class="headerlink" title="æ‘¸äº†"></a>æ‘¸äº†</h1><p>æ„Ÿè§‰è‡ªå·±çš„çŸ¥è¯†é¢åˆçª„åˆæµ…ï¼Œè¿˜æ˜¯éœ€è¦å¤šçœ‹ä¹¦æ‰è¡Œã€‚</p>
]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>Unity</tag>
        <tag>Audio</tag>
      </tags>
  </entry>
  <entry>
    <title>UnityEditor Scrollview Pagination(åˆ†é¡µ)</title>
    <url>/2020/06/26/20200626-unity-editor-scrollview-pagination/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä¹‹å‰åœ¨åšCloneConsoleçš„æ—¶å€™ï¼Œä¼šåœ¨æ¯æ¬¡ç»˜åˆ¶çš„æ—¶å€™å°è¯•ç»˜åˆ¶æ‰€æœ‰çš„logï¼Œç„¶åå†äº¤ç»™UnityEditorè‡ªå·±å»å¤„ç†æ˜¾ç¤ºçš„é€»è¾‘ã€‚å› ä¸ºæˆ‘ä»¬ä¼šå †ç§¯å‡ ç™¾ç”šè‡³å‡ åƒæ¡logï¼Œè¿™æ ·çš„åšæ³•æ— ç–‘ä¼šå¸¦æ¥æ€§èƒ½é—®é¢˜ï¼Œç»“æœå°±æ˜¯consoleå¡å¾—ä¸èƒ½ç”¨ã€‚</p>
<h1 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h1><p>å…¶å®æ€è·¯ä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦ç”»é‚£äº›ä¼šæ˜¾ç¤ºå‡ºæ¥çš„itemå°±è¡Œäº†ã€‚<br>åœ¨è¿™ä¹‹å‰éœ€è¦ç®—å‡ºå“ªäº›itemæ˜¯å¯ä»¥è¢«æ˜¾ç¤ºå‡ºæ¥çš„</p>
<ol>
<li>ç®—å‡ºæ‰€æœ‰çš„itemåŠ èµ·æ¥æœ‰å¤šé«˜</li>
<li>ç”¨å½“å‰æ»‘æ¡çš„ä½ç½®æ¥æ¨ç®—å‡ºå½“å‰éœ€è¦ç»˜åˆ¶çš„ç¬¬ä¸€æ¡itemçš„ç´¢å¼•</li>
<li>ç»˜åˆ¶item</li>
<li>ç»˜åˆ¶æ»‘æ¡å¹¶è®¡ç®—å…¶ä¸‹ä¸€æ¬¡çš„ä½ç½®</li>
</ol>
<p>å…¶å®è¿™ä¸ªæ€è·¯åº”è¯¥ä¹Ÿèƒ½åº”ç”¨åˆ°UGUIä¸Šï¼Œä¸‹æ¬¡æˆ‘ä¹Ÿè¦è¯•è¯•ã€‚</p>
<h1 id="ä¸Šä»£ç "><a href="#ä¸Šä»£ç " class="headerlink" title="ä¸Šä»£ç "></a>ä¸Šä»£ç </h1><p>åœ¨ä¸€ä¸ªæ–°çª—å£ä¸­å°è¯•ç”»ä¸€ç”»å°±å¥½ã€‚<br>é¦–å…ˆè¦å‡†å¤‡å¥½ç”¨æ¥æµ‹è¯•çš„ä¸€äº›æ•°æ®ã€‚</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">TempDraw</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">System.Serializable</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">struct</span> TempDrawData</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">int</span> IconTag;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">string</span> TempMessage;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TempDrawWindowTester</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> TempDrawWindowTester _instance = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">public</span> TempDrawWindowTester Instance =&gt; _instance;</span><br><span class="line"></span><br><span class="line">        List&lt;TempDrawData&gt; m_data = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// used to give out the data</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">event</span> System.Action&lt;List&lt;TempDrawData&gt;&gt; OnDataSpread;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æŠŠæµ‹è¯•ç”¨çš„æ•°æ®éƒ½å­˜åœ¨è¿™ä¸ªMonoé‡Œï¼Œå†ç”¨å®ƒçš„é™æ€äº‹ä»¶æŠŠæ•°æ®ä¼ é€’åˆ°çª—å£ä¸­ã€‚<br>ä»£ç é‡Œçš„ Button attribute æ˜¯ç”¨æ¥åœ¨editorä¸Šåˆ›å»ºæŒ‰é’®çš„ã€‚</p>
<p>æµ‹è¯•ç”¨çš„æ•°æ®å‡†å¤‡å¥½äº†ï¼Œæˆ‘ä»¬æ¥æ¥è¿›è¡Œç»˜åˆ¶ã€‚</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> UnityEditor;</span><br><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">TempDraw</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TempDrawWindow</span> : <span class="title">EditorWindow</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">string</span> WINDOW_NAME = <span class="string">"Temp Draw Window"</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> TempDrawWindow _instance = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> TempDrawWindow Instance =&gt; _instance;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> List&lt;TempDrawData&gt; m_data = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">float</span> m_scrollPosition = <span class="number">0.0f</span>;</span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> temp element</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">const</span> <span class="keyword">float</span> ELEMENT_HEIGHT = <span class="number">20.0f</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">const</span> <span class="keyword">float</span> ELEMENT_ICON_SIZE = <span class="number">20.0f</span>;</span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> icons</span></span><br><span class="line">        <span class="keyword">private</span> Texture2D m_infoIconSmall = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">private</span> Texture2D m_warningIconSmall = <span class="literal">null</span>;</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">        [<span class="meta">MenuItem(<span class="meta-string">"Window/Temp Draw Window"</span>)</span>]</span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">OpenWindow</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            TempDrawWindow window = GetWindow&lt;TempDrawWindow&gt;();</span><br><span class="line">            Texture2D icon = EditorGUIUtility.Load(<span class="string">"icons/UnityEditor.ConsoleWindow.png"</span>) <span class="keyword">as</span> Texture2D;</span><br><span class="line">            window.titleContent = <span class="keyword">new</span> GUIContent(WINDOW_NAME, icon);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SetData</span>(<span class="params">List&lt;TempDrawData&gt; data</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> == m_data)</span><br><span class="line">                m_data = <span class="keyword">new</span> List&lt;TempDrawData&gt;();</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                m_data.Clear();</span><br><span class="line"></span><br><span class="line">            m_data.AddRange(data);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">DrawTempElement</span>(<span class="params">Rect elementRect, <span class="keyword">int</span> dataIndex</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            Rect iconRect = <span class="keyword">new</span> Rect(elementRect.x, elementRect.y, ELEMENT_ICON_SIZE, elementRect.height);</span><br><span class="line">            <span class="keyword">if</span> (m_data[dataIndex].IconTag == <span class="number">0</span>)</span><br><span class="line">                GUI.Label(iconRect, m_infoIconSmall);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                GUI.Label(iconRect, m_warningIconSmall);</span><br><span class="line"></span><br><span class="line">            Rect labelRect = <span class="keyword">new</span> Rect(elementRect.x + ELEMENT_ICON_SIZE, elementRect.y, elementRect.width - ELEMENT_ICON_SIZE, elementRect.height);</span><br><span class="line">            GUI.Label(labelRect, <span class="string">$"Tag: <span class="subst">&#123;m_data[dataIndex].IconTag&#125;</span> ; Message: <span class="subst">&#123;m_data[dataIndex].TempMessage&#125;</span> ;"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">DrawTempRect</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="comment">// only use half space of this shit window</span></span><br><span class="line">            Rect viewportRect = <span class="keyword">new</span> Rect(<span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="keyword">this</span>.position.width, <span class="keyword">this</span>.position.height * <span class="number">0.5f</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">float</span> scrollbarWidth = GUI.skin.verticalScrollbar.fixedWidth;</span><br><span class="line">            Rect scrollbarRect = <span class="keyword">new</span> Rect(viewportRect.x + viewportRect.width - scrollbarWidth, viewportRect.y, scrollbarWidth, viewportRect.height);</span><br><span class="line">            Rect currentRect = <span class="keyword">new</span> Rect(<span class="number">0.0f</span>, <span class="number">0.0f</span>, viewportRect.width - scrollbarWidth, viewportRect.height);</span><br><span class="line">            <span class="keyword">float</span> viewportHeight = viewportRect.height;</span><br><span class="line">            <span class="keyword">int</span> elementCount = m_data.Count;</span><br><span class="line"></span><br><span class="line">            GUI.BeginClip(currentRect); <span class="comment">// to clip the overflow stuff</span></span><br><span class="line">            <span class="keyword">int</span> indexOffset = Mathf.FloorToInt(m_scrollPosition / ELEMENT_HEIGHT);</span><br><span class="line">            <span class="keyword">int</span> showCount = Mathf.CeilToInt(currentRect.height / ELEMENT_HEIGHT);</span><br><span class="line">            showCount = showCount &gt; elementCount ? elementCount : showCount;</span><br><span class="line">            <span class="keyword">float</span> startPosY = (indexOffset * ELEMENT_HEIGHT) - m_scrollPosition;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; showCount; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                Rect elementRect = <span class="keyword">new</span> Rect(<span class="number">0</span>, <span class="number">0</span> + startPosY + i * ELEMENT_HEIGHT, currentRect.width, ELEMENT_HEIGHT);</span><br><span class="line">                DrawTempElement(elementRect, indexOffset + i);</span><br><span class="line">            &#125;</span><br><span class="line">            GUI.EndClip();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// do stuff for scroller</span></span><br><span class="line">            <span class="keyword">float</span> fullElementHeight = elementCount * ELEMENT_HEIGHT;</span><br><span class="line">            m_scrollPosition = Mathf.Max(<span class="number">0</span>, GUI.VerticalScrollbar(scrollbarRect, m_scrollPosition, currentRect.height, <span class="number">0</span>, Mathf.Max(fullElementHeight, currentRect.height)));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">int</span> controlId = GUIUtility.GetControlID(FocusType.Passive);</span><br><span class="line">            <span class="keyword">float</span> scrollSensitivity = ELEMENT_HEIGHT;</span><br><span class="line">            <span class="keyword">float</span> maxScrollPos = (fullElementHeight &gt; currentRect.height) ? (fullElementHeight - currentRect.height) : <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (EventType.ScrollWheel == Event.current.GetTypeForControl(controlId))</span><br><span class="line">            &#123;</span><br><span class="line">                m_scrollPosition = Mathf.Clamp(m_scrollPosition + Event.current.delta.y * scrollSensitivity, <span class="number">0</span>, maxScrollPos);</span><br><span class="line">                Event.current.Use();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">GetAsset</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            m_infoIconSmall = EditorGUIUtility.Load(<span class="string">"icons/console.infoicon.sml.png"</span>) <span class="keyword">as</span> Texture2D;</span><br><span class="line">            m_warningIconSmall = EditorGUIUtility.Load(<span class="string">"icons/console.warnicon.sml.png"</span>) <span class="keyword">as</span> Texture2D;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> life cycle</span></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Awake</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            _instance = <span class="keyword">this</span>;</span><br><span class="line">            m_data = <span class="keyword">new</span> List&lt;TempDrawData&gt;();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnEnable</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            TempDrawWindowTester.OnDataSpread -= SetData;</span><br><span class="line">            TempDrawWindowTester.OnDataSpread += SetData;</span><br><span class="line">            GetAsset();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnGUI</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            DrawTempRect();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnDestroy</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            TempDrawWindowTester.OnDataSpread -= SetData;</span><br><span class="line">            _instance = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<img src="/2020/06/26/20200626-unity-editor-scrollview-pagination/20200626-pic001.png" class="" title="split">
<img src="/2020/06/26/20200626-unity-editor-scrollview-pagination/20200626-pic002.png" class="" title="split">
<p>æ•ˆæœå¦‚å›¾</p>
]]></content>
      <categories>
        <category>UnityEditor</category>
      </categories>
      <tags>
        <tag>Unity</tag>
        <tag>UnityEditor</tag>
      </tags>
  </entry>
  <entry>
    <title>JSè„šæœ¬åˆ é™¤è±†ç“£å¹¿æ’­</title>
    <url>/2020/12/20/20201220-delete-douban-post/</url>
    <content><![CDATA[<h1 id="JSè„šæœ¬åˆ é™¤è±†ç“£å¹¿æ’­"><a href="#JSè„šæœ¬åˆ é™¤è±†ç“£å¹¿æ’­" class="headerlink" title="JSè„šæœ¬åˆ é™¤è±†ç“£å¹¿æ’­"></a>JSè„šæœ¬åˆ é™¤è±†ç“£å¹¿æ’­</h1><p>å¾ˆä¹…ä»¥å‰ä¸ºäº†æ¸…ç†è‡ªå·±SPAMåœ¨å¾®åšçš„ä¸œè¥¿ï¼Œæ‰¾è¿‡æ‰¹é‡åˆ é™¤å¾®åšçš„è„šæœ¬ã€‚ç°åœ¨ä¹Ÿæƒ³é¡ºæ‰‹æ¸…ç†ä¸€ä¸‹è±†ç“£çš„ï¼Œä¸è¿‡æ²¡æ‰¾åˆ°æ¯”è¾ƒå¥½ç”¨çš„ã€‚<br>ä¸è¿‡å®Œå…¨ä¸ä¼šWEBå¼€å‘ï¼Œä¹Ÿåªèƒ½è‡ªå·±æ‹¼å‡‘ä¸€ä¸‹ã€‚</p>
<p>ç›´æ¥ä¸Šä»£ç å§</p>
<h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><p>è±†ç“£æœ‰ä¿æŠ¤æœºåˆ¶çš„ï¼Œå¦‚æœåœ¨çŸ­æ—¶é—´å†…ç–¯ç‹‚å‘é€è¯·æ±‚ï¼Œä¼šåœ¨ä¸€å®šæ—¶é—´å†…è¢«BAN IPï¼ˆäº²èº«ç»å†ï¼‰ã€‚<br>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¯•ç€ç”¨éšæœºç­‰å¾…çš„æ–¹å¼æ¥é¿å…è¿™ä¸ªé—®é¢˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// I steal this from somewhere</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sleepWait</span>(<span class="params">waitMsec</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> startMsec = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">    <span class="keyword">while</span> (<span class="keyword">new</span> <span class="built_in">Date</span>() - startMsec &lt; waitMsec);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">execTest</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> step = <span class="number">0</span>; step &lt; <span class="number">10</span>; step++) &#123;</span><br><span class="line">        location.reload();</span><br><span class="line">        <span class="keyword">var</span> waitDuration = (<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">10</span>) + <span class="number">1</span>) * <span class="number">10000</span>;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'test log, next exec in'</span> + waitDuration + <span class="string">'ms'</span>);</span><br><span class="line">        sleepWait(waitDuration);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åˆ é™¤çš„ä»£ç æ˜¯æˆ‘ç™½å«–æ¥çš„ï¼Œåœ¨ æˆ‘çš„å¹¿æ’­ çš„é¡µé¢é‡Œæ‰§è¡Œè¿™ä¸ªå‡½æ•°å¤§æ¦‚å¯ä»¥åˆ é™¤å½“å‰é¡µé¢ä¸­çš„æ‰€æœ‰å¹¿æ’­ã€‚<br>ä¸è¿‡è½¬å‘å¥½åƒä¸ä¸€å®šèƒ½åˆ é™¤ï¼Œä¹‹åè¿˜å¾—æ‰¾åˆ«çš„æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// I steal this from somewhere</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">execDelTest</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="function"><span class="keyword">function</span>(<span class="params">c</span>) </span>&#123; $.post_withck(<span class="string">"/j/status/delete"</span>, &#123; <span class="attr">sid</span>: c &#125;) &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> b = <span class="function"><span class="keyword">function</span>(<span class="params">c</span>) </span>&#123; $.post_withck(<span class="string">"/j/status/unreshare"</span>, &#123; <span class="attr">sid</span>: c &#125;) &#125;;</span><br><span class="line"></span><br><span class="line">    $(<span class="string">"a[data-reshare-id]"</span>).each(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        b($(<span class="keyword">this</span>).attr(<span class="string">"data-reshare-id"</span>));</span><br><span class="line">        $(<span class="keyword">this</span>).hide()</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    $(<span class="string">"div[data-sid]"</span>).each(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        a($(<span class="keyword">this</span>).attr(<span class="string">"data-sid"</span>));</span><br><span class="line">        $(<span class="keyword">this</span>).hide()</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>å®Œæ•´ä»£ç å¦‚ä¸‹ï¼Œä¸è¿‡çœŸçš„æ€•è¢«BAN IP å¯ä»¥æŠŠéšæœºç­‰å¾…çš„æ—¶é—´è®¾å®šå¾—é•¿ä¸€äº›</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// I steal this from somewhere</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sleepWait</span>(<span class="params">waitMsec</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> startMsec = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">    <span class="keyword">while</span> (<span class="keyword">new</span> <span class="built_in">Date</span>() - startMsec &lt; waitMsec);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// I steal this from somewhere</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">execDelTest</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="function"><span class="keyword">function</span>(<span class="params">c</span>) </span>&#123; $.post_withck(<span class="string">"/j/status/delete"</span>, &#123; <span class="attr">sid</span>: c &#125;) &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> b = <span class="function"><span class="keyword">function</span>(<span class="params">c</span>) </span>&#123; $.post_withck(<span class="string">"/j/status/unreshare"</span>, &#123; <span class="attr">sid</span>: c &#125;) &#125;;</span><br><span class="line"></span><br><span class="line">    $(<span class="string">"a[data-reshare-id]"</span>).each(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        b($(<span class="keyword">this</span>).attr(<span class="string">"data-reshare-id"</span>));</span><br><span class="line">        $(<span class="keyword">this</span>).hide()</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    $(<span class="string">"div[data-sid]"</span>).each(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        a($(<span class="keyword">this</span>).attr(<span class="string">"data-sid"</span>));</span><br><span class="line">        $(<span class="keyword">this</span>).hide()</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">execDelLoop</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> step = <span class="number">0</span>; step &lt; <span class="number">10</span>; step++) &#123;</span><br><span class="line">        location.reload();</span><br><span class="line">        <span class="keyword">var</span> waitDuration = (<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">10</span>) + <span class="number">1</span>) * <span class="number">10000</span>;</span><br><span class="line">        sleepWait(waitDuration);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// finally execute deletion :D</span></span><br><span class="line">execDelLoop();</span><br></pre></td></tr></table></figure>
<h2 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a>ä»£ç </h2><p>æ„Ÿè§‰webè¿™è¾¹å¯ä»¥åšè›®å¤šæ–¹ä¾¿æ—¥å¸¸ç”Ÿæ´»ç”¨çš„è„šæœ¬ï¼Œæ”¹å¤©çœŸçš„è¦å¼€å§‹å­¦ä¸€å­¦æ‰è¡Œã€‚</p>
]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>å¸¸ç”¨</tag>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title>æŸ¥è¯¢Unity Objectåœ¨å·¥ç¨‹ä¸­çš„å¼•ç”¨</title>
    <url>/2020/11/21/20201121-find-asset-reference/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä¸Šå‘¨æŠŠbugä¿®å¾—å·®ä¸å¤šäº†ï¼Œè¿™å‘¨ç¨å¾®æœ‰ç‚¹ç©ºé—²æ—¶é—´äº†ï¼Œå°±æŠŠä»¥å‰æƒ³åšçš„ä¸€äº›ä¸œè¥¿å¤§æ¦‚çœ‹äº†ä¸€ä¸‹ã€‚<br>ä¹‹å‰å› ä¸ºæ¸…ç†æ–‡ä»¶æ²¡æœ‰åŠæ—¶æ¸…é™¤ç›¸å…³å¼•ç”¨ï¼Œç»“æœé¡¹ç›®è·‘èµ·æ¥çš„æ—¶å€™æœ‰å„ç§æ²™é›•æŠ¥é”™ã€‚åªèƒ½å†ä¸€ä¸ªä¸ªç‰©ä½“æ£€æŸ¥ï¼Œå¥½éº»çƒ¦ã€‚<br>äºæ˜¯æƒ³è¯•è¯•èƒ½ä¸èƒ½æŸ¥åˆ°æŸä¸ªç‰©ä½“è¢«å…¶å®ƒå“ªäº›ç‰©ä½“å¼•ç”¨ã€‚</p>
<h1 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h1><p>å¥½åœ¨ Unityæä¾›äº†è¿™ä¸ªå‡½æ•° AssetDatabase.GetDependencies() ,å¯ä»¥è·å¾—æŸä¸ª asset çš„ä¾èµ–é¡¹ã€‚<br><a href="https://docs.unity3d.com/ScriptReference/AssetDatabase.GetDependencies.html" target="_blank" rel="noopener">AssetDatabase.GetDependencies()</a></p>
<p>å‡è®¾æˆ‘ä»¬éœ€è¦çŸ¥é“ç‰©ä½“ A è¢«å“ªäº›å…¶ä»–çš„ç‰©ä½“å¼•ç”¨ã€‚é‚£å°±éå†æ‰€æœ‰ç‰©ä½“çš„ä¾èµ–é¡¹ï¼ŒæŠŠä¾èµ–é¡¹ä¸­åŒ…å«ç‰©ä½“ A çš„ç‰©ä½“ç­›é€‰å‡ºæ¥å³å¯ã€‚</p>
<h1 id="ä¸Šä»£ç "><a href="#ä¸Šä»£ç " class="headerlink" title="ä¸Šä»£ç "></a>ä¸Šä»£ç </h1><figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// to find the reference of the target unity object</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">FindReferencesInProject</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">bool</span> <span class="title">TryFindReferenceOfUobject</span>(<span class="params">UnityEngine.Object uobject</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">bool</span> result = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">string</span> path = AssetDatabase.GetAssetPath(uobject);</span><br><span class="line">        <span class="keyword">if</span> (AssetDatabase.IsValidFolder(path))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// dun do it for a folder :)</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        FindObjectReference(uobject);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// why the order is like this?</span></span><br><span class="line">    [<span class="meta">MenuItem(<span class="meta-string">"Assets/Find References In Project"</span>)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">FindSelectedObjectReferences</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> != Selection.activeObject)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">string</span> path = AssetDatabase.GetAssetPath(Selection.activeObject);</span><br><span class="line">            <span class="keyword">if</span> (!AssetDatabase.IsValidFolder(path))</span><br><span class="line">            &#123;</span><br><span class="line">                FindObjectReference(Selection.activeObject);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">FindObjectReference</span>(<span class="params">UnityEngine.Object uobject</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        System.Diagnostics.Stopwatch stopWatcher = <span class="keyword">new</span> System.Diagnostics.Stopwatch();</span><br><span class="line">        stopWatcher.Start();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">string</span> targetPath = AssetDatabase.GetAssetPath(uobject);</span><br><span class="line">        List&lt;<span class="keyword">string</span>&gt; referencesPaths = <span class="keyword">new</span> List&lt;<span class="keyword">string</span>&gt;();</span><br><span class="line">        Dictionary&lt;<span class="keyword">string</span>, List&lt;<span class="keyword">string</span>&gt;&gt; referenceCache = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">string</span>, List&lt;<span class="keyword">string</span>&gt;&gt;();</span><br><span class="line">        <span class="keyword">string</span>[] assetGuids = AssetDatabase.FindAssets(<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; assetGuids.Length; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">string</span> assetPath = AssetDatabase.GUIDToAssetPath(assetGuids[i]);</span><br><span class="line">            <span class="keyword">string</span>[] dependencies = AssetDatabase.GetDependencies(assetPath, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; dependencies.Length; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (dependencies[j] == targetPath)</span><br><span class="line">                &#123;</span><br><span class="line">                    referencesPaths.Add(assetPath);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        FindReferencesInProjectEditor.OpenWindow();</span><br><span class="line">        FindReferencesInProjectEditor window = FindReferencesInProjectEditor.GetWindow();</span><br><span class="line">        window.SetPaths(referencesPaths.ToArray());</span><br><span class="line">        window.SetTargetUobject(uobject);</span><br><span class="line"></span><br><span class="line">        stopWatcher.Stop();</span><br><span class="line">        Debug.Log(<span class="string">$"search references for <span class="subst">&#123;uobject.name&#125;</span> cost <span class="subst">&#123;stopWatcher.ElapsedMilliseconds&#125;</span>ms"</span>);</span><br><span class="line"></span><br><span class="line">        referenceCache.Clear();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// a simple window to show the result, and also we can ping those result object :D</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">FindReferencesInProjectEditor</span> : <span class="title">EditorWindow</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> Rect m_viewportRect = <span class="keyword">default</span>;</span><br><span class="line">    <span class="keyword">private</span> Rect m_listRect = <span class="keyword">default</span>;</span><br><span class="line">    <span class="keyword">private</span> Rect m_bottomRect = <span class="keyword">default</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> m_scrollPosition = <span class="keyword">default</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">string</span>[] m_targetPaths = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">const</span> <span class="keyword">float</span> ELEMENT_HEIGHT = <span class="number">20.0f</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">const</span> <span class="keyword">float</span> ELEMENT_ICON_SIZE = <span class="number">20.0f</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">const</span> <span class="keyword">float</span> SCROLLER_WIDTH = <span class="number">15.0f</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">bool</span> m_hasGetGUIStyle = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> GUIStyle m_scrollerStyle = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> GUIStyle m_buttonElementStyle = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> UnityEngine.Object m_selectedUnityObject = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> System.Type m_uobjType = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">OpenWindow</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        FindReferencesInProjectEditor window = GetWindow&lt;FindReferencesInProjectEditor&gt;();</span><br><span class="line">        Texture2D icon = EditorGUIUtility.Load(<span class="string">"icons/UnityEditor.ConsoleWindow.png"</span>) <span class="keyword">as</span> Texture2D;</span><br><span class="line">        window.titleContent = <span class="keyword">new</span> GUIContent(<span class="string">"reference find result"</span>, icon);</span><br><span class="line">        Vector2 minSize = <span class="keyword">new</span> Vector2(<span class="number">500.0f</span>, <span class="number">300.0f</span>);</span><br><span class="line">        window.minSize = minSize;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> FindReferencesInProjectEditor <span class="title">GetWindow</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> GetWindow&lt;FindReferencesInProjectEditor&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SetPaths</span>(<span class="params"><span class="keyword">in</span> <span class="keyword">string</span>[] paths</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        m_targetPaths = paths;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SetTargetUobject</span>(<span class="params">UnityEngine.Object uobject</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        m_selectedUnityObject = uobject;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">DrawContent</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">// only use half space of this shit window</span></span><br><span class="line">        m_viewportRect = <span class="keyword">new</span> Rect(<span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="keyword">this</span>.position.width - SCROLLER_WIDTH, <span class="keyword">this</span>.position.height * <span class="number">0.8f</span>);</span><br><span class="line">        m_listRect = <span class="keyword">new</span> Rect(<span class="number">0.0f</span>, <span class="number">0.0f</span>, m_viewportRect.width, m_viewportRect.height);</span><br><span class="line">        <span class="keyword">int</span> elementCount = m_targetPaths.Length;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (elementCount &lt; <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        GUI.BeginClip(m_listRect); <span class="comment">// to clip the overflow stuff</span></span><br><span class="line">        <span class="keyword">int</span> indexOffset = Mathf.FloorToInt(m_scrollPosition / ELEMENT_HEIGHT);</span><br><span class="line">        <span class="keyword">int</span> showCount = Mathf.CeilToInt(m_listRect.height / ELEMENT_HEIGHT);</span><br><span class="line">        showCount = showCount &gt; elementCount ? elementCount : showCount;</span><br><span class="line">        <span class="keyword">float</span> startPosY = (indexOffset * ELEMENT_HEIGHT) - m_scrollPosition;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; showCount; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            Rect elementRect = <span class="keyword">new</span> Rect(<span class="number">0</span>, <span class="number">0</span> + startPosY + i * ELEMENT_HEIGHT, m_listRect.width, ELEMENT_HEIGHT);</span><br><span class="line">            DrawElement(elementRect, indexOffset + i);</span><br><span class="line">        &#125;</span><br><span class="line">        GUI.EndClip();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">DrawElement</span>(<span class="params">Rect elementRect, <span class="keyword">int</span> dataIndex</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (dataIndex &lt; m_targetPaths.Length &amp;&amp; GUI.Button(elementRect, <span class="string">$"path <span class="subst">&#123;m_targetPaths[dataIndex]&#125;</span> ;"</span>, m_buttonElementStyle))</span><br><span class="line">        &#123;</span><br><span class="line">            Debug.Log(<span class="string">$"<span class="subst">&#123;m_targetPaths[dataIndex]&#125;</span>"</span>);</span><br><span class="line">            UnityEngine.Object targetObj = AssetDatabase.LoadAssetAtPath&lt;UnityEngine.Object&gt;(m_targetPaths[dataIndex]);</span><br><span class="line">            EditorGUIUtility.PingObject(targetObj);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">DrawScroller</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">// draw scroller on the right correctly</span></span><br><span class="line">        <span class="keyword">int</span> elementCount = m_targetPaths.Length;</span><br><span class="line">        <span class="keyword">float</span> fullElementHeight = elementCount * ELEMENT_HEIGHT;</span><br><span class="line"></span><br><span class="line">        Rect scrollbarRect = <span class="keyword">new</span> Rect(m_viewportRect.x + m_viewportRect.width, m_viewportRect.y, SCROLLER_WIDTH, m_viewportRect.height);</span><br><span class="line">        m_scrollPosition = Mathf.Max(<span class="number">0</span>, GUI.VerticalScrollbar(scrollbarRect, m_scrollPosition, m_listRect.height, <span class="number">0</span>, Mathf.Max(fullElementHeight, m_listRect.height)));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> controlId = GUIUtility.GetControlID(FocusType.Passive);</span><br><span class="line">        <span class="keyword">float</span> scrollSensitivity = ELEMENT_HEIGHT;</span><br><span class="line">        <span class="keyword">float</span> maxScrollPos = (fullElementHeight &gt; m_listRect.height) ? (fullElementHeight - m_listRect.height) : <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (EventType.ScrollWheel == Event.current.GetTypeForControl(controlId))</span><br><span class="line">        &#123;</span><br><span class="line">            m_scrollPosition = Mathf.Clamp(m_scrollPosition + Event.current.delta.y * scrollSensitivity, <span class="number">0</span>, maxScrollPos);</span><br><span class="line">            Event.current.Use();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">GetGUIStyle</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">// scroller</span></span><br><span class="line">        m_scrollerStyle = <span class="keyword">new</span> GUIStyle(GUI.skin.verticalScrollbar);</span><br><span class="line">        m_scrollerStyle.stretchWidth = <span class="literal">false</span>;</span><br><span class="line">        m_scrollerStyle.fixedWidth = SCROLLER_WIDTH;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// button element</span></span><br><span class="line">        m_buttonElementStyle = <span class="keyword">new</span> GUIStyle(GUI.skin.button);</span><br><span class="line">        m_buttonElementStyle.alignment = TextAnchor.MiddleLeft;</span><br><span class="line"></span><br><span class="line">        m_uobjType = <span class="keyword">typeof</span>(UnityEngine.Object);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">DrawBottom</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        m_bottomRect = <span class="keyword">new</span> Rect(<span class="number">0.0f</span>, <span class="keyword">this</span>.position.height * <span class="number">0.8f</span>, <span class="keyword">this</span>.position.width, <span class="keyword">this</span>.position.height * <span class="number">0.2f</span>);</span><br><span class="line">        Rect fieldRect = <span class="keyword">new</span> Rect(<span class="number">10.0f</span>, m_bottomRect.y + <span class="number">10.0f</span>, <span class="number">100.0f</span>, <span class="number">20.0f</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> == m_uobjType)</span><br><span class="line">            m_uobjType = <span class="keyword">typeof</span>(UnityEngine.Object);</span><br><span class="line"></span><br><span class="line">        m_selectedUnityObject = EditorGUI.ObjectField(fieldRect, m_selectedUnityObject, m_uobjType, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">        Rect buttonRect = <span class="keyword">new</span> Rect(<span class="number">150.0f</span>, m_bottomRect.y, <span class="number">200.0f</span>, <span class="number">40.0f</span>);</span><br><span class="line">        <span class="keyword">if</span> (GUI.Button(buttonRect, <span class="string">"try find reference"</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            FindObjectReference();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">FindObjectReference</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> == m_selectedUnityObject)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Clear();</span><br><span class="line">        FindReferencesInProject.TryFindReferenceOfUobject(m_selectedUnityObject);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Clear</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        m_targetPaths = System.Array.Empty&lt;<span class="keyword">string</span>&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnGUI</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!m_hasGetGUIStyle)</span><br><span class="line">        &#123;</span><br><span class="line">            GetGUIStyle();</span><br><span class="line">            m_hasGetGUIStyle = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        DrawContent();</span><br><span class="line">        DrawScroller();</span><br><span class="line">        DrawBottom();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<img src="/2020/11/21/20201121-find-asset-reference/20201121-pic001.png" class="" title="split">
<img src="/2020/11/21/20201121-find-asset-reference/20201121-pic002.png" class="" title="split">
<p>æœç´¢ç»“æœæˆ‘é€‰æ‹©ä½¿ç”¨ä¸€ä¸ªç®€å•çš„ editor window æ¥æ˜¾ç¤ºã€‚<br>åŒæ—¶è¿˜èƒ½å¡«å…¥æ–°çš„ç›®æ ‡ç‰©ä½“å†åšä¸€æ¬¡æœç´¢ã€‚</p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æœ€è¿‘éƒ½æ²¡æœ‰åšç¼–è¾‘å™¨è¿™è¾¹çš„å¼€å‘ï¼Œæ„Ÿè§‰ç›´æ¥é€€å›äº†èµ·ç‚¹ã€‚æ„Ÿè§‰Unityç¼–è¾‘å™¨çš„æ–‡æ¡£æ²¡æœ‰æƒ³è±¡ä¸­é‚£ä¹ˆè¯¦ç»†ï¼Œå¾ˆå¤šæ—¶å€™åè€Œæ²¡æœ‰é—®åŒäº‹æ¥å¾—æ–¹ä¾¿ã€‚å¯èƒ½è¯¥æé«˜è‡ªå·±çš„è‹±æ–‡æ°´å¹³äº†ã€‚</p>
]]></content>
      <categories>
        <category>UnityEditor</category>
      </categories>
      <tags>
        <tag>Unity</tag>
        <tag>UnityEditor</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¿®æ”¹commitæ¶ˆæ¯</title>
    <url>/2021/04/08/20210408-edit-commit-msg/</url>
    <content><![CDATA[<p>å‰å‡ å¤©æ‰“æ¸¸æˆå¤ªç–¯äº†ï¼Œä¸Šç­çš„æ—¶å€™è„‘å­éƒ½ä¸æ¸…é†’ï¼Œcommitçš„æ—¶å€™è¾“é”™äº†ä¸œè¥¿ï¼Œpushçš„æ—¶å€™è¢«blockäº†æ‰å‘ç°ã€‚<br>ç»“æœè¿˜å› ä¸ºä¸ä¼šæ”¹commitæ¶ˆæ¯ï¼Œè¿˜é”™è¯¯åœ°æ“ä½œä½¿å¾—å·¥ä½œå…¨æ²¡äº†ã€‚</p>
<h1 id="ä¿®æ”¹å½“å‰æœ€æ–°çš„ä¸€æ¡commitæ¶ˆæ¯"><a href="#ä¿®æ”¹å½“å‰æœ€æ–°çš„ä¸€æ¡commitæ¶ˆæ¯" class="headerlink" title="ä¿®æ”¹å½“å‰æœ€æ–°çš„ä¸€æ¡commitæ¶ˆæ¯"></a>ä¿®æ”¹å½“å‰æœ€æ–°çš„ä¸€æ¡commitæ¶ˆæ¯</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹å½“å‰æœ€æ–°çš„ä¸€æ¡commitæ¶ˆæ¯</span></span><br><span class="line">git commit --amend</span><br></pre></td></tr></table></figure>
<p>éå¸¸ç®€å•ï¼Œä¸€ä¸ªå‘½ä»¤å°±æå®šäº†ã€‚ç„¶åå°±å¯ä»¥æ­£å¸¸pushäº†ã€‚</p>
<p>å¦‚æœæ˜¯éœ€è¦ä¿®æ”¹å·²ç»æ¨é€åˆ°è¿œç«¯çš„commitï¼Œå¯ä»¥å†è¿™ä¸ªå‘½ä»¤ä¹‹åå°è¯•push â€”forceã€‚<br>ä¸è¿‡æˆ‘è§‰å¾—è¿™æ ·çš„æƒ…æ™¯éå¸¸ä¹‹å°‘ï¼Œéƒ½å·²ç»PUSHä¸Šå»äº†ä¸ºå•¥è¿˜éœ€è¦æ”¹å•Š:(</p>
<h1 id="ä¿®æ”¹å¾€å‰ç¬¬Næ¡commitæ¶ˆæ¯-è¿˜æœªæ¨é€åˆ°è¿œç«¯çš„"><a href="#ä¿®æ”¹å¾€å‰ç¬¬Næ¡commitæ¶ˆæ¯-è¿˜æœªæ¨é€åˆ°è¿œç«¯çš„" class="headerlink" title="ä¿®æ”¹å¾€å‰ç¬¬Næ¡commitæ¶ˆæ¯(è¿˜æœªæ¨é€åˆ°è¿œç«¯çš„)"></a>ä¿®æ”¹å¾€å‰ç¬¬Næ¡commitæ¶ˆæ¯(è¿˜æœªæ¨é€åˆ°è¿œç«¯çš„)</h1><img src="/2021/04/08/20210408-edit-commit-msg/20210408-edit-commit-msg-01.png" class="" title="split">
<p>å¦‚å›¾ï¼Œæˆ‘éœ€è¦ä¿®æ”¹å›¾ä¸­é€‰å®šçš„é‚£ä¸€ä¸ªcommitã€‚ä»æˆ‘å½“å‰ä½ç½®æ•°ï¼Œæ˜¯ç¬¬3ä¸ªcommitã€‚<br>åˆ™Xå°±åº”è¯¥æ˜¯3ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">git rebase -i HEAD~X</span><br><span class="line"><span class="comment"># X is the number of commits to go back</span></span><br><span class="line"><span class="comment"># Move to the line of your commit, change pick into edit,</span></span><br><span class="line"><span class="comment"># then change your commit message:</span></span><br><span class="line">git commit --amend</span><br><span class="line"><span class="comment"># Finish the rebase with:</span></span><br><span class="line">git rebase --<span class="built_in">continue</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># :D</span></span><br><span class="line">git push</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œrebaseåï¼Œä¼šè®©é€‰æ‹©éœ€è¦å¯¹å“ªæ¡commitè¿›è¡Œä»€ä¹ˆæ ·çš„æ“ä½œã€‚</p>
<img src="/2021/04/08/20210408-edit-commit-msg/20210408-edit-commit-msg-02.png" class="" title="split">
<p>éœ€è¦ç¼–è¾‘æ¶ˆæ¯åˆ™å°±æŠŠpickæ”¹æˆeditï¼Œç„¶åä¿å­˜ï¼Œé€€å‡ºæ–‡æœ¬ç¼–è¾‘ã€‚å°±å¯ä»¥ä½¿ç”¨ commit â€”amend æ¥ä¿®æ”¹æ¶ˆæ¯äº†ï¼Œç„¶åå†æ‰§è¡Œä¸‹ä¸€æ¡å‘½ä»¤å®Œæˆrebaseã€‚<br>ç„¶åå°±æ˜¯å¿«ä¹pushã€‚</p>
<p>å…¶å®ä¹Ÿå¯ä»¥åŒæ—¶editå¤šæ¡commitã€‚è¿™æ ·ï¼Œåœ¨ä½¿ç”¨ã€€commit â€”amendã€€æ—¶ä¼šä»æœ€è€çš„commitå¼€å§‹ç¼–è¾‘ã€‚å®Œæˆä¸€æ¡çš„ç¼–è¾‘å°±éœ€è¦ rebase â€”continueã€‚<br>ä¹‹åæ‰èƒ½ç»§ç»­ç¼–è¾‘ä¸‹ä¸€æ¡ã€‚</p>
<img src="/2021/04/08/20210408-edit-commit-msg/20210408-edit-commit-msg-03.png" class="" title="split">
<p>å¦‚æœä¿®æ”¹äº†æ›¾ç»pushè¿‡çš„commitï¼Œå°±éœ€è¦push â€”forceã€‚</p>
<img src="/2021/04/08/20210408-edit-commit-msg/20210408-edit-commit-msg-04.png" class="" title="split">
<img src="/2021/04/08/20210408-edit-commit-msg/20210408-edit-commit-msg-05.png" class="" title="split">]]></content>
      <categories>
        <category>Git</category>
      </categories>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title>Git æœ¬åœ°å¿½ç•¥æ–‡ä»¶</title>
    <url>/2021/04/23/20210423-gitignore-locally/</url>
    <content><![CDATA[<p>æœ€è¿‘åœ¨æ‹¼UIï¼Œéœ€è¦å»ºç«‹å‡ ä¸ªä¸´æ—¶çš„åœºæ™¯åœ¨æœ¬åœ°ã€‚è‡ªç„¶ä¸èƒ½ä¸Šä¼ ï¼Œä½†æ˜¯åˆæƒ³æ‰‹è´± git add . è¿˜æ˜¯å†³å®šåœ¨æœ¬åœ°æ‰‹åŠ¨è®¾ç½®å¿½ç•¥ä¸€äº›æ–‡ä»¶ã€‚</p>
<h1 id="è®¾ç½®Git-exclude"><a href="#è®¾ç½®Git-exclude" class="headerlink" title="è®¾ç½®Git exclude"></a>è®¾ç½®Git exclude</h1><p>é¦–å…ˆéœ€è¦æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶ã€‚</p>
<p>exclude æ–‡ä»¶åœ¨ å¦‚å›¾çš„ç›®å½•ä¸­</p>
<img src="/2021/04/23/20210423-gitignore-locally/20210423-gitignore-locally-pic01.png" class="" title="split">
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">\.git\info\</span><br></pre></td></tr></table></figure>
<p>æ‰¾åˆ°ä»¥åä»¥æ–‡æœ¬æ–‡ä»¶çš„å½¢å¼æ‰“å¼€ï¼Œç”¨æ³•å’Œ gitignore å·®ä¸å¤šï¼Œæˆ‘è¿˜ä¹ˆæœ‰æ·±å…¥ç ”ç©¶ï¼Œä½†æˆ‘å·®ä¸å¤šè¿™æ ·ç”¨ã€‚</p>
<img src="/2021/04/23/20210423-gitignore-locally/20210423-gitignore-locally-pic02.png" class="" title="split">
<p>æŠŠæˆ‘éœ€è¦å¿½ç•¥çš„æœ¬åœ°ç›®å½•å¡«ä¸Šå»å°±å¯ä»¥äº†ã€‚<br>é¡ºä¾¿ä¸€è¯´ï¼Œè‹¥ä½¿ç”¨è¿™ä¸ªæ–¹å¼å¿½ç•¥äº†æŸä¸ªç›®å½•ï¼Œå½“æŠŠå·²ç»è¿›è¡Œç‰ˆæœ¬æ§åˆ¶çš„æ–‡ä»¶ä¸¢è¿›è¿™ä¸ªç›®å½•é‡Œæ—¶ï¼ŒGitä¸­ä¼šç”Ÿæˆä¸€ä¸ªdeleteçš„æ”¹åŠ¨ã€‚</p>
]]></content>
      <categories>
        <category>Git</category>
      </categories>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title>Unity è‡ªåˆ¶ Scrollrect å°å‘</title>
    <url>/2021/06/06/20210606-UGuiInputOnScrollkeng/</url>
    <content><![CDATA[<h1 id="é—®é¢˜å‡ºç°"><a href="#é—®é¢˜å‡ºç°" class="headerlink" title="é—®é¢˜å‡ºç°"></a>é—®é¢˜å‡ºç°</h1><p>ç»ˆäºæ”¹æ¥æ”¹å»ï¼Œä¿ºåšçš„è¿™ä¸ªå¾ªç¯æ»šåŠ¨åˆ—è¡¨æˆåŠŸè¿ç”¨åˆ°äº†é¡¹ç›®é‡Œçš„ä»“åº“UIä¸Šã€‚ä½†æ˜¯è¿˜æ˜¯è¢«ä¸€ä¸ªBUGç»™å‡»å®äº†ã€‚</p>
<p>UXç»™åˆ°çš„è®¾è®¡ç¨¿æ˜¯å½“ç©å®¶é¼ æ ‡åœ¨å…¶ä¸­ä¸€ä¸ªç‰©å“ä¸Šæ—¶ï¼Œè¦æœ‰ä¸€ä¸ªå°å¼¹çª—æ˜¾ç¤ºè¿™ä¸ªç‰©å“çš„ä¸€äº›è®¯æ¯ã€‚<br>BUGçš„è¡¨ç°æ˜¯å½“æˆ‘å·²ç»â€™é€‰ä¸­â€™ä¸€ä¸ªç‰©å“åï¼Œç”¨é¼ æ ‡æ»šè½®æ»šåˆ°ä¸‹ä¸€è¡Œï¼Œå°å¼¹çª—æ˜¾ç¤ºçš„è¿˜æ˜¯ä¸Šä¸€ä¸ªç‰©å“çš„è®¯æ¯ã€‚</p>
<h1 id="BUGåŸå› "><a href="#BUGåŸå› " class="headerlink" title="BUGåŸå› "></a>BUGåŸå› </h1><p>æˆ‘åœ¨UIè„šæœ¬ä¸­å†™äº†å…³äºé¼ æ ‡ç§»åŠ¨è¿›å…¥å’Œç¦»å¼€çš„å¤„ç†ï¼Œä½†å…¶å®å½“åˆ—è¡¨æ»šåŠ¨æ—¶å€™ï¼Œé¼ æ ‡ä¸‹é¢çš„ç‰©ä½“è¿˜æ˜¯ä¸Šä¸€ä¸ªç‰©ä½“ï¼Œä½†æ˜¯ç‰©ä½“å†…çš„æ•°æ®å·²ç»æ”¹å˜ï¼Œå´æ²¡æœ‰åˆ·æ–°ã€‚</p>
<h1 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h1><p>å…¶å®ä¹Ÿè¿˜ç®—æœ‰ä¸ªå‡‘åˆçš„è§£å†³æ–¹æ¡ˆã€‚å¯¼å¸ˆä¹‹å‰é‡å†™äº†InputModuleï¼Œæ‰€ä»¥æˆ‘ä»¬å†³å®šåœ¨è¿™è¾¹åšæ”¹åŠ¨ã€‚<br>å½“å‘ç”Ÿæ»šåŠ¨æ—¶ï¼Œæˆ‘ä»¬éœ€è¦é‡æ–°åšraycastã€‚<br><figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">OnScrollWheel</span>(<span class="params">InputAction.CallbackContext context</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (IsActive())</span><br><span class="line">    &#123;</span><br><span class="line">        PointerEventData eventData = GetPointerData();</span><br><span class="line">        eventData.button = PointerEventData.InputButton.Middle;</span><br><span class="line">        eventData.Reset();</span><br><span class="line">        eventData.scrollDelta = context.ReadValue&lt;Vector2&gt;()</span><br><span class="line">        GameObject testScrollObject = ExecuteEventExecuteHierarchy(eventData.pointerCurrentRaycasgameObject, eventData, ExecuteEvents.scrollHandler)</span><br><span class="line">        <span class="keyword">if</span> (testScrollObject != <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// to re-do the reycast cuz we may scroll a recyclscrollrect</span></span><br><span class="line">            HandlePointerExitAndEnter(eventData, <span class="literal">null</span>);</span><br><span class="line">            m_rayCastDelayFrame = SCROLL_RAYCAST_DELAY;</span><br><span class="line">            <span class="comment">// SCROLL_RAYCAST_DELAY =3 or 5, depends....</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>æˆ‘ä»¬å…ˆæ¸…æ¥šäº†äº‹ä»¶æ•°æ®æ‰€è®¤ä¸ºçš„é¼ æ ‡æ‚¬åœçš„ç‰©ä½“ï¼Œç„¶åè¿‡å‡ å¸§å†é‡æ–°å‘å°„å°„çº¿è¿›è¡Œæ£€æµ‹ã€‚<br>å› ä¸ºæˆ‘çš„å¾ªç¯æ»šåŠ¨åˆ—è¡¨ä¾èµ–äºUnityè‡ªå¸¦çš„æ»šåŠ¨è§†å›¾ï¼Œå¹¶ä¸”å…¶ä½ç½®ä¹Ÿæ˜¯åœ¨LateUpdateä¸­æ›´æ–°çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ€å¥½åœ¨ä¸‹ä¸€å¸§æˆ–è€…æ¥ä¸‹æ¥çš„å‡ å¸§åå†åšå°„çº¿æ£€æµ‹ã€‚ã€‚</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// will call in update</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Process</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    .....</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    CheckAndDoDelayRaycast();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CheckAndDoDelayRaycast</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (m_rayCastDelayFrame &lt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (--m_rayCastDelayFrame == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> eventData = GetPointerData();</span><br><span class="line">        eventSystem.RaycastAll(eventData, m_RaycastResultCache);</span><br><span class="line">        <span class="keyword">var</span> firstRaycast = FindFirstRaycast(m_RaycastResultCache)</span><br><span class="line">        eventData.pointerCurrentRaycast = firstRaycast;</span><br><span class="line">        m_RaycastResultCache.Clear()</span><br><span class="line">        <span class="keyword">var</span> temp = eventData.pointerCurrentRaycast.gameObject;</span><br><span class="line">        HandlePointerExitAndEnter(eventData, temp);</span><br><span class="line">        m_rayCastDelayFrame = <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>Unity</tag>
        <tag>UGUI</tag>
      </tags>
  </entry>
  <entry>
    <title>Unity2020 Graphic å°å‘</title>
    <url>/2021/08/31/20210831-raycast-padding/</url>
    <content><![CDATA[<p>æœ€è¿‘é¡¹ç›®å‡çº§äº†2020.3ï¼ŒGraphicè¿™è¾¹å¤šç»™äº†ä¸€ä¸ªRaycast Paddingçš„è®¾ç½®ã€‚<br>æˆ‘ä»¬æœ‰åœ¨ç”¨ä¸€äº›å®Œå…¨ç©ºç™½çš„å›¾ç‰‡æ¥æ¥å—UIçš„ç‚¹å‡»å“åº”ï¼ŒåŒæ—¶ä¹Ÿæœ‰ä¸€äº›ç”¨å›¾ç‰‡æ¥æ”¶ç‚¹å‡»çš„æŒ‰é’®ã€‚</p>
<p>ä½†å¾ˆå‘çˆ¹çš„æ˜¯ï¼Œæˆ‘å‘ç°æ— è®ºæ€ä¹ˆè®¾ç½®Raycast Paddingçš„å€¼ï¼Œåœºæ™¯é¢„è§ˆä¸­éƒ½æ²¡æœ‰æ˜¾ç¤ºæ¡†æ¡†ï¼Œæ‰€ä»¥æˆ‘å…¶å®æ˜¯å®Œå…¨ä¸çŸ¥é“è¿™ç©æ„å„¿åˆ°åº•æ€ä¹ˆç”¨çš„ã€‚<br>æœç´¢ä¸€ä¸‹æ‰çŸ¥é“åŸæ¥æ˜¯paddingçš„æ•°å€¼æ˜¯è´Ÿæ•°çš„æ—¶å€™æ‰æ˜¯å¾€å¤–æ‰©å¼ ã€‚</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">RaycastTarget</span> : <span class="title">Graphic</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Additionally, If you need a Raycast target that is not a rectangle, you can implement bool Raycast(Vector2 sp, Camera eventCamera) method from Graphic.</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">SetMaterialDirty</span>(<span class="params"></span>)</span> &#123; <span class="keyword">return</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">SetVerticesDirty</span>(<span class="params"></span>)</span> &#123; <span class="keyword">return</span>; &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> Probably not necessary since the chain of calls `Rebuild()`-&gt;`UpdateGeometry()`-&gt;`DoMeshGeneration()`-&gt;`OnPopulateMesh()` won't happen; so here really just as a fail-safe.</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnPopulateMesh</span>(<span class="params">VertexHelper vh</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        vh.Clear();</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> UNITY_EDITOR</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnDrawGizmos</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">this</span>.enabled)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        RectTransform rectTransform = <span class="keyword">this</span>.transform <span class="keyword">as</span> RectTransform;</span><br><span class="line">        Color wireColor = Color.yellow;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.isActiveAndEnabled)</span><br><span class="line">            wireColor.a *= <span class="number">0.7f</span></span><br><span class="line">        <span class="comment">// Padding to be applied to the masking</span></span><br><span class="line">        <span class="comment">// X = Left, Y = Bottom, Z = Right, W = Top</span></span><br><span class="line">        <span class="comment">// if you wanna make it bigger, then the all value shouble be negative</span></span><br><span class="line">        Vector4 padding = <span class="keyword">this</span>.raycastPadding * <span class="number">-1.0f</span>;</span><br><span class="line">        Matrix4x4 localToWorld = rectTransform.localToWorldMatrix</span><br><span class="line">        Vector3 topLeft = SomeUtils.GetOffsetLocalPosition(rectTransform, SomeUtils.UIOffsetType.TopLeft);</span><br><span class="line">        Vector3 topRight = SomeUtils.GetOffsetLocalPosition(rectTransform, SomeUtils.UIOffsetType.TopRight);</span><br><span class="line">        Vector3 bottomLeft = SomeUtils.GetOffsetLocalPosition(rectTransform, SomeUtils.UIOffsetType.BottomLeft);</span><br><span class="line">        Vector3 bottomRight = SomeUtils.GetOffsetLocalPosition(rectTransform, SomeUtils.UIOffsetType.BottomRight)</span><br><span class="line">        topLeft = localToWorld.MultiplyPoint(topLeft + (Vector3.left * padding.x) + (Vector3.up * padding.w));</span><br><span class="line">        topRight = localToWorld.MultiplyPoint(topRight + (Vector3.right * padding.z) + (Vector3.up * padding.w));</span><br><span class="line">        bottomLeft = localToWorld.MultiplyPoint(bottomLeft + (Vector3.left * padding.x) + (Vector3.down * padding.y));</span><br><span class="line">        bottomRight = localToWorld.MultiplyPoint(bottomRight + (Vector3.right * padding.z) + (Vector3.down * padding.y))</span><br><span class="line">        Color tempColor = Gizmos.color;</span><br><span class="line">        Gizmos.color = wireColor</span><br><span class="line">        Gizmos.DrawLine(topLeft, topRight);</span><br><span class="line">        Gizmos.DrawLine(topLeft, bottomLeft);</span><br><span class="line">        Gizmos.DrawLine(bottomRight, topRight);</span><br><span class="line">        Gizmos.DrawLine(bottomRight, bottomLeft);</span><br><span class="line">        Gizmos.color = tempColor</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç©ºç™½raycast targetçš„å¯ä»¥åœ¨Gizmoé‡Œç”»ï¼Œä½†æ˜¯Imageæœ¬èº«çš„ä¸æ˜¯é‚£ä¹ˆå¥½ç”»ï¼Œå› ä¸ºæ— æ³•ç›´æ¥è¦†å†™åŸæœ¬çš„Editorã€‚<br>ä¸€ä¸ªç¬¨åŠæ³•å°±æ˜¯åšä¸€ä¸ªè‡ªå·±çš„Iamgeç„¶åä¹Ÿåœ¨Gizmoé‡Œç”»ã€‚<br>ä½†å…¶å®è¿™ä¸ªæ˜¯Graphicçš„property ä¸çŸ¥é“æ€ä¹ˆåšé€šç”¨è§£å†³æ–¹æ¡ˆã€‚</p>
]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>Unity</tag>
        <tag>UGUI</tag>
      </tags>
  </entry>
  <entry>
    <title>Games101 ä½œä¸šwindowsç¯å¢ƒé…ç½®</title>
    <url>/2021/10/04/20211004-games101-env/</url>
    <content><![CDATA[<p>ç»ˆäºå¼€å§‹å­¦ä¹  Games101äº†ã€‚é™¤äº†å¬è¯¾ä»¥å¤–è¿˜æƒ³åšä»–çš„ä½œä¸šå¤šå·©å›ºä¸€ä¸‹ã€‚</p>
<p>ä½†æˆ‘å®åœ¨æ˜¯ä¸æƒ³ç”¨è™šæ‹Ÿæœº(èœï¼Œæƒ³è°ƒè¯•)ï¼Œæ‰€ä»¥æƒ³æ•´ä¸ªwindowsè¿™è¾¹çš„ç¯å¢ƒã€‚<br>æœ€å¼€å§‹æŒ‰ç…§ä¸€äº›æ•™ç¨‹é…Cmakeå•¥çš„ï¼Œç»“æœä½œä¸š1ç¼–è¯‘å°±ç–¯ç‹‚æŠ¥é”™å®åœ¨å—ä¸äº†ã€‚ç¾¤å‹æ¨èäº† vcpkg+vs ä¿ºé©¬ä¸Šæ¥è¯•è¯•ã€‚</p>
<h1 id="vcpkg"><a href="#vcpkg" class="headerlink" title="vcpkg"></a>vcpkg</h1><p><a href="https://github.com/microsoft/vcpkg/blob/master/README_zh_CN.md" target="_blank" rel="noopener">https://github.com/microsoft/vcpkg/blob/master/README_zh_CN.md</a></p>
<p>å®‰è£…å¹¶ä¸éš¾ï¼Œæ‰¾åˆ°äº†å®˜æ–¹çš„ç®€ä¸­æ‰‹å†Œï¼Œç…§ç€è·‘ä¸€è½®å°±è¡Œã€‚</p>
<h1 id="å®‰è£…ä½œä¸šä¾èµ–åŒ…"><a href="#å®‰è£…ä½œä¸šä¾èµ–åŒ…" class="headerlink" title="å®‰è£…ä½œä¸šä¾èµ–åŒ…"></a>å®‰è£…ä½œä¸šä¾èµ–åŒ…</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># install latest packages :D</span></span><br><span class="line">.\vcpkg.exe install opencv:x64-windows</span><br><span class="line">.\vcpkg.exe install eigen3:x64-windows</span><br><span class="line"></span><br><span class="line"><span class="comment"># install for all users</span></span><br><span class="line">vcpkg integrate install</span><br></pre></td></tr></table></figure>
<p>ç»“æœè¿™ä¸ªæ—¶å€™é‡åˆ°äº†ä¸ªå¤©å‘ï¼Œeigen3è¿™è¾¹çš„gitlab ä»“åº“è·‘è·¯äº†(ä¸æ˜¯)ã€‚</p>
<img src="/2021/10/04/20211004-games101-env/20211004-pic000.png" class="" title="split">
<p><a href="https://gitlab.com/libeigen/eigen/-/issues/2336" target="_blank" rel="noopener">https://gitlab.com/libeigen/eigen/-/issues/2336</a></p>
<p>äºæ˜¯ä¹å»æš‚å­˜çš„ä»“åº“ä¸‹è½½æºç ï¼Œç„¶åæ”¾è¿› â€œvcpkg\downloadsâ€ ä¸­ï¼Œåœ¨æ‰§è¡Œä¹‹å‰çš„å®‰è£…å‘½ä»¤å°±å¥½äº†</p>
<p><a href="https://gitlab.com/cantonios/eigen/-/tree/3.3.9" target="_blank" rel="noopener">https://gitlab.com/cantonios/eigen/-/tree/3.3.9</a></p>
<h1 id="ä½œä¸šæ¡†æ¶è®¾ç½®"><a href="#ä½œä¸šæ¡†æ¶è®¾ç½®" class="headerlink" title="ä½œä¸šæ¡†æ¶è®¾ç½®"></a>ä½œä¸šæ¡†æ¶è®¾ç½®</h1><p>æˆ‘æ˜¯è‡ªå·±NEWäº†ä¸€ä¸ªC++çš„ç©ºvså·¥ç¨‹ï¼ŒæŠŠä½œä¸šä»£ç éƒ½ä¸¢è¿›å»ã€‚</p>
<p>ç›®æ ‡å¹³å°é€‰æ‹©x64</p>
<p>å³é”® é¡¹ç›® å±æ€§ -&gt; c/c++ -&gt; è¯­è¨€ -&gt; c++ æ ‡å‡†è¿™è¾¹é€‰æ‹© c++17 (ä½œä¸šè¦æ±‚)</p>
]]></content>
      <tags>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>Unity UGUI ç®€å•å¾ªç¯æ»šåŠ¨åˆ—è¡¨</title>
    <url>/2022/03/13/20220313-recycle-grid-scrollview/</url>
    <content><![CDATA[<p>ä¹‹å‰åšäº†ä¸€ä¸ªè‡ªå¸¦ç®€å• GridLayout çš„å¾ªç¯æ»šåŠ¨åˆ—è¡¨ã€‚ä½†æ˜¯åŸºäºç»§æ‰¿çš„æ€è·¯åšçš„ã€‚å¯¼å¸ˆæŒ‡å‡ºäº†å…¶ä¸ä¾¿æŒ‡å‡ºï¼Œè€Œä¸”Unityå…¶å®æ˜¯æ¯”è¾ƒæå€¡å¤§å®¶ä½¿ç”¨ç»„åˆæ¨¡å¼çš„ï¼Œæ‰€ä»¥æˆ‘å†³å®šä¿®æ”¹ä¸€ä¸‹ã€‚</p>
<h1 id="å¾ªç¯æ»šåŠ¨"><a href="#å¾ªç¯æ»šåŠ¨" class="headerlink" title="å¾ªç¯æ»šåŠ¨"></a>å¾ªç¯æ»šåŠ¨</h1><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>å’Œåœ¨ç½‘ä¸Šèƒ½æœç´¢åˆ°çš„å¤§å¤šæ•°å¾ªç¯æ»šåŠ¨åˆ—è¡¨ä¸€æ ·ï¼Œæˆ‘æœ‰ä¸€ä¸ªç©ºçš„ Contentï¼Œè°ƒæ•´å…¶å°ºå¯¸æ¥æ¨¡æ‹Ÿåˆ—è¡¨çš„æ»šåŠ¨ï¼Œå†æ ¹æ®æ»šåŠ¨çš„å½“å‰ä½ç½®åœ¨è§†å£é‡ŒæŠŠUIç»„ä»¶éƒ½æ‘†æ”¾å¥½ã€‚</p>
<p>æˆ‘éœ€è¦ä½¿ç”¨Unityè‡ªå¸¦çš„æ»šåŠ¨è§†å¤–ï¼Œå¹¶ä¸”æˆ‘è¿˜å®šä¹‰äº†ç®€å•çš„ ListElement, ListView, ScrollrectController è¿™ä¸‰ä¸ªç±»ã€‚</p>
<p>ListElement å°±æ˜¯å®é™…éœ€è¦è¢«æ“ä½œçš„åˆ—è¡¨ç»„ä»¶ï¼Œè¿™ä¸ªç»„ä»¶è´Ÿè´£æä¾› RectTransform å’Œä¸€ä¸ª indexï¼Œ ä¿è¯å…¶èƒ½è¢«æˆ‘çš„ ScrollrectController æ“ä½œã€‚</p>
<p>ListView è´Ÿè´£ç®¡ç† ListElementï¼Œç”Ÿæˆé”€é­‚éƒ½å¯ä»¥ã€‚åŒæ—¶è¿˜æä¾›ç›´æ¥æ‹¿å–æ‰€æœ‰ ListElement çš„æ¥å£ã€‚</p>
<p>ScrollrectController æŒæœ‰ ListViewï¼Œå¹¶ä¸”æ ¹æ®ç”¨æˆ·ä¼ å…¥çš„ä¸€ä¸ªæ•°æ®ä¸ªæ•°æ¥è¿›è¡Œå¾ªç¯æ»šåŠ¨çš„ç®¡ç†ã€‚åŒæ—¶æœ‰äº‹ä»¶å‘ŠçŸ¥æ¯æ¬¡çš„å¸ƒå±€åˆ·æ–°çš„å®Œæˆã€‚</p>
<p>ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘è¿˜åšäº†ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„ GridLayout ç»™ ScrollrectController æ§åˆ¶ã€‚</p>
<p>è‡³äºè§†å›¾å†…çš„æœ€å¤§å¯è§†æ¡ç›®æ•°ï¼Œè€å®è¯´æˆ‘æ„Ÿè§‰æˆ‘æ²¡æœ‰ç‰¹åˆ«å¥½çš„æ–¹æ³•å»è®¡ç®—ä¸€ä¸ªå‡†ç¡®çš„å€¼ã€‚æ‰€ä»¥å°±æŒ‰ç€ (row + 2) <em> (column </em> 2) æ¥è®¡ç®—äº†ï¼Œè™½ç„¶æœ‰ä¸€ç‚¹æµªè´¹å†…å­˜ï¼Œä½†åœ¨æˆ‘å½“å‰è®¾ç½®çš„æ»šåŠ¨é€Ÿåº¦ä¸‹æ˜¯å¤Ÿç”¨çš„ã€‚</p>
<h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TempListElementUI</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">Header(<span class="meta-string">"must have"</span>), Tooltip(<span class="meta-string">"should inherit from ISetupable"</span>)</span>]</span><br><span class="line">    [<span class="meta">SerializeField</span>]</span><br><span class="line">    Component m_dataReceiver;</span><br><span class="line">    [<span class="meta">SerializeField, Tooltip(<span class="meta-string">"better to manual drag it in"</span>)</span>]</span><br><span class="line">    RectTransform m_elementTransform;</span><br><span class="line">    [<span class="meta">SerializeField, ReadOnly</span>]</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> m_index = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> ElementIndex =&gt; m_index;</span><br><span class="line">    <span class="keyword">public</span> RectTransform ElementRectTransform</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (m_elementTransform == <span class="literal">null</span>)</span><br><span class="line">                m_elementTransform = GetComponent&lt;RectTransform&gt;();</span><br><span class="line">            <span class="keyword">return</span> m_elementTransform;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> Setup&lt;TData&gt;(TData data)</span><br><span class="line">    &#123;</span><br><span class="line">        SomeUtils.ISetup&lt;Component, TData&gt;(m_dataReceiver, data);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Show</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">this</span>.gameObject.activeSelf)</span><br><span class="line">            <span class="keyword">this</span>.gameObject.SetActive(<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Hide</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.gameObject.activeSelf)</span><br><span class="line">            <span class="keyword">this</span>.gameObject.SetActive(<span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SetIndex</span>(<span class="params"><span class="keyword">int</span> index</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        m_index = index;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Awake</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (m_elementTransform == <span class="literal">null</span>)</span><br><span class="line">            m_elementTransform = <span class="keyword">this</span>.transform <span class="keyword">as</span> RectTransform;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> UNITY_EDITOR</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Reset</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        m_elementTransform = <span class="keyword">this</span>.transform <span class="keyword">as</span> RectTransform;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TempListView</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> UNITY_EDITOR</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="comment">// check when prefab change</span></span><br><span class="line">    <span class="comment">// [OnValueChanged("OnPrefabChanged")]</span></span><br><span class="line">    [<span class="meta">SerializeField, Header(<span class="meta-string">"place holder, the listview should only contains one type of element"</span>)</span>]</span><br><span class="line">    TempListElementUI m_elementPrefab;</span><br><span class="line">    RectTransform Container =&gt; transform <span class="keyword">as</span> RectTransform;</span><br><span class="line">    [<span class="meta">SerializeField, ReadOnly</span>]</span><br><span class="line">    List&lt;TempListElementUI&gt; m_actualUsedComponents = <span class="keyword">new</span> List&lt;TempListElementUI&gt;(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> Count =&gt; m_actualUsedComponents.Count;</span><br><span class="line">    <span class="keyword">public</span> TempListElementUI <span class="keyword">this</span>[<span class="keyword">int</span> index] =&gt; m_actualUsedComponents[index];</span><br><span class="line">    <span class="keyword">public</span> IReadOnlyList&lt;TempListElementUI&gt; ElementList =&gt; m_actualUsedComponents;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> TempListElementUI <span class="title">Add</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        TempListElementUI element = InternalAdd();</span><br><span class="line">        m_actualUsedComponents.Add(element);</span><br><span class="line">        element.Show();</span><br><span class="line">        <span class="keyword">return</span> element;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Clear</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        TempListElementUI element = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">while</span> (m_actualUsedComponents.Count &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            element = m_actualUsedComponents[m_actualUsedComponents.Count - <span class="number">1</span>];</span><br><span class="line">            m_actualUsedComponents.RemoveAt(m_actualUsedComponents.Count - <span class="number">1</span>);</span><br><span class="line">            InternalRemove(element);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Remove</span>(<span class="params">TempListElementUI instance</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (m_actualUsedComponents.Remove(instance))</span><br><span class="line">        &#123;</span><br><span class="line">            instance.Hide();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            Debug.LogError(<span class="string">$"listview_<span class="subst">&#123;<span class="keyword">this</span>.gameObject.name&#125;</span> does not contains <span class="subst">&#123;instance.ElementRectTransform.name&#125;</span>, remove failed"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">RemoveAt</span>(<span class="params"><span class="keyword">int</span> index</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (index &lt; <span class="number">0</span> || index &gt;= m_actualUsedComponents.Count)</span><br><span class="line">        &#123;</span><br><span class="line">            Debug.LogError(<span class="string">$"<span class="subst">&#123;index&#125;</span> is invalid for SimpleListView"</span>, <span class="keyword">this</span>.gameObject);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        TempListElementUI toRemove = m_actualUsedComponents[index];</span><br><span class="line">        m_actualUsedComponents.RemoveAt(index);</span><br><span class="line">        InternalRemove(toRemove);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">InnerSwap</span>(<span class="params"><span class="keyword">int</span> indexA, <span class="keyword">int</span> indexB</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (indexA &lt; <span class="number">0</span> || indexA &gt; m_actualUsedComponents.Count - <span class="number">1</span> || indexB &lt; <span class="number">0</span> || indexB &gt; m_actualUsedComponents.Count - <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        TempListElementUI temp = m_actualUsedComponents[indexA];</span><br><span class="line">        <span class="keyword">int</span> transformIndexA = temp.ElementRectTransform.GetSiblingIndex();</span><br><span class="line">        <span class="keyword">int</span> transformIndexB = m_actualUsedComponents[indexB].ElementRectTransform.GetSiblingIndex();</span><br><span class="line">        m_actualUsedComponents[indexA] = m_actualUsedComponents[indexB];</span><br><span class="line">        m_actualUsedComponents[indexB] = temp;</span><br><span class="line">        m_actualUsedComponents[indexA].ElementRectTransform.SetSiblingIndex(transformIndexA);</span><br><span class="line">        m_actualUsedComponents[indexB].ElementRectTransform.SetSiblingIndex(transformIndexB);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> </span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>-1 means element is not in the list<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">IndexOf</span>(<span class="params">TempListElementUI instance</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> m_actualUsedComponents.IndexOf(instance);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (ArgumentOutOfRangeException)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">virtual</span> TempListElementUI <span class="title">InternalAdd</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">// can apply object pool here</span></span><br><span class="line">        <span class="keyword">if</span> (Application.isEditor &amp;&amp; !Application.isPlaying)</span><br><span class="line">            <span class="keyword">return</span> UnityEditor.PrefabUtility.InstantiatePrefab(m_elementPrefab, Container) <span class="keyword">as</span> TempListElementUI;</span><br><span class="line">        <span class="keyword">return</span> Instantiate(m_elementPrefab, Container);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">InternalRemove</span>(<span class="params">TempListElementUI element</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">// can apply object pool here</span></span><br><span class="line">        <span class="keyword">if</span> (element == <span class="literal">null</span>) <span class="keyword">return</span>;</span><br><span class="line">        element.Hide();</span><br><span class="line">        <span class="keyword">if</span> (Application.isEditor &amp;&amp; !Application.isPlaying)</span><br><span class="line">            GameObject.DestroyImmediate(element.ElementRectTransform.gameObject);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            GameObject.Destroy(element.ElementRectTransform.gameObject);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> UNITY_EDITOR</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnTransformChildrenChanged</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (Application.isEditor &amp;&amp; !Application.isPlaying)</span><br><span class="line">            FindPrefabInstances();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnPrefabChanged</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">// remove pre objects</span></span><br><span class="line">        <span class="keyword">int</span> amount = m_actualUsedComponents.Count;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m_actualUsedComponents.Count; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            GameObject.DestroyImmediate(m_actualUsedComponents[i].ElementRectTransform.gameObject);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (m_elementPrefab != <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; amount; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                RectTransform rectTransform = (RectTransform)UnityEditor.PrefabUtility.InstantiatePrefab(m_elementPrefab, Container);</span><br><span class="line">                m_actualUsedComponents[i] = (rectTransform.GetComponent&lt;TempListElementUI&gt;());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            m_actualUsedComponents.Clear();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> Retrieves prefab instances in the transform</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    [<span class="meta">ContextMenu(<span class="meta-string">"find prefab instances"</span>)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">FindPrefabInstances</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">bool</span> hasPrefab = !(m_elementPrefab == <span class="literal">null</span>);</span><br><span class="line">        TempListElementUI elementPrefab = m_elementPrefab.GetComponent&lt;TempListElementUI&gt;();</span><br><span class="line">        m_actualUsedComponents.Clear();</span><br><span class="line">        List&lt;GameObject&gt; toDeleteObjectList = <span class="keyword">new</span> List&lt;GameObject&gt;();</span><br><span class="line">        <span class="keyword">foreach</span> (Transform child <span class="keyword">in</span> Container)</span><br><span class="line">        &#123;</span><br><span class="line">            TempListElementUI childElement = child.GetComponent&lt;TempListElementUI&gt;();</span><br><span class="line">            <span class="keyword">if</span> (childElement == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                toDeleteObjectList.Add(child.gameObject);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (hasPrefab)</span><br><span class="line">            &#123;</span><br><span class="line">                GameObject detectPrefabGo = UnityEditor.PrefabUtility.GetCorrespondingObjectFromSource(child.gameObject);</span><br><span class="line">                TempListElementUI detectPrefab = (detectPrefabGo == <span class="literal">null</span>) ? <span class="literal">null</span> : detectPrefabGo.GetComponent&lt;TempListElementUI&gt;();</span><br><span class="line">                <span class="keyword">if</span> (elementPrefab == detectPrefab)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">// same source prefab</span></span><br><span class="line">                    m_actualUsedComponents.Add(childElement);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">// different source prefab, delete this one</span></span><br><span class="line">                    toDeleteObjectList.Add(child.gameObject);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (UnityEditor.PrefabUtility.IsAnyPrefabInstanceRoot(child.gameObject))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// find the first prefab</span></span><br><span class="line">                GameObject prefab = UnityEditor.PrefabUtility.GetCorrespondingObjectFromSource(child.gameObject);</span><br><span class="line">                m_elementPrefab = prefab.GetComponent&lt;TempListElementUI&gt;();</span><br><span class="line">                m_actualUsedComponents.Add(childElement);</span><br><span class="line">                hasPrefab = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; toDeleteObjectList.Count; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (Application.isPlaying)</span><br><span class="line">                GameObject.Destroy(toDeleteObjectList[i]);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                GameObject.DestroyImmediate(toDeleteObjectList[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">ContextMenu(<span class="meta-string">"editor time add"</span>)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">EditorTimeAdd</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (Application.isPlaying) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">if</span> (m_elementPrefab == <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Debug.LogError(<span class="string">"listview is missing element prefab"</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        TempListElementUI spawnObject = (TempListElementUI)UnityEditor.PrefabUtility.InstantiatePrefab(m_elementPrefab, Container);</span><br><span class="line">        m_actualUsedComponents.Add(spawnObject);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">ContextMenu(<span class="meta-string">"editor time clear"</span>)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">EditorTimeClear</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (Application.isPlaying) <span class="keyword">return</span>;</span><br><span class="line">        <span class="comment">// remove pre objects</span></span><br><span class="line">        TempListElementUI[] preObjects = Container.GetComponentsInChildren&lt;TempListElementUI&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; preObjects.Length; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            GameObject.DestroyImmediate(preObjects[i].ElementRectTransform.gameObject);</span><br><span class="line">        &#125;</span><br><span class="line">        m_actualUsedComponents.Clear();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">ContextMenu(<span class="meta-string">"test print elements"</span>)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">TestPrintListElements</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (m_actualUsedComponents != <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            StringBuilder printText = <span class="keyword">new</span> StringBuilder(<span class="string">$"temp list view children_<span class="subst">&#123;m_actualUsedComponents.Count&#125;</span> :\n"</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m_actualUsedComponents.Count; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                printText.AppendLine(m_actualUsedComponents[i].ElementRectTransform.name);</span><br><span class="line">            &#125;</span><br><span class="line">            Debug.Log(printText);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">BoundlessScrollRectController</span> : <span class="title">UIBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    too much code, I will just show the draw</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">DrawContentItem</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        IReadOnlyList&lt;TempListElementUI&gt; elementList = ElementList;</span><br><span class="line">        <span class="keyword">int</span> dataCount = m_simulatedDataCount;</span><br><span class="line">        <span class="comment">// TODO @Hiko use a general calculation later</span></span><br><span class="line">        <span class="keyword">bool</span> test = m_content.anchorMin != Vector2.up || m_content.anchorMax != Vector2.up || m_content.pivot != Vector2.up;</span><br><span class="line">        <span class="keyword">if</span> (test)</span><br><span class="line">        &#123;</span><br><span class="line">            m_content.anchorMin = Vector2.up;</span><br><span class="line">            m_content.anchorMax = Vector2.up;</span><br><span class="line">            m_content.pivot = Vector2.up;</span><br><span class="line">        &#125;</span><br><span class="line">        Vector3 dragContentAnchorPostion = m_content.anchoredPosition;</span><br><span class="line">        Vector3 contentMove = dragContentAnchorPostion - SomeUtils.GetOffsetLocalPosition(m_content, SomeUtils.UIOffsetType.TopLeft);</span><br><span class="line">        Vector2 itemSize = m_gridLayoutGroup.CellSize, spacing = m_gridLayoutGroup.Spacing;</span><br><span class="line"></span><br><span class="line">        RectOffset padding = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> != m_gridLayoutGroup)</span><br><span class="line">            padding = m_gridLayoutGroup.RectPadding;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// need to know the moving direction, then adjust it to prevent wrong draw</span></span><br><span class="line">        <span class="keyword">float</span> xMove = contentMove.x &lt; <span class="number">0</span> ? (-contentMove.x - padding.horizontal) : <span class="number">0</span>;</span><br><span class="line">        xMove = Mathf.Clamp(xMove, <span class="number">0.0f</span>, Mathf.Abs(xMove));</span><br><span class="line">        <span class="keyword">float</span> yMove = contentMove.y &gt; <span class="number">0</span> ? (contentMove.y - padding.vertical) : <span class="number">0</span>;</span><br><span class="line">        yMove = Mathf.Clamp(yMove, <span class="number">0.0f</span>, Mathf.Abs(yMove));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// the column index of the top left item</span></span><br><span class="line">        <span class="keyword">int</span> tempColumnIndex = Mathf.FloorToInt((xMove + spacing.x) / (itemSize.x + spacing.x));</span><br><span class="line">        <span class="keyword">if</span> (xMove % (itemSize.x + spacing.x) - itemSize.x &gt; spacing.x)</span><br><span class="line">            tempColumnIndex = Mathf.Clamp(tempColumnIndex - <span class="number">1</span>, <span class="number">0</span>, tempColumnIndex);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// the row index of the top left item</span></span><br><span class="line">        <span class="keyword">int</span> tempRowIndex = Mathf.FloorToInt((yMove + spacing.y) / (itemSize.y + spacing.y));</span><br><span class="line">        <span class="keyword">if</span> (yMove % (itemSize.y + spacing.y) - itemSize.y &gt; spacing.y)</span><br><span class="line">            tempRowIndex = Mathf.Clamp(tempRowIndex - <span class="number">1</span>, <span class="number">0</span>, tempRowIndex);</span><br><span class="line"></span><br><span class="line">        Vector2Int rowTopLeftItemIndex = <span class="keyword">new</span> Vector2Int(tempRowIndex, tempColumnIndex);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> rowDataCount = <span class="number">0</span>, columnDataCount = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (BoundlessGridLayoutData.Constraint.FixedColumnCount == m_gridLayoutGroup.constraint)</span><br><span class="line">        &#123;</span><br><span class="line">            rowDataCount = m_gridLayoutGroup.constraintCount;</span><br><span class="line">            columnDataCount = Mathf.CeilToInt((<span class="keyword">float</span>)dataCount / rowDataCount);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            columnDataCount = m_gridLayoutGroup.constraintCount;</span><br><span class="line">            rowDataCount = Mathf.CeilToInt((<span class="keyword">float</span>)dataCount / columnDataCount);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// x -&gt; element amount on horizontal axis</span></span><br><span class="line">        <span class="comment">// y -&gt; element amount on vertical axis</span></span><br><span class="line">        Vector2Int contentRowColumnSize = <span class="keyword">new</span> Vector2Int(rowDataCount, columnDataCount);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// deal with content from left to right (simple case)</span></span><br><span class="line">        <span class="keyword">int</span> dataIndex = <span class="number">0</span>, uiItemIndex = <span class="number">0</span>;</span><br><span class="line">        Vector3 rowTopLeftPosition = <span class="keyword">new</span> Vector3(padding.left, -padding.top, <span class="number">0.0f</span>), itemTopLeftPosition = Vector3.zero;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> columnIndex = <span class="number">0</span>; columnIndex &lt; m_viewItemCountInColumn; columnIndex++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (columnIndex + rowTopLeftItemIndex.x == columnDataCount)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            rowTopLeftPosition = <span class="keyword">new</span> Vector3(padding.left, -padding.top, <span class="number">0.0f</span>) + Vector3.down * (columnIndex + rowTopLeftItemIndex.x) * (itemSize.y + spacing.y);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> rowIndex = <span class="number">0</span>; rowIndex &lt; m_viewItemCountInRow; rowIndex++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (rowIndex + rowTopLeftItemIndex.y == rowDataCount)</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">                Vector2Int elementIndex = <span class="keyword">new</span> Vector2Int(rowIndex + rowTopLeftItemIndex.y, columnIndex + rowTopLeftItemIndex.x);</span><br><span class="line">                dataIndex = CaculateDataIndex(elementIndex, contentRowColumnSize, GridLayoutData.startAxis, GridLayoutData.startCorner);</span><br><span class="line">                itemTopLeftPosition = rowTopLeftPosition + Vector3.right * (rowIndex + rowTopLeftItemIndex.y) * (itemSize.x + spacing.x);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// TODO @Hiko avoid overdraw</span></span><br><span class="line">                <span class="keyword">if</span> (uiItemIndex &gt; <span class="number">0</span> &amp;&amp; elementList[uiItemIndex - <span class="number">1</span>].ElementIndex == dataIndex)</span><br><span class="line">                    <span class="keyword">continue</span>; <span class="comment">// over draw case</span></span><br><span class="line">                <span class="keyword">if</span> (dataIndex &gt; <span class="number">-1</span> &amp;&amp; dataIndex &lt; dataCount)</span><br><span class="line">                &#123;</span><br><span class="line">                    elementList[uiItemIndex].ElementRectTransform.localPosition = itemTopLeftPosition;</span><br><span class="line">                    elementList[uiItemIndex].SetIndex(dataIndex);</span><br><span class="line">                    elementList[uiItemIndex].Show();</span><br><span class="line">                    uiItemIndex++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (uiItemIndex &lt; elementList.Count)</span><br><span class="line">        &#123;</span><br><span class="line">            elementList[uiItemIndex].SetIndex(<span class="number">-1</span>);</span><br><span class="line">            elementList[uiItemIndex].Hide();</span><br><span class="line">            elementList[uiItemIndex].ElementRectTransform.position = Vector3.zero;</span><br><span class="line">            uiItemIndex++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        NotifyOnContentItemFinishDrawing();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å†™å¯ä»¥ä¿è¯æˆ‘çš„è¿™ä¸ªå¾ªç¯æ»šåŠ¨çš„é€»è¾‘ä¸å®é™…çš„UIéœ€è¦æ˜¾ç¤ºçš„é€»è¾‘å°½å¯èƒ½åœ°åˆ†å¼€ã€‚éœ€è¦ä½¿ç”¨å¾ªç¯æ»šåŠ¨åŠŸèƒ½çš„æ—¶å€™ï¼Œå†æ·»åŠ è¿™äº›ç»„ä»¶å³å¯ã€‚</p>
<img src="/2022/03/13/20220313-recycle-grid-scrollview/20210131-scrollrect01.gif" class="" title="split">
<h1 id="é…åˆå®é™…æ˜¾ç¤ºç»„ä»¶ä½¿ç”¨"><a href="#é…åˆå®é™…æ˜¾ç¤ºç»„ä»¶ä½¿ç”¨" class="headerlink" title="é…åˆå®é™…æ˜¾ç¤ºç»„ä»¶ä½¿ç”¨"></a>é…åˆå®é™…æ˜¾ç¤ºç»„ä»¶ä½¿ç”¨</h1><p>åœ¨æ»šåŠ¨è§†å›¾æ‘†æ”¾å¥½ä½ç½®åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ ListElement æä¾›çš„ç´¢å¼•çŸ¥é“å…¶å¯¹åº”æ•°æ®é›†é‡Œæ•°æ®ç´¢å¼•ã€‚æ‰€ä»¥éœ€è¦ä½¿ç”¨è¿™ä¸ªæ»šåŠ¨è§†å›¾çš„UIï¼Œè¦åŒæ—¶ç®¡ç† ListView å’Œ ScrollrectControllerã€‚</p>
<p>æˆ‘æ•´äº†ä¸€ä¸ªæ¥å£å’Œä¸€ä¸ªæ‰©å±•æ–¹æ³•ï¼Œç”¨äºæ˜¾ç¤ºæ•°æ®çš„UIç»„ä»¶éœ€è¦ç»§æ‰¿è¿™ä¸ªæ¥å£ã€‚å› ä¸ºæŒ‰ç…§æˆ‘çš„å†™æ³•ï¼Œä» ListView ä¸­åªèƒ½æ‹¿åˆ° ListElement æ²¡æ³•æ‹¿åˆ°å®é™…ç”¨äºè¡¨ç°çš„ UI ç»„ä»¶ã€‚ä½†æ˜¯é€šè¿‡è¿™ä¸ªæ¥å£å’Œ ListElement ä¸­çš„ä¸€ä¸ªæ³›å‹æ–¹æ³•å°±å¯ä»¥æŠŠå†…å®¹ä¼ è¿›å»ã€‚è™½ç„¶éœ€è¦åšä¸€æ¬¡ç±»å‹æ£€æŸ¥ï¼Œä½†ä¹Ÿåº”è¯¥è¿˜å¥½ã€‚æ¯•ç«Ÿä¸éœ€è¦GetComponentä¹Ÿä¸éœ€è¦å•ç‹¬ç»´æŠ¤ä¸€ä¸ªå…³äºå®é™…æ˜¾ç¤ºç»„ä»¶çš„æ•°ç»„ï¼Œç”¨èµ·æ¥è¿˜æ˜¯æŒºæ–¹ä¾¿çš„å‘€ã€‚</p>
<p>é™¤æ­¤ä¹‹å¤–æ¯”è¾ƒå‘çš„å°±æ˜¯è¿™æ ·å†™å¯¼è‡´ Unity çš„ Component éƒ½èƒ½è°ƒç”¨è¿™ä¸ªSetupçš„æ–¹æ³•ï¼Œè¿˜æŒºå±é™©çš„ï¼Œæ‰€ä»¥åŠ äº†ä¸ªæ³¨é‡Šã€‚å®é™…ä½¿ç”¨çš„æ—¶å€™ä¸€å®šè®°å¾—è®©ç”¨äºè¡¨ç°çš„ UI ç»„ä»¶ç»§æ‰¿è¿™ä¸ªæ¥å£ã€‚</p>
<h2 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// apply this on the target shows actual data</span></span><br><span class="line">public interface ISetupable&lt;TData&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Setup</span>(<span class="params">TData data</span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> target component should inherit from ISetupable</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="component"&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="data"&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;typeparam name="TData"&gt;</span><span class="doctag">&lt;/typeparam&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> ISetup&lt;TComponent, TData&gt;(<span class="keyword">this</span> Component component, TData data) <span class="keyword">where</span> TComponent : Component</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// I guess this check should be fine  :(</span></span><br><span class="line">    <span class="keyword">if</span> (component <span class="keyword">is</span> ISetupable&lt;TData&gt; target)</span><br><span class="line">    &#123;</span><br><span class="line">        target.Setup(data);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    UnityEngine.Debug.LogError(<span class="string">$"component_<span class="subst">&#123;component.name&#125;</span> is not a setupable"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>å…¶å®è¿™ä¸ªåŠŸèƒ½ä¸¢å°½é¡¹ç›®é‡Œåç”¨çš„åœ°æ–¹ä¸æ˜¯ç‰¹åˆ«å¤šï¼Œæ‰€ä»¥éƒ½æ˜¯éš”å‡ ä¸ªæœˆä¿®ä¸€ä¸‹ï¼Œæ¯æ¬¡éƒ½è¦çœ‹è‡ªå·±å†™çš„åƒåœ¾ä»£ç å¥½ä¹…ï¼Œå±å®å¤´ç—›äº†ã€‚<br>æ€»ç®—æ˜¯ç”¨èµ·æ¥æ¯”ä»¥å‰æ–¹ä¾¿ä¸å°‘äº†ã€‚æ¥ä¸‹æ¥å°±æŠŠä¸€äº›å°é—®é¢˜ä¿®ä¸€ä¿®å¥½äº†ã€‚</p>
<p>å›å¤´å†çœ‹å·²ç»å’Œè‡ªå·±åšçš„é‚£ä¸ªåˆç‰ˆå®Œå…¨ä¸ä¸€æ ·äº†ï¼Œä¸ªäººè®¤ä¸ºæ€è·¯æ¯”ä»¥å‰é‚£ä¸ªå¥½å¤šäº†ã€‚</p>
<p>å…¨éƒ¨ä»£ç ï¼š<br><a href="https://github.com/2C2C2C/MuyScrollRect" target="_blank" rel="noopener">https://github.com/2C2C2C/MuyScrollRect</a></p>
]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>Unity</tag>
        <tag>UGUI</tag>
      </tags>
  </entry>
  <entry>
    <title>Unity InputSystem ç®€å•ä¿å­˜æŒ‰é”®rebind</title>
    <url>/2022/04/05/20220404-input-sys-save-rebind-01/</url>
    <content><![CDATA[<p>Unity çš„ InputSystem æ­£å¼å‘å¸ƒä¹Ÿå¥½ä¸€æ®µæ—¶é—´äº†ã€‚æœ¬æ¥è¿™è¾¹ä¹Ÿæƒ³è‡ªå·±åšä¸€å¥—è¾“å…¥å¤„ç†ä½†æ˜¯çœ‹ Unity è¿™ä¸ªå®˜æ–¹çš„è¿˜æŒºæ–¹ä¾¿å°±æ‰“ç®—ç›´æ¥ç”¨ã€‚</p>
<h1 id="InputAction"><a href="#InputAction" class="headerlink" title="InputAction"></a>InputAction</h1><p>è¯´ä¸‹æˆ‘å¯¹è¿™ä¸ª InputAction çš„ç®€å•ç†è§£ã€‚</p>
<p>InputAction</p>
<pre><code>- Composite
    - Binding
- Binding
</code></pre><ul>
<li>Interaction</li>
<li>Processor</li>
</ul>
<p>InputAction æ˜¯å®šä¹‰çš„æœ€ä¸Šå±‚çš„äº¤äº’äº‹ä»¶ï¼Œæˆ‘è®¤ä¸ºä»–æ˜¯ç›´æ¥å’Œ gameplay å±‚é¢äº¤äº’çš„ï¼Œæä¾›å“åº”äº‹ä»¶å’Œè¾“å…¥è®¾å¤‡çš„æ•°æ®(æ¯”å¦‚é¼ æ ‡çš„ä½ç½®ï¼Œæˆ–æ˜¯çº¿æ€§æŒ‰é’®çš„æ•°å€¼)</p>
<p>Binding æ˜¯å…·ä½“åˆ°è¾“å…¥è®¾å¤‡ä¸ŠæŒ‰é”®ï¼Œçº¿æ€§è¾“å…¥çš„ä¸€ä¸ªæ•°æ®ç»“æ„</p>
<p>Composite æ˜¯æŠŠ Binding æä¾›çš„ç›´æ¥è¾“å…¥æ•°æ®å¤„ç†æˆæˆ‘ä»¬æƒ³è¦çš„æ•°æ®å¹¶æä¾›ç»™ InputActionã€‚</p>
<p>å¦å¤–ä¸¤ä¸ªå¯ä»¥åº”ç”¨äºInputActionï¼ŒComposite å’Œ Binding çš„ç»„ä»¶</p>
<p>Interaction æ˜¯ç”¨æ¥è§„å®šå½“å‰çš„ è¾“å…¥/è¡Œä¸º è§¦å‘çš„æœºåˆ¶ã€‚</p>
<p>Processor æ˜¯ç”¨æ¥å¯¹å½“å‰çš„è¾“å…¥æ•°æ®åšè¿½åŠ å¤„ç†çš„ã€‚</p>
<h1 id="rebind"><a href="#rebind" class="headerlink" title="rebind"></a>rebind</h1><p>æˆ‘åœ¨å®˜æ–¹çš„tank exampleä¸­åšçš„ rebind save</p>
<p>å¯¹äºç®€å•çš„ Button Action é‡Œçš„ Binding, rebind çš„æ—¶å€™æˆ‘ä»¬æ˜¯è¿½åŠ äº† OverridePath ç»™è¿™ä¸ª Button Action ä¸‹é¢çš„ Bindingã€‚</p>
<p>Path æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸², å¤§æ¦‚æ˜¯è¿™æ ·çš„ â€œ<Gamepad>/buttonSouthâ€ã€‚ é‡Œé¢åŒ…å«äº†è¾“å…¥è®¾å¤‡ç±»å‹å’Œå…·ä½“çš„æŒ‰é’®åã€‚(å…¶å®æˆ‘è§‰å¾—ï¼Œ <Gamepad> è¿™æ ·çš„æ–‡æœ¬å¯ä»¥æä¾›æˆä¸€ä¸ªConst string ï¼Œä¼šå¥½ç”¨å¾ˆå¤š)</p>
<p>å¯¹äºç®€å•çš„ rebind å­˜å‚¨ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°æ‰€æœ‰çš„ Binding é‡Œçš„ override path ä¿å­˜ä¸‹æ¥ï¼Œä¸‹æ¬¡å¯åŠ¨æ¸¸æˆåŠ è½½äº†åŸæœ¬çš„ Action Map ä¹‹åå†æŠŠ Override Path ç»™èµ‹å€¼ä¸Šå»ã€‚</p>
<h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h1><figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">InputBindSaveHelper</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">readonly</span> <span class="keyword">string</span> s_keyMappingPreferKey = <span class="string">"KeyMapping"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">SaveActionMapRebinding</span>(<span class="params">InputActionMap actionMap</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        Dictionary&lt;Guid, <span class="keyword">string</span>&gt; overridedActionPathDict = <span class="keyword">new</span> Dictionary&lt;Guid, <span class="keyword">string</span>&gt;();</span><br><span class="line">        UnityEngine.InputSystem.Utilities.ReadOnlyArray&lt;InputAction&gt; actions = actionMap.actions;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; actions.Count; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            InputAction action = actions[i];</span><br><span class="line">            UnityEngine.InputSystem.Utilities.ReadOnlyArray&lt;InputBinding&gt; actionBindings = action.bindings;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; actionBindings.Count; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                InputBinding actionBinding = actionBindings[j];</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">string</span>.IsNullOrEmpty(actionBinding.overridePath))</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                overridedActionPathDict.Add(actionBinding.id, actionBinding.overridePath);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        BinaryFormatter binFormatter = <span class="keyword">new</span> BinaryFormatter();</span><br><span class="line">        MemoryStream mStream = <span class="keyword">new</span> MemoryStream();</span><br><span class="line">        binFormatter.Serialize(mStream, overridedActionPathDict);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">byte</span>[] byteArr = mStream.ToArray();</span><br><span class="line">        <span class="comment">// idk why [Encoding.UTF8.GetString()] just doesnt work</span></span><br><span class="line">        <span class="keyword">string</span> encodingString = Convert.ToBase64String(byteArr, Base64FormattingOptions.InsertLineBreaks);</span><br><span class="line">        PlayerPrefs.SetString(s_keyMappingPreferKey, encodingString);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">LoadActionMapRebinding</span>(<span class="params">InputActionMap actionMap</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">string</span> encodingString = PlayerPrefs.GetString(s_keyMappingPreferKey);</span><br><span class="line">        <span class="keyword">byte</span>[] byteArr = Convert.FromBase64String(encodingString);</span><br><span class="line"></span><br><span class="line">        BinaryFormatter binFormatter = <span class="keyword">new</span> BinaryFormatter();</span><br><span class="line">        MemoryStream mStream = <span class="keyword">new</span> MemoryStream(byteArr);</span><br><span class="line">        Dictionary&lt;Guid, <span class="keyword">string</span>&gt; rebindSavePairDict = binFormatter.Deserialize(mStream) <span class="keyword">as</span> Dictionary&lt;Guid, <span class="keyword">string</span>&gt;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (rebindSavePairDict != <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            UnityEngine.InputSystem.Utilities.ReadOnlyArray&lt;InputAction&gt; actions = actionMap.actions;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; actions.Count; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                InputAction action = actions[i];</span><br><span class="line">                UnityEngine.InputSystem.Utilities.ReadOnlyArray&lt;InputBinding&gt; actionBindings = action.bindings;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; actionBindings.Count; j++)</span><br><span class="line">                &#123;</span><br><span class="line">                    InputBinding actionBinding = actionBindings[j];</span><br><span class="line">                    <span class="comment">// override</span></span><br><span class="line">                    <span class="keyword">if</span> (rebindSavePairDict.ContainsKey(actionBinding.id))</span><br><span class="line">                    &#123;</span><br><span class="line">                        actionBinding.overridePath = rebindSavePairDict[actionBinding.id];</span><br><span class="line">                        action.ApplyBindingOverride(actionBinding);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å½“å‰å› ä¸ºé¡¹ç›®é‡Œçš„å­˜æ¡£ç›¸å…³çš„åŠŸèƒ½è¿˜æ²¡åšå®Œï¼Œç»“æ„è¿˜æ²¡å®šä¸‹æ¥ï¼Œæ‰€ä»¥æˆ‘åªèƒ½æŠŠ rebind å­˜åœ¨PlayerPrefsé‡Œã€‚</p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æˆ‘ä¹Ÿåªæ˜¯å¤§æ¦‚çœ‹äº†ä¸€ä¸‹ Unity çš„è¿™ä¸ª InputSystemï¼Œæ²¡æœ‰å¾ˆæ·±çš„å»ä½¿ç”¨ã€‚ä½†æ˜¯åˆæ­¥ä¸Šæ‰‹çš„æ—¶å€™å°±æ„Ÿè§‰ä»–çš„å°è£…å’Œæ‰©å±•æ€§å¯¹äºé‚£äº›æ“ä½œè¦æ±‚ä¸é«˜çš„æ¸¸æˆæ˜¯å·²ç»å¤Ÿç”¨çš„äº†ã€‚<br>æ¯”è¾ƒéº»çƒ¦çš„ä¸€ä¸ªç‚¹å°±æ˜¯ä»–çš„ Interaction, Processor å’Œ Binding çš„è¦†ç›–å…¨éƒ½éœ€è¦ç”¨ stringã€‚ç›´æ¥å†™çš„ string ä¼šéå¸¸ä¸æ–¹ä¾¿ï¼Œä¼°è®¡ä½¿ç”¨è€…å¾—è‡ªå·±æ€»ç»“ä¸€äº›å…¶å¸¸ç”¨çš„ const string å†™è¿›å˜é‡ç›´æ¥è°ƒç”¨ã€‚<br>è¿™æ ·æ‰èƒ½æ¯”è¾ƒå¥½çš„ç»´æŒä»£ç å¯è¯»æ€§ã€‚</p>
]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title>Unity Odin CustomValueDrawer å°å‘</title>
    <url>/2022/04/16/20220416-odin-custom-value-drawer/</url>
    <content><![CDATA[<p>ä¸ºäº†æ–¹ä¾¿ç­–åˆ’åœ¨ scriptable object ä¸Šé…ç½®æˆ‘ä»¬çš„ä»»åŠ¡ä»¥åŠäº‹ä»¶ç›¸å…³çš„æ–‡æœ¬ï¼Œæˆ‘åšäº†ä¸€ä¸ªç®€å•çš„ struct ã€‚é‡Œé¢åŒ…å«äº† I2 çš„ Lockey å’Œä¸€ä¸ªå‚æ•°æ•°ç»„ã€‚<br>æ—¢ç„¶è¦æ–¹ä¾¿ç­–åˆ’é…ç½®ï¼Œé‚£è‚¯å®šè¦åšä¸€ä¸ªç®€å•çš„é¢„è§ˆï¼Œè¿™æ ·ç­–åˆ’å°±èƒ½çŸ¥é“è‡ªå·±é…ç½®çš„æ–‡æœ¬å‚æ•°æ˜¯å¦æ­£ç¡®ã€‚</p>
<p>æ—¢ç„¶è¦åšé¢„è§ˆï¼Œé‚£è‚¯å®šå¾—å¾—è‡ªå·±å¤å†™ä¸€ä¸‹ä»–çš„ property draweräº†ã€‚å¯¹ä¸€ä¸ªå­—æ®µçš„ç¼–è¾‘å™¨ç»˜åˆ¶é‡å†™æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯ç»§æ‰¿ OdinValueDrawer classï¼Œ è¿˜æœ‰ä¸€ç§æ˜¯ CustomValueDrawer Attribute.</p>
<p><a href="https://odininspector.com/tutorials/how-to-create-custom-drawers-using-odin/how-to-create-a-custom-value-drawer" target="_blank" rel="noopener">https://odininspector.com/tutorials/how-to-create-custom-drawers-using-odin/how-to-create-a-custom-value-drawer</a><br><a href="https://odininspector.com/attributes/custom-value-drawer-attribute" target="_blank" rel="noopener">https://odininspector.com/attributes/custom-value-drawer-attribute</a></p>
<h1 id="è¸©å‘"><a href="#è¸©å‘" class="headerlink" title="è¸©å‘"></a>è¸©å‘</h1><p>æˆ‘å®šä¹‰çš„ç»“æ„æ˜¯è¿™æ ·çš„ã€‚</p>
<p>åœ¨é»˜è®¤æƒ…å†µä¸‹ä»–å·²ç»èƒ½åœ¨ inspectorä¸Šç”»å‡ºæˆ‘çš„ Lockey å’Œæˆ‘çš„å‚æ•°æ•°ç»„ã€‚<br>å› ä¸ºè€ƒè™‘åˆ°ç»™æ•´ä¸ªç»“æ„åš OdinValueDrawer éœ€è¦è‡ªå·±ç”»æ•°ç»„æœ‰ç‚¹éº»çƒ¦ï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©ç”¨ CustomValueDrawer åªé‡æ–°ç”» LocalizedStringã€‚</p>
<p>LocalizedString çš„é‡ç”»æˆ‘ç›´æ¥ç…§æ¬äº†åŒäº‹çš„ï¼Œä½†æ˜¯æˆ‘å‘ç°äº†ä¸€ä¸ªéå¸¸å¥‡æ€ªçš„é—®é¢˜ã€‚</p>
<p>æˆ‘åˆ›å»ºäº†ä¸€ä¸ªä¸‹æ‹‰é€‰æ¡†ï¼Œç„¶ååœ¨ç”¨æˆ·é€‰ä¸­ä¸€ä¸ªæ–°çš„ lockey çš„æ—¶å€™æˆ‘å¯¹ç»“æ„ä½“ä¸­çš„ lockey è¿›è¡Œæ›´æ–°ã€‚ä½†æˆ‘å‘ç°åœ¨ä¸‹æ‹‰é€‰æ¡†çš„é€‰ä¸­äº‹ä»¶è§¦å‘åè¿›è¡Œèµ‹å€¼ï¼Œç»˜åˆ¶å®Œæˆå†è¿”å›æ–°çš„ç»“æ„ï¼Œå¾—åˆ°çš„æ˜¯æ²¡æœ‰è¢«æ›´æ”¹çš„ç»“æœã€‚<br>ä½†æ˜¯åŒæ ·çš„ç»˜åˆ¶ä»£ç ï¼Œåœ¨ OdinValueDrawer ä¸­å´èƒ½å¾—åˆ°æ­£ç¡®çš„ç»“æœï¼ï¼ï¼CustomValueDrawer å’Œ OdinValueDrawer çš„åŸç†æ˜¯ä¸ä¸€æ ·çš„ã€‚</p>
<p>OdinValueDrawer å°±æ˜¯ç›¸å½“äºä¸€ä¸ªæ›´å…ˆè¿›çš„ Property Drawer, åœ¨è¿™ä¸ªç»˜åˆ¶å™¨é‡Œæ˜¯å¯ä»¥è·å–åˆ°åŸæœ¬çš„å®é™…çš„å­—æ®µå€¼çš„ã€‚</p>
<p>CustomValueDrawer åˆ™åƒæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œé‡Œé¢åŒ…å«äº†ç»˜åˆ¶çš„æ–¹æ³•ï¼Œä½†æ˜¯ä¸èƒ½å¤Ÿç›´æ¥æ“ä½œåŸæœ¬çš„å­—æ®µï¼Œéœ€è¦æœ€åæŠŠä½ æ›´æ–°åˆ°çš„å€¼è¿”å›å‡ºå»ï¼Œè¿™æ‰èƒ½å¤Ÿèµ‹å€¼ç»™å®é™…çš„é‚£ä¸ªå­—æ®µã€‚</p>
<p>ä»£ç ç»™å‡ºï¼Œæœ‰é—®é¢˜çš„åœ°æ–¹ä½¿ç”¨æ³¨é‡Šæ ‡æ˜äº†ã€‚</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">[<span class="meta">Serializable</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> LocalizationStringParmPack</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">CustomValueDrawer(<span class="meta-string">"DrawPreviewText"</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> LocalizedString TextLoc;</span><br><span class="line">    <span class="keyword">public</span> LocalizationParamsManager.ParamValue[] ParmsArray;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">string</span> <span class="title">ToString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.GetRawEnglishString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> UNITY_EDITOR</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> GUIStyle m_previewStyle;</span><br><span class="line">    <span class="keyword">static</span> GUIStyle PreviewStyle</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (m_previewStyle == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                m_previewStyle = <span class="keyword">new</span> GUIStyle(EditorStyles.textArea);</span><br><span class="line">                m_previewStyle.wordWrap = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> m_previewStyle;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// use hacky stuff to get selected new lockey</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">string</span> s_wtfKey = <span class="keyword">string</span>.Empty;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">bool</span> s_hasChanged = <span class="literal">false</span>;</span><br><span class="line">    <span class="function">LocalizedString <span class="title">DrawPreviewText</span>(<span class="params">LocalizedString <span class="keyword">value</span>, GUIContent label</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">using</span> (<span class="keyword">new</span> EditorGUILayout.VerticalScope(UnityEditor.EditorStyles.helpBox))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// draw lockey</span></span><br><span class="line">            <span class="keyword">using</span> (<span class="keyword">new</span> EditorGUILayout.HorizontalScope())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (label != <span class="literal">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    EditorGUILayout.LabelField(label, GUILayout.Width(EditorGUIUtility.labelWidth));</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// weird stuff happin in dropdown</span></span><br><span class="line">                <span class="keyword">if</span> (EditorGUILayout.DropdownButton(<span class="keyword">new</span> GUIContent(<span class="keyword">value</span>.mTerm), FocusType.Keyboard))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">var</span> terms = LocalizationManager.GetTermsList();</span><br><span class="line">                    <span class="keyword">var</span> selector = <span class="keyword">new</span> GenericSelector&lt;<span class="keyword">string</span>&gt;(<span class="string">"Select Term"</span>, terms);</span><br><span class="line">                    selector.EnableSingleClickToSelect();</span><br><span class="line">                    selector.SelectionConfirmed += s =&gt;</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">if</span> (s.Any())</span><br><span class="line">                        &#123;</span><br><span class="line">                            s_wtfKey = s.First();</span><br><span class="line">                            <span class="comment">// WEIRD STUFF HERE</span></span><br><span class="line">                            <span class="comment">/* if I do  </span></span><br><span class="line"><span class="comment">                            LocalizedString next = new LocalizedString(s.First());</span></span><br><span class="line"><span class="comment">                            and return 'next' and the end of method, it just doesnt work!!!</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                            cuz the GenericSelector is actually a editor window, and</span></span><br><span class="line"><span class="comment">                            */</span></span><br><span class="line">                            s_hasChanged = <span class="literal">true</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;;</span><br><span class="line">                    selector.ShowInPopup();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">int</span> mask = (<span class="keyword">value</span>.mRTL_IgnoreArabicFix ? <span class="number">0</span> : <span class="number">1</span>) +</span><br><span class="line">                           (<span class="keyword">value</span>.mRTL_ConvertNumbers ? <span class="number">0</span> : <span class="number">2</span>) +</span><br><span class="line">                           (<span class="keyword">value</span>.m_DontLocalizeParameters ? <span class="number">0</span> : <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">using</span> (<span class="keyword">var</span> changed = <span class="keyword">new</span> EditorGUI.ChangeCheckScope())</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">int</span> newMask = EditorGUILayout.MaskField(mask, <span class="keyword">new</span> <span class="keyword">string</span>[] &#123; <span class="string">"Arabic Fix"</span>, <span class="string">"Ignore Numbers in RTL"</span>, <span class="string">"Localize Parameters"</span> &#125;, GUILayout.Width(<span class="number">30</span>));</span><br><span class="line">                    <span class="keyword">if</span> (newMask != mask)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">value</span>.mRTL_IgnoreArabicFix = (newMask &amp; <span class="number">1</span>) == <span class="number">0</span>;</span><br><span class="line">                        <span class="keyword">value</span>.mRTL_ConvertNumbers = (newMask &amp; <span class="number">2</span>) == <span class="number">0</span>;</span><br><span class="line">                        <span class="keyword">value</span>.m_DontLocalizeParameters = (newMask &amp; <span class="number">4</span>) == <span class="number">0</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (GUILayout.Button(<span class="string">$"Clear"</span>))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">/* this will also work</span></span><br><span class="line"><span class="comment">                    LocalizedString next = new LocalizedString("[NULL]");</span></span><br><span class="line"><span class="comment">                    */</span></span><br><span class="line">                    s_wtfKey = <span class="string">"[NULL]"</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            LocalizedString next = s_hasChanged ? <span class="keyword">new</span> LocalizedString(s_wtfKey) : <span class="keyword">value</span>;</span><br><span class="line">            s_hasChanged = <span class="literal">false</span>;</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            draw preview</span></span><br><span class="line"><span class="comment">            draw preview</span></span><br><span class="line"><span class="comment">            draw preview</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">            <span class="keyword">return</span> next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">string</span> <span class="title">GetParamValue</span>(<span class="params"><span class="keyword">string</span> key</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; ParmsArray.Length; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (ParmsArray[i].Name == key)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">string</span>.IsNullOrEmpty(ParmsArray[i].Value) ? key : ParmsArray[i].Value;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> key;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="åˆè¸©å‘"><a href="#åˆè¸©å‘" class="headerlink" title="åˆè¸©å‘"></a>åˆè¸©å‘</h1><p>å› ä¸ºè¿™è¾¹ä½¿ç”¨äº†é™æ€å­—æ®µï¼Œæ‰€ä»¥å¦‚æœéœ€è¦åŒæ—¶ç»˜åˆ¶è¿™ä¸ªå­—æ®µä¸¤æ¬¡ï¼Œé‚£å°±ä¼šå‡ºé—®é¢˜ã€‚æ‰€ä»¥æœ€åæˆ‘è¿˜æ˜¯æ¢å›OdinValueDrawerã€‚<br>é™æ€å­—æ®µæœ€å¥½è¿˜æ˜¯åˆ«åœ¨è¿™ç§æƒ…å†µä¸‹ä½¿ç”¨å§ã€‚</p>
]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>UnityEditor</tag>
      </tags>
  </entry>
  <entry>
    <title>Unity UGUI Ez Anchor</title>
    <url>/2022/04/23/20220423-ez-anchor/</url>
    <content><![CDATA[<p>ç»è¿‡äº†ä¸€æ¬¡ç”¨æˆ·æµ‹è¯•ä¹‹åï¼Œæ‹¿åˆ°çš„åé¦ˆè¯´æˆ‘ä»¬å¾ˆå¤šé¡µé¢çš„UXè®¾è®¡éƒ½ä¸è¡Œï¼Œåªèƒ½å„ç§é‡åšï¼Œä¸è®ºæ˜¯æˆ‘ç¨‹åºè¿™è¾¹è¿˜æ˜¯UXUIç»„é‚£è¾¹ï¼Œæˆ‘ä»¬éƒ½éœ€è¦é‡æ–°æ‹¼å¥½ä¸€äº› prefabã€‚</p>
<p>ç„¶åè¿˜æœ‰ä¸€äº›æ—§çš„ prefab æˆ‘ä»¬éœ€è¦æ¢çš®æ”¹å°ºå¯¸ä¹‹ç±»çš„ï¼Œè¿™æ¬¡å°±æ¥åˆ†äº«ä¸€ä¸ªç®€å•çš„å°å·¥å…·ï¼Œç”¨æ¥åšä¸€äº›ç®€å•çš„å°ºå¯¸é€‚é…ã€‚</p>
<img src="/2022/04/23/20220423-ez-anchor/20220423-pic001.gif" class="" title="split">
<p>RectTransform ä¸Š anchor çš„ Min, Max éƒ½æ˜¯å·²ç»åšäº†å½’ä¸€åŒ–çš„å€¼ã€‚ä¾é è°ƒæ•´ anchor çš„å€¼å°±å¯ä»¥è®¾ç½®å½“å‰å…ƒç´ åœ¨çˆ¶å…ƒç´ ä¸­çš„ç›¸å¯¹ä½ç½®å’Œé¢ç§¯å æ¯”ã€‚<br>å…·ä½“å‚è€ƒä¸‹é¢è¿™ç¯‡æ–‡ç« <br><a href="https://blog.csdn.net/ChinarCSDN/article/details/88983587" target="_blank" rel="noopener">https://blog.csdn.net/ChinarCSDN/article/details/88983587</a></p>
<h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h1><figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">[<span class="meta">InitializeOnLoad</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">RectTransformExtendedEditor</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">struct</span> EditContext</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">public</span> RectTransform Transform;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> EditContext m_context;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">bool</span> m_showTool;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="title">RectTransformExtendedEditor</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        Selection.selectionChanged += OnSelectionChanged;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">OnSelectionChanged</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        SceneView.duringSceneGui -= OnSceneGUI;</span><br><span class="line">        <span class="keyword">if</span> (Selection.activeTransform <span class="keyword">is</span> RectTransform rectTransform)</span><br><span class="line">        &#123;</span><br><span class="line">            m_context = <span class="keyword">new</span> EditContext()</span><br><span class="line">            &#123;</span><br><span class="line">                Transform = rectTransform</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            SceneView.duringSceneGui += OnSceneGUI;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">OnSceneGUI</span>(<span class="params">SceneView sceneView</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        Handles.BeginGUI();</span><br><span class="line">        <span class="keyword">if</span> (GUI.Button(<span class="keyword">new</span> Rect(<span class="number">0</span>, <span class="number">0</span>, <span class="number">20</span>, <span class="number">20</span>), <span class="string">"T"</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            m_showTool = !m_showTool;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (m_showTool)</span><br><span class="line">        &#123;</span><br><span class="line">            GUILayout.BeginArea(<span class="keyword">new</span> Rect(<span class="number">0</span>, <span class="number">20</span>, <span class="number">120</span>, <span class="number">320</span>));</span><br><span class="line">            <span class="keyword">if</span> (GUILayout.Button(<span class="string">"Set Anchors"</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                RectTransform rectTransform = m_context.Transform;</span><br><span class="line">                RectTransform parent = rectTransform.parent <span class="keyword">as</span> RectTransform;</span><br><span class="line"></span><br><span class="line">                Undo.RecordObject(rectTransform, <span class="string">"Set Anchors"</span>);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (parent != <span class="literal">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    Vector2 anchorMin = <span class="keyword">new</span> Vector2(</span><br><span class="line">                        rectTransform.anchorMin.x + rectTransform.offsetMin.x / parent.rect.width,</span><br><span class="line">                        rectTransform.anchorMin.y + rectTransform.offsetMin.y / parent.rect.height);</span><br><span class="line"></span><br><span class="line">                    Vector2 anchorMax = <span class="keyword">new</span> Vector2(</span><br><span class="line">                        rectTransform.anchorMax.x + rectTransform.offsetMax.x / parent.rect.width,</span><br><span class="line">                        rectTransform.anchorMax.y + rectTransform.offsetMax.y / parent.rect.height);</span><br><span class="line"></span><br><span class="line">                    rectTransform.anchorMin = anchorMin;</span><br><span class="line">                    rectTransform.anchorMax = anchorMax;</span><br><span class="line">                    rectTransform.offsetMin = rectTransform.offsetMax = Vector2.zero;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            GUILayout.EndArea();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Handles.EndGUI();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="End"><a href="#End" class="headerlink" title="End"></a>End</h1><p>æœ‰äº†è¿™ä¸ª acnhor é€‚é…çœŸçš„æ–¹ä¾¿ä¸å°‘ã€‚æœ‰æ—¶å€™æˆ‘ä»¬åšå¥½ä¸€ä¸ª list elementï¼Œä½†åœ¨ä¸åŒçš„åœ°æ–¹ç”¨åˆ°çš„æ—¶å€™å¤§å°å¯èƒ½ä¸ä¸€æ ·ã€‚<br>ç”¨è¿™ä¸ªé€‚é…è°ƒæ•´ä»¥åå¯ä»¥é˜²æ­¢å„ç§å¥‡å¦™å‡ºæ ¼ï¼Œè€Œä¸”å°±ç‚¹ä¸¤ä¸‹æŒ‰é’®ï¼Œå¯¹äº UXUI å›¢é˜Ÿæ¥è¯´ä¹Ÿæ˜¯éå¸¸å®¹æ˜“ä¸Šæ‰‹çš„ã€‚</p>
]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>Unity</tag>
        <tag>UGUI</tag>
      </tags>
  </entry>
  <entry>
    <title>Hyperv è™šæ‹Ÿæœºå…±äº«VPNç»™å®¿ä¸»æœº</title>
    <url>/2022/05/15/20220515-hyperv-vpn-inside/</url>
    <content><![CDATA[<p>è¢«å°åœ¨é¼ çªé‡Œä¸¤ä¸ªæœˆäº†ï¼Œä¸€ç›´éƒ½æ˜¯åœ¨å®¶ç”¨è‡ªå·±çš„è€çˆ·å¤‡ç”¨æœºåšå·¥ä½œã€‚ä½†æ˜¯è€(é¡¹)çˆ·(ç›®)æœºçš„æ€§(ä¼˜)èƒ½(åŒ–)å®åœ¨æ˜¯å¤ªå·®äº†ã€‚<br>æ‰“å¼€ Unity éœ€è¦5åˆ†é’Ÿï¼Œç¼–è¯‘ä»£ç 3åˆ†é’Ÿï¼Œç‚¹ä¸€ä¸‹ play åˆæ˜¯2åˆ†é’Ÿã€‚è¿™æ®µæ—¶é—´æ¥å›ä¿®å„ç§BUGï¼Œåˆ‡æ¥åˆ‡å»æµªè´¹äº†å¾ˆå¤šæ—¶é—´ã€‚</p>
<p>å†³å®šè¿˜æ˜¯ç”¨å¤§å¥¶æœºå·¥ä½œäº†ï¼Œä½†åˆéå¸¸ä¸æ„¿æ„æŠŠå…¬å¸çš„é—´è°å…¨å®¶æ¡¶è£…åœ¨ç”µè„‘ä¸Šï¼Œå’‹åŠå‘¢ï¼Ÿ</p>
<p>ä¸Šç½‘æŸ¥äº†ä¸€ä¸‹ï¼Œå¤§å®¶è¯´å¯ä»¥æŠŠå…¨å®¶æ¡¶å…³åœ¨è™šæ‹Ÿæœºé‡Œï¼Œç„¶åå†æŠŠç½‘ç»œåˆ†äº«ç»™å®¿ä¸»æœºã€‚</p>
<h2 id="Hyper-V"><a href="#Hyper-V" class="headerlink" title="Hyper-V"></a>Hyper-V</h2><p>æœ€å¼€å§‹è¯•ç”¨äº† VirtualBox æ— è®ºæ˜¯è£…32ä½è¿˜æ˜¯64ä½çš„Win10æˆ–è€… WinServer éƒ½å¡åˆ°é£èµ·ã€‚å³ä½¿æŠŠè™šæ‹Ÿæœºçš„è™šæ‹Ÿç›˜æ”¾åœ¨ SSD ä¸Šä¹Ÿè¿˜æ˜¯å¡ã€‚<br>äº†è§£åˆ° Windows æœ‰è¿™ä¸ª Hyper-V è™šæ‹Ÿæœºå°±å†³å®šè¯•ç”¨ä¸€ä¸‹ã€‚</p>
<p>ç»“æœè¿™ä¸ªç©æ„å„¿æ€§èƒ½è¶…æ£’çš„å“¦ï¼æ”¾åœ¨ SSD ä¸Šå¯ä»¥è¯´æ˜¯ä¸æ€ä¹ˆå¡ã€‚è€Œä¸”ä¹Ÿèƒ½ç›´æ¥è¯»å®¿ä¸»æœºçš„ç¡¬ç›˜æˆ–æ²¹ç›˜ï¼Œéå¸¸çš„æ–¹ä¾¿ï¼Œè™½ç„¶è¯»ç›˜çš„æ—¶å€™ç¡¬ç›˜ä½¿ç”¨ç‡æ˜¾ç¤ºæ˜¯æ‹‰æ»¡çš„ã€‚</p>
<p>æˆ‘è®°å¾—ä»¥å‰å¦‚æœè¦è¦ä½¿ç”¨ VM æˆ–è€… VBox çš„è¯éœ€è¦å…³é—­ Hyper-V çš„åŠŸèƒ½ï¼Œä½†æ˜¯è‡ªä» Win10 20H2 è¿˜æ˜¯æŸä¸ªç‰ˆæœ¬ä¹‹åå°±ä¸éœ€è¦è¿™ä¹ˆåšäº†ã€‚</p>
<h3 id="è™šæ‹Ÿæœºå¯åŠ¨å°å‘"><a href="#è™šæ‹Ÿæœºå¯åŠ¨å°å‘" class="headerlink" title="è™šæ‹Ÿæœºå¯åŠ¨å°å‘"></a>è™šæ‹Ÿæœºå¯åŠ¨å°å‘</h3><p>â€œBoot Issue: Start PXE over IPv4â€</p>
<p>è£…å¥½ç³»ç»Ÿä»¥åä¿ºå¯åŠ¨è™šæ‹Ÿæœºå°±æŠ¥è¿™ä¸ªé”™è¯¯ã€‚<br>æŠŠç¡¬ç›˜ç§»åŠ¨åˆ°ç¬¬ä¸€ä½å°±å¥½äº†ã€‚</p>
<img src="/2022/05/15/20220515-hyperv-vpn-inside/20220515-pic004.png" class="" title="split">
<h2 id="é…ç½®è™šæ‹Ÿç½‘å¡"><a href="#é…ç½®è™šæ‹Ÿç½‘å¡" class="headerlink" title="é…ç½®è™šæ‹Ÿç½‘å¡"></a>é…ç½®è™šæ‹Ÿç½‘å¡</h2><p>å‚è€ƒäº†ç½‘ä¸Šçš„é€šç”¨æ–¹æ¡ˆï¼Œéœ€è¦ä¸¤å¼ è™šæ‹Ÿç½‘å¡ï¼Œä¸€å¼ æ¡¥æ¥ç”¨æ¥ä¸Šç½‘ï¼Œå¦ä¸€ä¸ªæ¥æ”¶å…¨å®¶æ¡¶çš„åˆ†äº«ã€‚</p>
<p>æ¡¥æ¥</p>
<p>æˆ‘è¿™è¾¹é€‰ç”¨çš„æ˜¯æœ‰çº¿ç½‘çš„æ¥å£</p>
<img src="/2022/05/15/20220515-hyperv-vpn-inside/20220515-pic001.png" class="" title="split">
<p>å†…éƒ¨ç½‘ç»œ</p>
<img src="/2022/05/15/20220515-hyperv-vpn-inside/20220515-pic002.png" class="" title="split">
<p>ipconfig ç»“æœ</p>
<img src="/2022/05/15/20220515-hyperv-vpn-inside/20220515-pic003.png" class="" title="split">
<h2 id="å®¿ä¸»æœºé…ç½®"><a href="#å®¿ä¸»æœºé…ç½®" class="headerlink" title="å®¿ä¸»æœºé…ç½®"></a>å®¿ä¸»æœºé…ç½®</h2><p>æ¥ä¸‹æ¥å°±æ˜¯é…ç½®å®¿ä¸»æœºï¼Œè¿™åˆæœ‰ä¸€ä¸ªä¸ä¸€æ ·çš„æƒ…å†µå‡ºç°äº†ã€‚</p>
<p>åœ¨ Hyper-V é‚£è¾¹æ·»åŠ äº†1ä¸ªè™šæ‹Ÿäº¤æ¢æœºä»¥å, å®¿ä¸»æœºè¿™è¾¹ä¼šå‡ºç°2ä¸ªé€‚é…å™¨ã€‚ä¸çŸ¥é“æ˜¯ä¸æ˜¯æˆ‘è¿™è¾¹ç‰¹æœ‰çš„æƒ…å†µã€‚<br>æŠŠå†…éƒ¨ç½‘ç»œé€‚é…å™¨çš„IPåœ°å€è®¾ç½®åˆ° 192.168.137.0 ç½‘æ®µï¼Œæˆ‘è¿™è¾¹ä¿®æ”¹çš„æ˜¯è¿™ä¸ªåå­—ç›¸åŒçš„ã€‚</p>
<img src="/2022/05/15/20220515-hyperv-vpn-inside/20220515-pic005.png" class="" title="split">
<p>ç„¶åå®¿ä¸»æœºæ·»åŠ è½¬å‘å°±å¯ä»¥äº†ï¼Œä¸è¿‡é€Ÿåº¦ä¸å¤Ÿå¿«ï¼Œå…¨å®¶æ¡¶ç›´æ¥è£…å®¿ä¸»æœºä¸Šè¿˜æ˜¯æ¯”è¾ƒå¿«çš„ï¼Œ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">route add x.y.0.0 mask 255.255.0.0 192.168.137.1</span><br></pre></td></tr></table></figure>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://yidianyidi.fun/VirtualBox/yidianyidi-1708121150.html" target="_blank" rel="noopener">https://yidianyidi.fun/VirtualBox/yidianyidi-1708121150.html</a></p>
<p><a href="https://www.youtube.com/watch?v=9Hc-5EOtaJs" target="_blank" rel="noopener">https://www.youtube.com/watch?v=9Hc-5EOtaJs</a></p>
]]></content>
      <categories>
        <category>VirtualMachine</category>
      </categories>
      <tags>
        <tag>Misc</tag>
        <tag>VirtualMachine</tag>
      </tags>
  </entry>
  <entry>
    <title>notes dat I took from the Divsion UI talk</title>
    <url>/2022/08/06/20220806-division-UI-talk-note/</url>
    <content><![CDATA[<p>Well just ignore dat weird tag. :D</p>
<p>Here is muy notes dat I learn from the Divsion UI talk.</p>
<p>The key is iteration, threading and data.</p>
<p>Iterate your stuff to make it better.</p>
<p>Threading and data driven make the work efficient.</p>
<p><a href="https://www.youtube.com/watch?v=H1MLtML0np0" target="_blank" rel="noopener">video</a>.</p>
<h1 id="Snow-drop-UI"><a href="#Snow-drop-UI" class="headerlink" title="Snow drop UI"></a>Snow drop UI</h1><ul>
<li>No canvas</li>
<li>Immediate Mode<ul>
<li>Constant cost (maybe itâ€™s more statble?).</li>
</ul>
</li>
<li>Vector Graphics<ul>
<li>Shapes(scaling friendly, dun rely on resolution) over textures masks.</li>
<li>Save GPU load by only rendering the pixels gonna be used.</li>
<li>Artist can play with it.</li>
</ul>
</li>
</ul>
<h1 id="Game-Data-amp-Node-graph"><a href="#Game-Data-amp-Node-graph" class="headerlink" title="Game Data &amp; Node graph"></a>Game Data &amp; Node graph</h1><ul>
<li><p>Lots of data getter (get pure data?) (in graph node), used in UI and also game play.</p>
</li>
<li><p>Auto conversion to save some performance.</p>
</li>
<li><p>custom UI logic components.</p>
</li>
<li><p>custom reusable compounds.</p>
</li>
</ul>
<h1 id="Iteration"><a href="#Iteration" class="headerlink" title="Iteration"></a>Iteration</h1><h2 id="For-coder"><a href="#For-coder" class="headerlink" title="For coder"></a>For coder</h2><h3 id="Reduce-complie-time"><a href="#Reduce-complie-time" class="headerlink" title="Reduce complie time"></a>Reduce complie time</h3><ul>
<li>Blob builds(idk what is this).</li>
<li>Header file reduction.</li>
<li>Keep refactoring code to make it efficient.</li>
<li>Remove nolonger used code.</li>
</ul>
<h3 id="Reduce-startup-time-and-Load-time"><a href="#Reduce-startup-time-and-Load-time" class="headerlink" title="Reduce startup time and Load time"></a>Reduce startup time and Load time</h3><ul>
<li>Only load needed stuff.</li>
<li>UI preview with live data for easy iteration.</li>
<li>Well some debug UI will also help :).</li>
</ul>
<p>(for my unity project)</p>
<ul>
<li>Have a UI preview scene (UI only, we can preview states and transitions).</li>
<li>Have simple a gym dat provide gameplay with enough content.</li>
</ul>
<h3 id="Coder-to-Artist"><a href="#Coder-to-Artist" class="headerlink" title="Coder to Artist"></a>Coder to Artist</h3><ul>
<li><p>Coder work with artist (react fast to feedbacks).</p>
</li>
<li><p>Resable compounds, arist can directly use.</p>
</li>
</ul>
<h2 id="Drawback-of-iteration"><a href="#Drawback-of-iteration" class="headerlink" title="Drawback of iteration"></a>Drawback of iteration</h2><ul>
<li>Hard to stop.</li>
<li>Set clear goals and deadlines. (do not waste time)</li>
<li>Greate for prototyping, risk for delivering. (need a lead to shut down iteration, make the decision)</li>
</ul>
<h1 id="Building-blocks-of-UI"><a href="#Building-blocks-of-UI" class="headerlink" title="Building blocks of UI"></a>Building blocks of UI</h1><p>To let arist and designers to have full(or more) control?</p>
<h2 id="Widget-and-Graphics"><a href="#Widget-and-Graphics" class="headerlink" title="Widget and Graphics"></a>Widget and Graphics</h2><p>Widget define space, accept input. Graphic improve widget, relative size, also accept input?</p>
<h2 id="5-Basic-widgets-with-a-few-variations"><a href="#5-Basic-widgets-with-a-few-variations" class="headerlink" title="5 Basic widgets with a few variations."></a>5 Basic widgets with a few variations.</h2><p>Use basic widgets, and use them to build functionalities.</p>
<ul>
<li><p>Window</p>
<ul>
<li>2D and 3D (anchoring functionalities, pixels or percentage; prepare some options for different auto scaling and apply to different UI widgets/graphic and situations).</li>
<li>Vertical Stack (stack the (children)widgets)</li>
<li>Layering</li>
</ul>
</li>
<li><p>Text</p>
<ul>
<li>JIT font generaion (wtf, keep memory down)</li>
<li>Fich text formatting lib to build customize text(icon, color â€¦).</li>
<li>Auto clip (no idea how to do it)</li>
</ul>
</li>
<li><p>Image</p>
<ul>
<li>Use color/gradient more. (looks good with vector graphic)</li>
<li>Texture and loose image(ikd this, no border image?) into sprite sheet.</li>
</ul>
</li>
<li><p>Stack container</p>
<ul>
<li>For sorting elements.</li>
<li>Spacing and padding (how to do it with stack)</li>
<li>Invert for quick right to left language fixes (wtf)</li>
</ul>
</li>
<li><p>Scroll Box</p>
<ul>
<li>Fixed size(viewport size) with a virtual inner space(content).</li>
</ul>
</li>
</ul>
<h2 id="7-Graphics-nodes"><a href="#7-Graphics-nodes" class="headerlink" title="7 Graphics (nodes)"></a>7 Graphics (nodes)</h2><ul>
<li>Text with effects.</li>
<li>Images(basic) with more shapes, flat or curved.</li>
<li>Lines(strait, curved list?, 3d)</li>
<li>Points, single point or large squares(for effects?)</li>
<li>Shapes </li>
<li>Sector (why? for their art style?)</li>
<li>Custom graphics</li>
</ul>
<h1 id="Simply-Ui-workflow"><a href="#Simply-Ui-workflow" class="headerlink" title="Simply Ui workflow"></a>Simply Ui workflow</h1><ul>
<li>Complex and powerful (lots of resuable compounds, and threading stuff)</li>
<li>Documentation and examples(I guess examples are better and save time)</li>
</ul>
<h2 id="For-coder-1"><a href="#For-coder-1" class="headerlink" title="For coder"></a>For coder</h2><ul>
<li>Simple code; Less code, less bugs </li>
<li>Simple Tools; Do not overthink. Simple base, complex behaviour.</li>
</ul>
<h2 id="For-UI-artist-designer"><a href="#For-UI-artist-designer" class="headerlink" title="For UI artist/designer"></a>For UI artist/designer</h2><ul>
<li>Communicate to avoid merge conflicts, get ahead of it (cuz yaml merge wont help u all the time).</li>
</ul>
]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title>æŸ¥è¯¢MonoBehaviouråœ¨å·¥ç¨‹ä¸­çš„å¼•ç”¨</title>
    <url>/2022/07/24/20220724-find-script-reference/</url>
    <content><![CDATA[<p>ä»¥å‰å¼„è¿‡ä¸€ä¸ªåœ¨é¡¹ç›®ä¸­æŸ¥æ‰¾Assetå¼•ç”¨çš„ã€‚è™½ç„¶å¾ˆæ³›ç”¨ï¼Œä½†è·‘èµ·æ¥éå¸¸çš„æ…¢ã€‚<br>å…¶å®æˆ‘ä»¬å®é™…ä½¿ç”¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šç»å¸¸åšæŸä¸€ç§æœç´¢(æ¯”å¦‚æŸ¥æ‰¾è„šæœ¬åœ¨é¢„åˆ¶ä½“ä¸Šçš„å¼•ç”¨)ã€‚å¯¹äºè¿™ç§éœ€è¦ä½¿ç”¨çš„ç‰¹å®šæ¡ä»¶çš„æŸ¥æ‰¾ï¼Œå•ç‹¬åšä¸€ä¸ªå°å·¥å…·å¯èƒ½æ•ˆç‡ä¼šæ›´é«˜ã€‚</p>
<p>æœ¬æ¥è¿˜åœ¨çƒ¦æ¼æ€ä¹ˆåšï¼Œå¯¼å¸ˆå¾ˆå¿«å°±åšå¥½äº†ï¼Œè·‘èµ·æ¥å¾ˆå¿«ã€‚ä»–å‘Šè¯‰æˆ‘ï¼Œç§˜è¯€æ˜¯ GetComponentã€‚</p>
<h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>ä»£ç ä¸æ–¹ä¾¿ç›´æ¥è´´å‡ºæ¥ï¼Œä½†è¿˜æ˜¯æƒ³åˆ†äº«(è®°å½•)ä¸€ä¸‹å‡ ä¸ªå…³é”®çš„æ­¥éª¤å’Œæ€è·¯~</p>
<h3 id="é€‰æ‹©è„šæœ¬"><a href="#é€‰æ‹©è„šæœ¬" class="headerlink" title="é€‰æ‹©è„šæœ¬"></a>é€‰æ‹©è„šæœ¬</h3><p>æˆ‘ä»¬éœ€è¦åœ¨ç¼–è¾‘å™¨ä¸Šç”¨ä¸€ä¸ª field å»æ”¾æˆ‘ä»¬æƒ³è¦æœå¯»çš„è„šæœ¬ã€‚<br>ä½†æ˜¯æ²¡åŠæ³•æ˜¯ç”¨åœ¨æ³›å‹ç±»ä¸Šã€‚éœ€è¦æŒ‡å®šå®é™…çš„ç±»å‹ã€‚</p>
<p>Interfaceä¹Ÿå¯ä»¥æŸ¥ï¼Œæ”¾å¿ƒç”¨ï¼</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">targetScript = EditorGUILayout.ObjectField(m_targetScript, <span class="keyword">typeof</span>(MonoScript), <span class="literal">false</span>) <span class="keyword">as</span> MonoScript;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">class SomeMono&lt;TData&gt; : MonoBehaviour</span></span><br><span class="line"><span class="comment">doesnt work on this case, the result will be null     </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">Type targetType = m_targetScript.GetClass();</span><br></pre></td></tr></table></figure>
<h3 id="è·å–é¢„åˆ¶ä½“"><a href="#è·å–é¢„åˆ¶ä½“" class="headerlink" title="è·å–é¢„åˆ¶ä½“"></a>è·å–é¢„åˆ¶ä½“</h3><p>ä»æˆ‘ä»¬é€‰æ‹©çš„ç›®å½•ä¸‹è·å–æ‰€æœ‰çš„prefabï¼Œç›¸ä¿¡Unityï¼Œè¿™ä¸€æ­¥ä¸ä¼šå¾ˆæ…¢çš„ã€‚</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// we can also set the folderPath to save our time :D </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> paths = AssetDatabase.FindAssets(<span class="string">$"t: prefab"</span>, <span class="keyword">new</span>[] &#123; folderPath &#125;);</span><br><span class="line">GameObject[] toCheck = <span class="keyword">new</span> GameObject[paths.Length];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; paths.Length; i++)</span><br><span class="line">    toCheck[i] = AssetDatabase.LoadAssetAtPath&lt;GameObject&gt;(AssetDatabase.GUIDToAssetPath(paths[i]));</span><br></pre></td></tr></table></figure>
<h3 id="æŸ¥è¯¢å¼•ç”¨"><a href="#æŸ¥è¯¢å¼•ç”¨" class="headerlink" title="æŸ¥è¯¢å¼•ç”¨"></a>æŸ¥è¯¢å¼•ç”¨</h3><figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">Type targetType;</span><br><span class="line">GameObject prefab;</span><br><span class="line"><span class="keyword">var</span> components = prefab.GetComponents(targetType);</span><br><span class="line"><span class="comment">// if components is not empty, then you get your stuff :D</span></span><br></pre></td></tr></table></figure>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å¦‚æœè¦è¯´å­¦åˆ°äº†ä»€ä¹ˆçš„è¯ï¼Œå¤§æ¦‚æ˜¯åšå·¥å…·å‰è¦ææ˜ç™½å®ƒçš„ä½¿ç”¨æƒ…æ™¯ï¼Œä¸èƒ½å¤ªè„±èŠ‚Tw.T</p>
]]></content>
      <categories>
        <category>UnityEditor</category>
      </categories>
      <tags>
        <tag>Unity</tag>
        <tag>UnityEditor</tag>
      </tags>
  </entry>
  <entry>
    <title>Unity Video Url source èµ‹å€¼å°å‘</title>
    <url>/2022/08/10/20220810-unity-video-url-delay/</url>
    <content><![CDATA[<p>è¿™å‘¨èµ¶ç‰ˆæœ¬ï¼Œæ¥åˆ°äº†ä¸€ä¸ªå‰åŒäº‹ç•™ä¸‹æ¥çš„bugã€‚æ˜¯è¯´UIä¸Šçš„æ•™ç¨‹è§†é¢‘ä¸€ç›´ä¸æ’­æ”¾ã€‚<br>æˆ‘ä»¬çš„è§†é¢‘èµ„æºæ˜¯åœ¨ StreamingAssets ä¸‹çš„ï¼Œç”¨pathè¿›è¡ŒåŠ è½½ã€‚<br>æ’­æ”¾ç›¸å…³çš„ä»£ç å¦‚ä¸‹ã€‚</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">OnEnable</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    m_player.prepareCompleted += OnPrepareCompleted;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">OnPrepareCompleted</span>(<span class="params">VideoPlayer source</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Debug.Log(<span class="string">"OnPrepareCompleted"</span>);</span><br><span class="line">    m_player.Play();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SetVideo</span>(<span class="params"><span class="keyword">string</span> path</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    m_player.source = VideoSource.Url;</span><br><span class="line">    <span class="comment">// I guess this process may not be finished now.</span></span><br><span class="line">    m_player.url = path;</span><br><span class="line">    m_player.Prepare();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æŸ¥äº†ä¸€ä¸‹ï¼Œå‘ç°åœ¨è°ƒç”¨äº† SetVideo ä¹‹åï¼ŒOnPrepareCompletedæ²¡æœ‰è¢«è°ƒç”¨ï¼Œæ„æ€æ˜¯ VideoPlayerçš„prepareCompletedäº‹ä»¶æ²¡æœ‰è§¦å‘ã€‚<br>æˆ‘çŒœå‘ç”Ÿè¿™ä¸ªæƒ…å†µçš„åŸå› æ˜¯ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨urlæ¥è®¾ç½®è§†é¢‘èµ„æºçš„é‚£ä¸€å¸§ï¼ŒVideoPlayerè¿˜æ²¡èƒ½è·å–åˆ°è§†é¢‘èµ„æºçš„ä¸€äº›å±æ€§ï¼Œæˆ–æ˜¯ä¸Šä¸€ä¸ªè§†é¢‘èµ„æºè¿˜åœ¨å ç”¨ç€å½“å‰çš„æ’­æ”¾å™¨ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™å¦‚æœè°ƒç”¨PrePareï¼Œå…¶å®æ˜¯æ²¡æœ‰ç”¨çš„ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä½¿ç”¨çš„Hacky Fixæ˜¯åœ¨è®¾ç½®å®Œèµ„æºçš„URLä¹‹åï¼Œç­‰ä¸€å¸§å†è°ƒç”¨Prepareï¼Œç„¶åç­‰å¾… prepareCompleted äº‹ä»¶ã€‚</p>
<p>é¡ºä¾¿åœ¨ç½‘ä¸ŠæŸ¥äº†ä¸€ä¸‹ï¼Œä¹Ÿæœ‰äº›äººé‡åˆ°ç±»ä¼¼çš„é—®é¢˜ï¼Œè¯´æ˜¯èµ‹å€¼URLä¹‹åä¸çŸ¥é“è§†é¢‘èµ„æºä»€ä¹ˆæ—¶å€™æ‰èƒ½æ­£ç¡®æ’­æ”¾ã€‚<br>è®ºå›é‡Œæœ‰ä¸ªäººç»™å‡ºçš„è§£å†³æ–¹æ³•æ˜¯å»æ£€æŸ¥ VideoPlayer.isPrepared çš„è¿™ä¸ªå±æ€§ã€‚ä½†èµ‹å€¼URLä¹‹åè¿™ä¸ªå€¼å¹¶ä¸ä¼šåœ¨æŸä¸€æ—¶åˆ»å˜æˆtrueã€‚</p>
]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title>Unity RectTransform å°ç¬”è®°</title>
    <url>/2022/08/14/20220814-unity-recttransform/</url>
    <content><![CDATA[<p>ä¹‹å‰çœ‹äº†ä¸€äº›å…³äºRectTransformçš„æ–‡ç« ï¼Œä½†æ˜¯æœ€ç»ˆè®°å¿†éƒ½ä¸æ˜¯å¾ˆæ·±åˆ»ã€‚è€Œä¸”è¦ç”¨çš„æ—¶å€™é‡æ–°æ‰¾è¿˜æŒºéº»çƒ¦çš„ã€‚<br>å¹²è„†æŠŠåˆ«äººçš„ç¬”è®°æŠ„æ¥ä¸€äº›å¥½äº†ï¼Œä»¥åä¹Ÿæ–¹ä¾¿å°±ç€è‡ªå·±çš„ç¬”è®°å’ŒUXUIåŒå­¦è§£é‡Šã€‚</p>
<h1 id="Pivot"><a href="#Pivot" class="headerlink" title="Pivot"></a>Pivot</h1><p>ä¸­å¿ƒç‚¹ï¼Œæ˜¯UIå…ƒç´ æ—‹è½¬/ç¼©æ”¾çš„ä¸­å¿ƒç‚¹ã€‚ä½¿ç”¨å½’ä¸€åŒ–Vector2è¡¨ç¤ºã€‚</p>
<h1 id="Anchor"><a href="#Anchor" class="headerlink" title="Anchor"></a>Anchor</h1><p>å…¶å®æ˜¯ç”±ä¸¤ä¸ªç‚¹ç»„æˆçš„(AnchorMin, AnchorMax)ã€‚å¹¶ä½¿ç”¨å½’ä¸€åŒ–Vector2æ¥è¡¨ç¤ºã€‚<br>æ•°å€¼ä»£è¡¨äº†åœ¨çˆ¶ç±»Xè½´å’ŒYè½´æ–¹å‘çš„ç™¾åˆ†æ¯”ã€‚</p>
<h2 id="ç»å¯¹å¸ƒå±€"><a href="#ç»å¯¹å¸ƒå±€" class="headerlink" title="ç»å¯¹å¸ƒå±€"></a>ç»å¯¹å¸ƒå±€</h2><blockquote>
<p>å½“anchorMaxä¸anchorMinç›¸ç­‰æ—¶ï¼ŒAnchorå‘ˆç°ä¸ºä¸€ä¸ªç‚¹ï¼Œç§°ä¹‹ä¸ºé”šç‚¹<br>åœ¨ä½¿ç”¨é”šç‚¹çš„æƒ…å†µä¸‹ï¼ŒanchoredPositionæ˜¯å…ƒç´ Pivotåˆ°Anchorçš„è·ç¦»</p>
</blockquote>
<p>æ­¤æ—¶ä¼šæœ‰4ä¸ªé‡è¦çš„å±æ€§ã€‚</p>
<ul>
<li>PosX, posY : ä¸­å¿ƒç‚¹åˆ°é”šç‚¹çš„å‚æ•°ï¼Œå®é™…åƒç´ å€¼</li>
<li>Width, Height : UI å…ƒç´ çš„å°ºå¯¸</li>
</ul>
<p>ç»å¯¹å¸ƒå±€çš„æƒ…å†µä¸‹æ— è®ºåˆ†è¾¨ç‡æ˜¯å¤šå°‘ï¼Œçˆ¶ç‰©ä½“å¤šå¤§ï¼Œè¯¥UIå…ƒç´ çš„å¤§å°æ˜¯æ’å®šçš„ã€‚</p>
<h2 id="ç›¸å¯¹å¸ƒå±€"><a href="#ç›¸å¯¹å¸ƒå±€" class="headerlink" title="ç›¸å¯¹å¸ƒå±€"></a>ç›¸å¯¹å¸ƒå±€</h2><blockquote>
<p>å½“anchorMaxä¸anchorMinä¸ç›¸ç­‰æ—¶ï¼ŒAnchorå‘ˆç°ä¸ºä¸€ä¸ªæ¡†ï¼Œç§°ä¹‹ä¸ºé”šæ¡†<br>åœ¨ä½¿ç”¨é”šæ¡†çš„æƒ…å†µä¸‹ï¼ŒanchoredPositionæ˜¯å…ƒç´ Pivotåˆ°é”šæ¡†ä¸­å¿ƒç‚¹çš„è·ç¦»</p>
</blockquote>
<p>è¿™ç§æƒ…å†µä¸‹UIå…ƒç´ çš„å››ä¸ªè§’ï¼Œè·ç¦»å››ä¸ªå¯¹åº”çš„é”šç‚¹çš„è·ç¦»æ˜¯ä¸å˜çš„ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹RectTransformçš„å±æ€§åˆå˜ä¸ºäº†Left,Top,Right,Bottomã€‚</p>
<ul>
<li>Left,Top,Right,Bottom : å››ä¸ªç‚¹çš„æ•°å€¼åˆ†åˆ«æ˜¯(Left,Top,Right,Bottom)é”šç‚¹åˆ°å®é™…çš„rectçš„è¿™4ä¸ªä½ç½®çš„ç‚¹çš„è·ç¦»ã€‚</li>
</ul>
<h1 id="SizeDelta"><a href="#SizeDelta" class="headerlink" title="SizeDelta"></a>SizeDelta</h1><h2 id="OffsetMin-OffsetMax"><a href="#OffsetMin-OffsetMax" class="headerlink" title="OffsetMin/OffsetMax"></a>OffsetMin/OffsetMax</h2><p>minæ˜¯å®é™…UIåŸç´ ç›¸å¯¹äºAnchorMinçš„åç§»ï¼Œå¦å¤–ä¸€ä¸ªä¸è¨€è€Œå–».</p>
<p>sizeDeltaå°±æ˜¯offsetMax - offsetMinçš„å€¼ã€‚</p>
<blockquote>
<p>æ‰€ä»¥è¿™ä¸ªå±æ€§ä¹‹æ‰€ä»¥å«åšsizeDeltaï¼Œæ˜¯å› ä¸ºåœ¨é”šç‚¹æƒ…å†µä¸‹å…¶è¡¨å¾çš„æ˜¯sizeï¼ˆå¤§å°ï¼‰ï¼Œåœ¨é”šæ¡†çš„æƒ…å†µä¸‹å…¶è¡¨å¾çš„æ˜¯Deltaï¼ˆUIå…ƒç´ å®é™…çš„å±æ€§å€¼ä¸é”šæ¡†çš„å·®å€¼ï¼‰</p>
</blockquote>
<h1 id="Rect"><a href="#Rect" class="headerlink" title="Rect"></a>Rect</h1><p>rectä¸­çš„å±æ€§ï¼Œä¸ä¸UIå…ƒç´ æ‰€åœ¨çš„ä½ç½®æœ‰å…³ï¼Œåªå’Œå…¶è‡ªèº«å±æ€§ç›¸å…³ã€‚æ ¹æ®rectä¸­æä¾›çš„widthå’Œheightå¯ä»¥å¾—åˆ°UIå…ƒç´ å®é™…çš„å°ºå¯¸å¤§å°ã€‚</p>
<p>rect.positionæŒ‡çš„æ˜¯ä»¥Pivotä¸ºåŸç‚¹ï¼ŒUIå…ƒç´ å·¦ä¸‹è§’çš„åæ ‡ã€‚(right,up ä¸ºæ­£æ–¹å‘)</p>
<h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><p><a href="https://zhuanlan.zhihu.com/p/194317677" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/194317677</a><br><a href="https://blog.csdn.net/jmu201521121014/article/details/105725175" target="_blank" rel="noopener">https://blog.csdn.net/jmu201521121014/article/details/105725175</a></p>
<p>é¡ºä¾¿æ¨èä¸€ä¸‹åœ¨çº¿ç”»å›¾å°å·¥å…·ï¼Œä¸æ–¹ä¾¿è´´å›¾çš„æ—¶å€™ç”¨è¿™ä¸ªè¿˜æŒºä¸é”™çš„ã€‚<br><a href="https://asciiflow.com/#/" target="_blank" rel="noopener">https://asciiflow.com/#/</a><br><a href="https://textik.com/" target="_blank" rel="noopener">https://textik.com/</a></p>
]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>Unity</tag>
        <tag>UGUI</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨ State Object æš‚å­˜ property drawer çš„çŠ¶æ€ã€‚</title>
    <url>/2022/07/30/20220730-unity-editor-stateobj/</url>
    <content><![CDATA[<p>æœ€è¿‘åœ¨åšçº¢ç‚¹åŠŸèƒ½ï¼Œpathæ˜¯ç”¨stringæŒ‚åœ¨UIç‰©ä½“ä¸Šçš„ã€‚UIåŒå­¦é‚£è¾¹æƒ³è¦ä¸€ä¸ªæŒ‰é’®å¯ä»¥åˆ‡æ¢pathåœ¨inspectoræ˜¯å¯ç¼–è¾‘æˆ–ä¸å¯ç¼–è¾‘çš„çŠ¶æ€ã€‚<br>æœ€å¼€å§‹æ¯«æ— æ€è·¯ï¼Œå› ä¸ºæœ¬èº«pathæ˜¯ä¸€ä¸ªstringï¼Œæˆ‘è‡ªç„¶ä¸å¯ä»¥å®ƒèº«ä¸Šè®°å½•è¿™ä¸ªç¼–è¾‘ä¸å¦çš„çŠ¶æ€ã€‚åæ¥æƒ³ç€èƒ½ä¸èƒ½æŠŠè¿™ä¸ªçŠ¶æ€å­˜åœ¨pathçš„protperty drawerä¸Šã€‚é—®äº†ä¸‹å¯¼å¸ˆï¼Œå¯è¡Œï¼Œä½†æ˜¯æ²¡æ³•ç›´æ¥å­˜ã€‚</p>
<h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>åˆ›å»ºä¸€ä¸ªobjectå­˜å‚¨è¿™ä¸ªçŠ¶æ€ï¼Œè¿™ä¸ªobjectå­˜å…¥editorçš„state objecté‡Œã€‚<br>åœ¨Property drawerè¿›è¡Œç»˜åˆ¶çš„æ—¶å€™è·å–/æ›´æ–°è¿™ä¸ªobjectã€‚</p>
<h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><p>ä»£ç å¾ˆç®€å•</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UITagDrawer</span> : <span class="title">PropertyDrawer</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// the object for string state</span></span><br><span class="line">    <span class="keyword">class</span> <span class="title">EditingState</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">bool</span> IsEditing = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnGUI</span>(<span class="params">Rect position, SerializedProperty property, GUIContent label</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">/***/</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// get state object</span></span><br><span class="line">        EditingState state = GUIUtility.GetStateObject(<span class="keyword">typeof</span>(EditingState), GUIUtility.GetControlID(FocusType.Passive)) <span class="keyword">as</span> EditingState;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">using</span> (<span class="keyword">new</span> EditorGUILayout.HorizontalScope(style))</span><br><span class="line">        &#123;</span><br><span class="line">            Rect editButtonRect = <span class="keyword">new</span> Rect(position.x, position.y, <span class="number">16f</span>, <span class="number">16f</span>);</span><br><span class="line">            <span class="keyword">if</span> (GUI.Button(editButtonRect, <span class="string">"E"</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// well since it's a class we dun need to set it back :&gt;</span></span><br><span class="line">                state.IsEditing = !state.IsEditing;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (GUILayout.Button(<span class="string">"X"</span>, GUILayout.Width(<span class="number">18</span>)))</span><br><span class="line">            &#123;</span><br><span class="line">                state.IsEditing = !state.IsEditing;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (state.IsEditing)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// show text field</span></span><br><span class="line">                tagStr = EditorGUILayout.TextField(tagStr);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// show lable</span></span><br><span class="line">                EditorGUILayout.LabelField(tagStr);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>UnityEditor</category>
      </categories>
      <tags>
        <tag>Unity</tag>
        <tag>UnityEditor</tag>
      </tags>
  </entry>
  <entry>
    <title>æŸ¥è¯¢Assetåœ¨å·¥ç¨‹ä¸­çš„å¼•ç”¨(GUID)</title>
    <url>/2022/09/12/20220912-unity-findref-guid/</url>
    <content><![CDATA[<p>ä¹‹å‰æˆ‘ç”¨Unityè‡ªå¸¦çš„APIå»æŸ¥è¯¢ä¸€äº›ç‰©ä½“çš„å¼•ç”¨ï¼Œç»“æœå½“ç„¶æ˜¯è¶…è¶…è¶…è¶…è¶…çº§æ…¢ï¼Œå¯¹äºé‚£äº›æŠŠé¡¹ç›®å·¥ç¨‹æ”¾åœ¨è¾£é¸¡æœºæ¢°ç›˜ä¸Šçš„åŒäº‹ï¼Œè¿™ä¸ªå·¥å…·æ ¹æœ¬æ˜¯æ²¡æ³•å¥½å¥½ç”¨çš„ã€‚è€Œä¸”å› ä¸ºè¦ç”¨Unityçš„APiï¼Œè‡ªç„¶æ˜¯æ²¡åŠæ³•ä½¿ç”¨asyncçš„ã€‚</p>
<p>æœ€è¿‘å¯¼å¸ˆæ‹¿åˆ°QAé‚£è¾¹æä¾›çš„ä¸€ä¸ªç±»ä¼¼çš„å·¥å…·ï¼Œæ”¹äº†ä¸€ä¸‹ï¼Œåšäº†ä¸€ä¸ªè¶…çº§å¿«çš„ç‰ˆæœ¬ã€‚</p>
<h1 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h1><p>æ€è·¯å…¶å®æ˜¯éå¸¸ç®€å•çš„ã€‚æˆ‘ä»¬çŸ¥é“Unity Assetä¼šæœ‰ä¸€ä¸ªå”¯ä¸€çš„GUIDï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥ç”¨è¿™ä¸ªGUIDå»æŸ¥è¯¢å…¶å¼•ç”¨ã€‚<br>æŸ¥è¯¢çš„æ—¶å€™æˆ‘ä»¬ä¹Ÿä¸éœ€è¦ä½¿ç”¨Unity APIå»æ£€æŸ¥å¼•ç”¨ï¼Œè€Œæ˜¯æŠŠæˆ‘ä»¬çš„å„ç§Assetéƒ½å½“æˆæ–‡æœ¬æ–‡ä»¶ç›´æ¥è¯»å–ï¼Œç„¶åç›´æ¥åœ¨è¿™äº›æ–‡æœ¬é‡Œå»åŒ¹é…æˆ‘ä»¬éœ€è¦æŸ¥è¯¢çš„GUIDã€‚</p>
<h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h1><figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// guidRegex just contains the asset guid</span></span><br><span class="line"><span class="function">List&lt;<span class="keyword">string</span>&gt; <span class="title">GetResult</span>(<span class="params"><span class="keyword">string</span>[] folders, Regex guidRegex</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">string</span>[] files = folders.SelectMany(folder =&gt; Directory.GetFiles(folder, <span class="string">"*"</span>SearchOption.AllDirectories)).ToArray();</span><br><span class="line">    List&lt;<span class="keyword">string</span>&gt; result = <span class="keyword">new</span> List&lt;<span class="keyword">string</span>&gt;(<span class="number">200</span>);</span><br><span class="line">    <span class="keyword">int</span> count = files.Length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">string</span> filePath = files[i];</span><br><span class="line">        <span class="keyword">if</span> (ChecKFile(filePath, guidRegex))</span><br><span class="line">        &#123;</span><br><span class="line">            result.Add(filePath);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">ChecKFile</span>(<span class="params"><span class="keyword">string</span> filepath, Regex fileContent</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">string</span> assetText = File.ReadAllText(filepath);</span><br><span class="line">    MatchCollection matches = fileContent.Matches(assetText);</span><br><span class="line">    <span class="keyword">return</span> matches.Count &gt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…³é”®ä»£ç å’ŒUnity APIæ¯«æ— å…³ç³»ï¼Œå¯ä»¥é¿å…é•¿æ—¶é—´çš„å¡æ­»ï¼Œè€Œä¸”æˆ‘ä»¬ä¹Ÿèƒ½åŠ å…¥å–æ¶ˆæœç´¢çš„åŠŸèƒ½ä¹‹ç±»çš„ã€‚å¦‚æœåœ¨ä¹æ€§èƒ½çš„è¯å¯ä»¥è¿˜å¯ä»¥åœ¨è¯»æ–‡ä»¶æ£€æŸ¥è¿™è¾¹åšä¼˜åŒ–ã€‚ä¸è¿‡æ„Ÿè§‰è¿™æ ·å·²ç»æ¯”ä¹‹å‰å¿«äº†è®¸å¤šäº†ã€‚</p>
]]></content>
      <categories>
        <category>UnityEditor</category>
      </categories>
      <tags>
        <tag>Unity</tag>
        <tag>UnityEditor</tag>
      </tags>
  </entry>
  <entry>
    <title>Rapid UI Creation Note</title>
    <url>/2022/10/05/20221005-rapid-UGUI-creation-note/</url>
    <content><![CDATA[<p>When I searching some articles about MVC and MVVM, I see this talk.<br>Basiclly they does same stuff as my current project, but we still have some differences on our implementation.<br>Iâ€™d like to share it and take some notes :D</p>
<p>Here is the talk abour UGUI implementation.<br><a href="https://www.youtube.com/watch?v=uDQU_dlO-ZM" target="_blank" rel="noopener">video</a>.<br><a href="https://www.gdcvault.com/play/1024453/Data-Binding-Architectures-for-Rapid" target="_blank" rel="noopener">ppt</a>.<br><a href="https://stackoverflow.com/questions/667781/what-is-the-difference-between-mvc-and-mvvm" target="_blank" rel="noopener">temp</a>.</p>
<h1 id="Main-note"><a href="#Main-note" class="headerlink" title="Main note"></a>Main note</h1><h2 id="Architecture-in-lt-Lost-Survivor-gt"><a href="#Architecture-in-lt-Lost-Survivor-gt" class="headerlink" title="Architecture in &lt; Lost Survivor &gt;"></a>Architecture in &lt; Lost Survivor &gt;</h2><ul>
<li>Artist works directly in Unity (Creating prefabs, setup aniamtions; well thatâ€™s what I my current project does, so I guess they did the same)</li>
<li>Dev works on GameLogic and UILogic</li>
<li>Dev/Art work decoupled</li>
<li>Dev/Art work parallel (This happens a lot in iteration)</li>
</ul>
<h2 id="The-Pattern-used-in-lt-Lost-Survivor-gt"><a href="#The-Pattern-used-in-lt-Lost-Survivor-gt" class="headerlink" title="The Pattern used in &lt; Lost Survivor &gt;"></a>The Pattern used in &lt; Lost Survivor &gt;</h2><h3 id="MVCVM-they-choose-this"><a href="#MVCVM-they-choose-this" class="headerlink" title="MVCVM (they choose this)"></a>MVCVM (they choose this)</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">                                                                                                                               </span><br><span class="line">                                                        +---------------------------------------+                              </span><br><span class="line">                                                        |                data binding           |                              </span><br><span class="line">                                                        |                    &lt;-&gt;                |                              </span><br><span class="line">                                                        |                                       |                              </span><br><span class="line">                                                        |                                       |                              </span><br><span class="line">+------------------------------+                        |                                       |                              </span><br><span class="line">|                              | +----------------------|-------+    +------------------------------+ +-----------------------+</span><br><span class="line">----------Controller------------ |         Model                |    |        View Model            | |    View (UGUI View)   |</span><br><span class="line">|                              | --------------------------------    -------------------------------- -------------------------</span><br><span class="line">| void GainXP();               | |      int XP;                 |    |                              | | Text XP;              |</span><br><span class="line">| void LevelUp();              | |      int Level;              |    |                              | | Text Attribute;       |</span><br><span class="line">|                              | |                              |    |                              | | Button ReAllocate;    |</span><br><span class="line">|                              | +--------------&#x2F;---------------+    +---------------\--------------+ | int WeaponATK;        |</span><br><span class="line">+---------------\--------------+              &#x2F;-                                      -\              |                       |</span><br><span class="line">                 \                          &#x2F;-                                          -\            +-----------&#x2F;-----------+</span><br><span class="line">                  -\                      &#x2F;-                                              \                      |             </span><br><span class="line">                    \                   &#x2F;-                                                 -\                    &#x2F;             </span><br><span class="line">            +---------------------------------------------------------------------------------------------------|-------+      </span><br><span class="line">            |                                                                                                           |      </span><br><span class="line">            |                                               Message Bus                                                 |      </span><br><span class="line">            +-----------------------------------------------------|-----------------------------------------------------+      </span><br><span class="line">                                                                  |                                                            </span><br><span class="line">                                                                  |                                                            </span><br><span class="line">                                                                  |                                                            </span><br><span class="line">                                                    +-------------|------------+                                               </span><br><span class="line">                                                    |                          |                                               </span><br><span class="line">                                                    |      server backend      |                                               </span><br><span class="line">                                                    |                          |                                               </span><br><span class="line">                                                    +--------------------------+</span><br></pre></td></tr></table></figure>
<p>This is the pattern they use for their project.<br>The one thing that I cant understand is that the View will receive events from MessageBus. IDK why they did like this. For me, I prefer to let view only receive direct events from VM, bind to many stuff to MessageBus will make it slow.</p>
<h3 id="MVC"><a href="#MVC" class="headerlink" title="MVC"></a>MVC</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">                                                                                                                                                                                                   </span><br><span class="line">                                   +------------------------------+                                    </span><br><span class="line">                                   |          Controller          |                                    </span><br><span class="line">+---------------------------------------------------------------------------------------------+        </span><br><span class="line">|         user action -&gt;           |  void GainXp();              |       update -&gt;           |        </span><br><span class="line">|                                  |  Void LevelUp();             |                           |        </span><br><span class="line">|                                  |  int GetAttribute(type);     |                           |        </span><br><span class="line">|                                  |                              |                           |        </span><br><span class="line">|                                  |                              |                           |        </span><br><span class="line">|                                  +-------|--------------|-------+                           |        </span><br><span class="line">|                                          |              |                                   |        </span><br><span class="line">|------------------------------+           |              |            +----------------------|-------+</span><br><span class="line">|    Character View            |           |              |            |         Model                |</span><br><span class="line">--------------------------------           |              |            --------------------------------</span><br><span class="line">| Text XP;                     |           |              |            | int AmountXp;                |</span><br><span class="line">| Text Attribute;              ------------+              |            | int AttributeTypeA;          |</span><br><span class="line">| Button ReAllocate;           | &lt;- update                |            | int AttributeTypeB;          |</span><br><span class="line">|                              |                          +-------------                              |</span><br><span class="line">|                              |                     &lt;- notify change? |                              |</span><br><span class="line">+------------------------------+                                       +------------------------------+</span><br></pre></td></tr></table></figure>
<p>Iâ€™m sure this pattern is kind of useful. I use this a lot when I did the first version of some UI pages. But later the Controller become a giant class.<br>And also I think the View and Controller in this pattern is not very reusable.</p>
<h3 id="MVVM"><a href="#MVVM" class="headerlink" title="MVVM"></a>MVVM</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">                                                                                                                            </span><br><span class="line">                                                                                            +------------------------------+</span><br><span class="line">                                                                                            |         Model Character      |</span><br><span class="line">                                                                            +-----------------------------------------------</span><br><span class="line">                                                                            |               | int AmountXp;                |</span><br><span class="line">                                                                            |               | int AttributeTypeA;          |</span><br><span class="line">                                                                            |               | int AttributeTypeB;          |</span><br><span class="line">                                                                            |               |                              |</span><br><span class="line">                                                                            |               |                              |</span><br><span class="line">                                                                            |               +------------------------------+</span><br><span class="line">+------------------------------+                     +----------------------|-------+                                       </span><br><span class="line">|      Character View          |   data binding &lt;-&gt;  |        View Model            |                                       </span><br><span class="line">--------------------------------   notifications &lt;-  --------------------------------                                       </span><br><span class="line">| Text XP;                     |   command -&gt;        |int AmountXP;                 |                                       </span><br><span class="line">| Text Attribute;              ----------------------+int WeaponATK;                |                                       </span><br><span class="line">| Button ReAllocate;           |                     |int WeaponLevel;              |       +------------------------------+</span><br><span class="line">| int WeaponATK;               |                     |                              |       |         Model Weapon         |</span><br><span class="line">|                              |                     |                              |       --------------------------------</span><br><span class="line">+------------------------------+                     +----------------------|-------+       | int ATK;                     |</span><br><span class="line">                                                                            |               | int Level;                   |</span><br><span class="line">                                                                            +----------------                              |</span><br><span class="line">                                                                                            +------------------------------+</span><br></pre></td></tr></table></figure>
<ul>
<li>ViewModel serves the View</li>
<li>One ViewModel per View</li>
<li>Based on Data Binding</li>
</ul>
<p>After a few iterations, I find this pattern is also a good solutions. And I feel that we can even use CompositePattern in ViewModel to create big ViewModel for some big views(resuable).</p>
<p>In my current project, for the UI-View, we create some basic view that can receive similar types of data. And the good thing from this pattern is that the VM can send notificaiton to View to update, then I dun need to have lots of update method from Controller to update different data (cuz some data update need aniamtion, I cant just update all).</p>
<h2 id="Problems"><a href="#Problems" class="headerlink" title="Problems"></a>Problems</h2><p>Previously it says that separating UIPrefabs creation and UILogic code may solve â€œNot my problem attitudeâ€. But actually not.<br>In production state, everyone is busy, and we are iterating View-Scripts and VM-Scripts together. Sometimes it is diffcult to tell that is code issues or setup issues. Unless we have solid View-Scripts.</p>
<h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>This talk has lots of similiar content as the DivisionUI talk. And I also realise that the game development has lots of unknow shit. Itâ€™s very difficult to have some resuable components that always works. Even the thougts are similar, the implementation can be different. A solution can be that having some solid, simple, basic and resuable compoents.</p>
]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>Unity</tag>
        <tag>UGUI</tag>
      </tags>
  </entry>
  <entry>
    <title>æ ¹æ®ä¸€ä¸ªUIç‰©ä½“çš„ä½ç½®æ‘†æ”¾å¦ä¸€ä¸ªUIç‰©ä½“</title>
    <url>/2023/03/26/20230326-ui-element-positioning/</url>
    <content><![CDATA[<p>æœ€è¿‘åœ¨é‡åˆ°äº†ä¸€ä¸ªéœ€æ±‚ï¼Œè¦ç‚¹å‡»æŸä¸ªé“å…·UIä¹‹åï¼Œæ˜¾ç¤ºä¸€ä¸ªå°çš„å…³äºè¯¥é“å…·çš„ä¿¡æ¯æ¡†ã€‚<br>å¤§æ¦‚æ˜¯å…¥ä¸‹å›¾è¿™ä¸ªæ ·å­çš„ã€‚</p>
<img src="/2023/03/26/20230326-ui-element-positioning/20230326-pic001.png" class="" title="split">
<p>è¿˜å¥½ä¹‹å‰åšè¿‡ï¼Œäºæ˜¯ä¹ç›´æ¥ä¿®ä¿®è¡¥è¡¥è…¾è¿‡å»ã€‚è‡³äºä¸ºä»€ä¹ˆè¦ä¿®è¡¥ï¼Œæ˜¯å› ä¸ºåœ¨ä¹‹å‰çš„é¡¹ç›®é‡Œè™½ç„¶å†™äº†ä¸€äº›å’ŒRectTransformç›¸å…³çš„ä¸€äº›utilsï¼Œä½†éƒ½å› ä¸ºæ‡’å’Œèœï¼Œæ²¡æœ‰å»ç»´æŠ¤ã€‚æœ‰é‡å¤çš„æ–¹æ³•è¿˜æœ‰é”™è¯¯çš„æ–¹æ³•ï¼Œéº»äº†ã€‚<br>è¿™æ¬¡è¯´æ˜¯ä¿®è¡¥ï¼Œä¹Ÿç¨å¾®é‡å†™äº†ä¸€äº›å’ŒRectTransformç›¸å…³çš„ä¸€äº›utils,ä¹Ÿå‡†å¤‡å¸¦è¿›é¡¹ç›®é‡Œçœ‹çœ‹æœ‰æ²¡æœ‰åœ°æ–¹å¯ä»¥ç”¨çš„ã€‚</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Temp</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">enum</span> RectPositionType</span><br><span class="line">    &#123;</span><br><span class="line">        Center = <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line">        Top = <span class="number">1</span>,</span><br><span class="line">        Bottom = <span class="number">2</span>,</span><br><span class="line">        Left = <span class="number">3</span>,</span><br><span class="line">        Right = <span class="number">4</span>,</span><br><span class="line"></span><br><span class="line">        TopLeft = <span class="number">5</span>,</span><br><span class="line">        TopRight = <span class="number">6</span>,</span><br><span class="line"></span><br><span class="line">        BottomLeft = <span class="number">7</span>,</span><br><span class="line">        BottomRight = <span class="number">8</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UIElementPositionSetter</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">    &#123;</span><br><span class="line">        [<span class="meta">Header(<span class="meta-string">"target ui position"</span>)</span>]</span><br><span class="line">        [<span class="meta">SerializeField</span>]</span><br><span class="line">        <span class="keyword">private</span> RectPositionType _targetRectPosition = RectPositionType.Center;</span><br><span class="line">        [<span class="meta">SerializeField</span>]</span><br><span class="line">        <span class="keyword">private</span> Vector2 _targetPivot = Vector2.zero;</span><br><span class="line">        [<span class="meta">SerializeField</span>]</span><br><span class="line">        <span class="keyword">private</span> Vector2 _extraOffset = Vector2.zero;</span><br><span class="line">        [<span class="meta">SerializeField</span>]</span><br><span class="line">        <span class="keyword">private</span> RectOffset _adaptionOffset;</span><br><span class="line">        [<span class="meta">SerializeField</span>]</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">bool</span> _doScreenAdaption;</span><br><span class="line"></span><br><span class="line">        [<span class="meta">Header(<span class="meta-string">"other setting"</span>)</span>]</span><br><span class="line">        [<span class="meta">SerializeField</span>]</span><br><span class="line">        <span class="keyword">private</span> RectTransform _defaultBoundsCanvasTransform;</span><br><span class="line">        [<span class="meta">SerializeField</span>]</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">bool</span> _adjustHorizontal = <span class="literal">true</span>;</span><br><span class="line">        [<span class="meta">SerializeField</span>]</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">bool</span> _adjustVertical = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> position util</span></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Vector2 <span class="title">GetLocalRectPosition</span>(<span class="params">RectTransform target, RectPositionType offsetType</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">return</span> GetLocalRectPosition(target, offsetType, Vector2.zero);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Vector2 <span class="title">GetLocalRectPosition</span>(<span class="params">RectTransform target, RectPositionType offsetType, Vector2 offset</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">return</span> GetLocalRectPosition(target.rect.size, target.pivot, offsetType, offset);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Vector2 <span class="title">GetLocalRectPosition</span>(<span class="params">Vector2 targetSize, Vector2 targetPivot, RectPositionType offsetType, Vector2 offset</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            Vector2 bottomLeft = Vector2.zero;</span><br><span class="line">            bottomLeft.x -= targetPivot.x * targetSize.x;</span><br><span class="line">            bottomLeft.y -= targetPivot.y * targetSize.y;</span><br><span class="line">            Vector2 result = bottomLeft;</span><br><span class="line">            <span class="keyword">switch</span> (offsetType)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">case</span> RectPositionType.Top:</span><br><span class="line">                    result += Vector2.right * <span class="number">0.5f</span> * targetSize.x + Vector2.up * targetSize.y;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> RectPositionType.Bottom:</span><br><span class="line">                    result += Vector2.right * <span class="number">0.5f</span> * targetSize.x;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> RectPositionType.Left:</span><br><span class="line">                    result += Vector2.up * <span class="number">0.5f</span> * targetSize.y;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> RectPositionType.Right:</span><br><span class="line">                    result += Vector2.right * targetSize.x + Vector2.up * <span class="number">0.5f</span> * targetSize.y;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> RectPositionType.TopLeft:</span><br><span class="line">                    result += Vector2.up * targetSize.y;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> RectPositionType.TopRight:</span><br><span class="line">                    result += Vector2.right * targetSize.x + Vector2.up * targetSize.y;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> RectPositionType.BottomRight:</span><br><span class="line">                    result += Vector2.right * targetSize.x;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> RectPositionType.BottomLeft:</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> result + offset;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Vector3 <span class="title">RectPositionToWorld</span>(<span class="params">RectTransform rect, RectPositionType offsetType</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">return</span> RectPositionToWorld(rect, offsetType, Vector2.zero);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Vector3 <span class="title">RectPositionToWorld</span>(<span class="params">RectTransform rect, RectPositionType offsetType, Vector2 offset</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">var</span> localPosition = GetLocalRectPosition(rect, offsetType, offset);</span><br><span class="line">            <span class="keyword">return</span> rect.TransformPoint(localPosition);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> Vector2 <span class="title">GetTargetRectPositionInLocalReference</span>(<span class="params">RectPositionType offsetType</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            RectTransform self = transform <span class="keyword">as</span> RectTransform;</span><br><span class="line">            Vector2 targetPivotPos = GetLocalRectPosition(self, _targetRectPosition, _extraOffset);</span><br><span class="line">            Vector2 virtualCenterPos = targetPivotPos;</span><br><span class="line">            virtualCenterPos += GetLocalRectPosition(_targetSize, _targetPivot, offsetType, Vector2.zero);</span><br><span class="line">            <span class="keyword">return</span> virtualCenterPos;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SetPosition</span>(<span class="params">RectTransform target</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            RectTransform self = transform <span class="keyword">as</span> RectTransform;</span><br><span class="line">            Vector2 spawnPos = GetLocalRectPosition(self, _targetRectPosition, _extraOffset);</span><br><span class="line">            target.pivot = _targetPivot;</span><br><span class="line">            target.position = self.TransformPoint(spawnPos);</span><br><span class="line">            <span class="keyword">if</span> (_doScreenAdaption)</span><br><span class="line">            &#123;</span><br><span class="line">                Vector3 resultPosition = GetAdjustedTargetWorldPosition(self, _defaultBoundsCanvasTransform, _adaptionOffset, target.rect.size, _targetPivot, _extraOffset);</span><br><span class="line">                target.position = resultPosition;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="spawnReference"&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="boundTransform"&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="targetSize"&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="targetPivot"&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>target pivot world position<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> Vector3 <span class="title">GetAdjustedTargetWorldPosition</span>(<span class="params">RectTransform spawnReference, RectTransform boundTransform, RectOffset boundOffset, Vector2 targetSize, Vector2 targetPivot, Vector2 extraOffset</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            Vector2 pivotPos = GetAdjustedTargetLocalPositionFromSpawnReference(spawnReference, boundTransform, boundOffset, targetSize, targetPivot, extraOffset);</span><br><span class="line">            Vector3 result = spawnReference.TransformPoint(pivotPos);</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="spawnReference"&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="boundTransform"&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="targetSize"&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="targetPivot"&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>target pivot position in spawnRefernce local space<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> Vector2 <span class="title">GetAdjustedTargetLocalPositionFromSpawnReference</span>(<span class="params">RectTransform spawnReference, RectTransform boundTransform, RectOffset boundOffset, Vector2 targetSize, Vector2 targetPivot, Vector2 extraOffset</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            Vector2 targetPivotInSpawner = GetLocalRectPosition(spawnReference, _targetRectPosition);</span><br><span class="line">            targetPivotInSpawner += extraOffset;</span><br><span class="line"></span><br><span class="line">            Vector2 targetLeftInSpawner = targetPivotInSpawner;</span><br><span class="line">            targetLeftInSpawner.x -= targetPivot.x * targetSize.x;</span><br><span class="line">            targetLeftInSpawner.y -= (targetPivot.y - <span class="number">0.5f</span>) * targetSize.y;</span><br><span class="line"></span><br><span class="line">            Vector2 targetRightInSpawner = targetLeftInSpawner;</span><br><span class="line">            targetRightInSpawner.x += targetSize.x;</span><br><span class="line"></span><br><span class="line">            Vector2 targetTopInSpawner = targetLeftInSpawner;</span><br><span class="line">            targetTopInSpawner.x += targetSize.x * <span class="number">0.5f</span>;</span><br><span class="line">            targetTopInSpawner.y += targetSize.y * <span class="number">0.5f</span>;</span><br><span class="line"></span><br><span class="line">            Vector2 targetBottomInSpawner = targetTopInSpawner;</span><br><span class="line">            targetBottomInSpawner.y -= targetSize.y;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (_doScreenAdaption)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// do adaption</span></span><br><span class="line">                <span class="keyword">if</span> (boundTransform != <span class="literal">null</span>) <span class="comment">// then we consider the bound size as screen size</span></span><br><span class="line">                &#123;</span><br><span class="line">                    RectTransform outterBoundRectTransform = boundTransform;</span><br><span class="line">                    Matrix4x4 worldToBoundLocal = outterBoundRectTransform.worldToLocalMatrix;</span><br><span class="line">                    Vector2 boundLocalLeftPoint = GetLocalRectPosition(outterBoundRectTransform, RectPositionType.Left);</span><br><span class="line">                    boundLocalLeftPoint.x += _adaptionOffset.left;</span><br><span class="line">                    Vector2 boundLocalRightPoint = GetLocalRectPosition(outterBoundRectTransform, RectPositionType.Right);</span><br><span class="line">                    boundLocalRightPoint.x -= _adaptionOffset.right;</span><br><span class="line">                    Vector2 boundLocalTopPoint = GetLocalRectPosition(outterBoundRectTransform, RectPositionType.Top);</span><br><span class="line">                    boundLocalTopPoint.y -= _adaptionOffset.top;</span><br><span class="line">                    Vector2 boundLocalBottomPoint = GetLocalRectPosition(outterBoundRectTransform, RectPositionType.Bottom);</span><br><span class="line">                    boundLocalBottomPoint.y += _adaptionOffset.bottom;</span><br><span class="line"></span><br><span class="line">                    Vector2 targetLeftInBound = worldToBoundLocal.MultiplyPoint(spawnReference.TransformPoint(targetLeftInSpawner));</span><br><span class="line">                    <span class="keyword">bool</span> leftOut = targetLeftInBound.x &lt; boundLocalLeftPoint.x;</span><br><span class="line">                    Vector2 targetRightInbound = worldToBoundLocal.MultiplyPoint(spawnReference.TransformPoint(targetRightInSpawner));</span><br><span class="line">                    <span class="keyword">bool</span> rightOut = targetRightInbound.x &gt; boundLocalRightPoint.x;</span><br><span class="line">                    Vector2 targetTopInBound = worldToBoundLocal.MultiplyPoint(spawnReference.TransformPoint(targetTopInSpawner));</span><br><span class="line">                    <span class="keyword">bool</span> topOut = targetTopInBound.y &gt; boundLocalTopPoint.y;</span><br><span class="line">                    Vector2 targetBottomInBound = worldToBoundLocal.MultiplyPoint(spawnReference.TransformPoint(targetBottomInSpawner));</span><br><span class="line">                    <span class="keyword">bool</span> bottomOut = targetBottomInBound.y &lt; boundLocalBottomPoint.y;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">//string localBoundPosStr = $"check bound local bound pos left_&#123;boundLocalLeftPoint&#125; right_&#123;boundLocalRightPoint&#125; top_&#123;boundLocalTopPoint&#125; bottom_&#123;boundLocalBottomPoint&#125;";</span></span><br><span class="line">                    <span class="comment">//string targetLocalPosStr = $"check target in bound pos left_&#123;targetLeftInBound&#125; right_&#123;targetRightInbound&#125; top_&#123;targetTopInBound&#125; bottom_&#123;targetBottomInBound&#125;";</span></span><br><span class="line">                    <span class="comment">//string checkResult = $"check result leftOut_&#123;leftOut&#125; rightOut_&#123;rightOut&#125; topOut_&#123;topOut&#125; bottomOut_&#123;bottomOut&#125;";</span></span><br><span class="line">                    <span class="comment">//Debug.Log($"&#123;localBoundPosStr&#125;\n&#123;targetLocalPosStr&#125;\n&#123;checkResult&#125;");</span></span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (_adjustHorizontal)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">if</span> (leftOut &amp;&amp; rightOut)</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="comment">// bound too small</span></span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span></span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="keyword">float</span> xDelta = <span class="number">0f</span>;</span><br><span class="line">                            <span class="keyword">if</span> (leftOut)</span><br><span class="line">                            &#123;</span><br><span class="line">                                xDelta = targetLeftInBound.x - boundLocalLeftPoint.x;</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">if</span> (rightOut)</span><br><span class="line">                            &#123;</span><br><span class="line">                                xDelta = targetRightInbound.x - boundLocalRightPoint.x;</span><br><span class="line">                            &#125;</span><br><span class="line">                            targetPivotInSpawner -= Vector2.right * xDelta;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (_adjustVertical)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">if</span> (topOut &amp;&amp; bottomOut)</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="comment">// bound too small</span></span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span></span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="keyword">float</span> yDelta = <span class="number">0f</span>;</span><br><span class="line">                            <span class="keyword">if</span> (topOut)</span><br><span class="line">                            &#123;</span><br><span class="line">                                yDelta = targetTopInBound.y - boundLocalTopPoint.y;</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">if</span> (bottomOut)</span><br><span class="line">                            &#123;</span><br><span class="line">                                yDelta = targetBottomInBound.y - boundLocalBottomPoint.y;</span><br><span class="line">                            &#125;</span><br><span class="line">                            targetPivotInSpawner -= Vector2.up * yDelta;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> targetPivotInSpawner;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> UNITY_EDITOR</span></span><br><span class="line"></span><br><span class="line">        [<span class="meta">Header(<span class="meta-string">"target preview"</span>)</span>]</span><br><span class="line">        [<span class="meta">SerializeField</span>]</span><br><span class="line">        <span class="keyword">private</span> Vector2 _targetSize = Vector2.one * <span class="number">128f</span>;</span><br><span class="line">        [<span class="meta">SerializeField</span>]</span><br><span class="line">        <span class="keyword">private</span> Color _previewBoundColor = Color.yellow;</span><br><span class="line">        [<span class="meta">SerializeField</span>]</span><br><span class="line">        <span class="keyword">private</span> Color _previewTargetColor = Color.white;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnDrawGizmosSelected</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="comment">// draw A box to show the position of target</span></span><br><span class="line">            RectTransform spawnReference = transform <span class="keyword">as</span> RectTransform;</span><br><span class="line">            Vector2 topLeftPos = GetLocalRectPosition(spawnReference, _targetRectPosition);</span><br><span class="line">            topLeftPos += _extraOffset;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (_doScreenAdaption)</span><br><span class="line">            &#123;</span><br><span class="line">                Vector2 pivotPosition = GetAdjustedTargetLocalPositionFromSpawnReference(spawnReference, _defaultBoundsCanvasTransform, _adaptionOffset, _targetSize, _targetPivot, _extraOffset);</span><br><span class="line">                pivotPosition.x -= _targetPivot.x * _targetSize.x;</span><br><span class="line">                pivotPosition.y += (<span class="number">1f</span> - _targetPivot.y) * _targetSize.y;</span><br><span class="line">                topLeftPos = pivotPosition;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// draw preview target</span></span><br><span class="line">            DrawBox(spawnReference, topLeftPos, _targetSize, _previewTargetColor);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// draw preview bound</span></span><br><span class="line">            <span class="keyword">if</span> (_defaultBoundsCanvasTransform != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                Vector2 boundSize = _defaultBoundsCanvasTransform.rect.size;</span><br><span class="line">                boundSize.x -= _adaptionOffset.left + _adaptionOffset.right;</span><br><span class="line">                boundSize.y -= _adaptionOffset.top + _adaptionOffset.bottom;</span><br><span class="line">                DrawBox(_defaultBoundsCanvasTransform, GetLocalRectPosition(_defaultBoundsCanvasTransform, RectPositionType.TopLeft, <span class="keyword">new</span> Vector2(_adaptionOffset.left, -_adaptionOffset.top)), boundSize, _previewBoundColor);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">DrawBox</span>(<span class="params">RectTransform reference, Vector2 topLeftLocalPos, Vector2 size, Color color</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            Color cachedColor = Gizmos.color;</span><br><span class="line">            Gizmos.color = color;</span><br><span class="line">            Gizmos.DrawLine(reference.TransformPoint(topLeftLocalPos), reference.TransformPoint(topLeftLocalPos + Vector2.right * size.x));</span><br><span class="line">            Gizmos.DrawLine(reference.TransformPoint(topLeftLocalPos), reference.TransformPoint(topLeftLocalPos + Vector2.down * size.y));</span><br><span class="line">            Gizmos.DrawLine(reference.TransformPoint(topLeftLocalPos + Vector2.right * size.x), reference.TransformPoint(topLeftLocalPos + Vector2.right * size.x + Vector2.down * size.y));</span><br><span class="line">            Gizmos.DrawLine(reference.TransformPoint(topLeftLocalPos + Vector2.down * size.y), reference.TransformPoint(topLeftLocalPos + Vector2.right * size.x + Vector2.down * size.y));</span><br><span class="line">            Gizmos.color = cachedColor;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<img src="/2023/03/26/20230326-ui-element-positioning/20230326-pic002.gif" class="" title="split">
<p>è¿˜æ˜¯åƒä»¥å‰ä¸€æ ·ï¼Œå…ˆåœ¨debug drawé‡ŒæŠŠåŠŸèƒ½å®Œæˆå†ç»™ç§»åˆ°å®é™…çš„ç‰©ä½“ä¸Šã€‚<br>ä½†è¿™æ¬¡è¿˜æ˜¯å¾ˆå¯æƒœæ²¡æœ‰æŠŠåŠŸèƒ½å¾ˆå¥½æŠ½å‡ºæˆæ¯”è¾ƒå•ç‹¬çš„æ•°å­¦è¿ç®—ï¼Œè€Œä¸”æ„Ÿè§‰è¦ç”¨åˆ°çš„å‚æ•°å¥½å¤šä¹Ÿæ²¡æ³•æ‹†åˆ†ï¼Œæœ€åç•™äº†ä¸€ä¸ªå¤šå‚çš„å…¥å£ã€‚</p>
]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>Unity</tag>
        <tag>UGUI</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2022/06/12/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html" target="_blank" rel="noopener">Deployment</a></p>
]]></content>
  </entry>
  <entry>
    <title>ä¼ å…¥Predicateçš„å°äº‹</title>
    <url>/2023/05/01/20230501-list-pass-predicate/</url>
    <content><![CDATA[<p>ç°åœ¨ä¾æ—§æ˜¯åœ¨é¡¹ç›®é‡Œè´Ÿè´£ä¸€äº›UIä¸šåŠ¡çš„ç¼–å†™ã€‚å‰æ®µæ—¶é—´éœ€è¦éœ€è¦ç»™æ¸¸æˆä¸­çš„ popupæç¤º åšä¸€äº›ç®€å•çš„é‡æ„ï¼Œæ­£å¥½å‘ç°äº†æˆ‘ä¸€ç›´ä»¥æ¥éƒ½è¯¯è§£çš„ä¸€ä¸ªå°ç‚¹ï¼Œå†³å®šè®°ä¸‹æ¥ã€‚</p>
<p>ä¸šåŠ¡çš„è¦æ±‚å°±æ˜¯åšé‚£ç§ä¼šå¼¹å‡ºæ¥ä¸€ä¼šå„¿å†æ¶ˆå¤±çš„æç¤ºï¼Œæ¯”å¦‚é“å…·è·å–ä¹‹ç±»çš„UIã€‚</p>
<p>æˆ‘çš„åšæ³•å°±æ˜¯ç”¨ä¸€ä¸ªlistå»å­˜ç€å½“å‰çš„æç¤ºï¼Œå¹¶ tick æ£€æŸ¥å®ƒä»¬æ˜¯å¦ç»“æŸï¼Œç„¶åç§»é™¤å·²ç»ç»“æŸçš„ç›¸å…³æ•°æ®ã€‚<br>å¤§æ¦‚çš„ç”¨æ³•å¦‚ä¸‹ã€‚</p>
<img src="/2023/05/01/20230501-list-pass-predicate/20230501-pic001.png" class="" title="split">
<p>ä½†å…¶å®å•Šï¼Œè¿™ä¸ªåšæ³•åœ¨ tick æ˜¯éå¸¸ä¸å¥½çš„ã€‚åŒäº‹å¾ˆå¿«åœ°é€šè¿‡ JetBrainsRider æŸ¥çœ‹ IL Code ï¼Œå¹¶å‘Šè¯‰æˆ‘ï¼Œç›´æ¥è¿™æ ·ä¼ å…¥ä¼šæ¯æ¬¡éƒ½ new obj ã€‚æœ‰æ¯”è¾ƒå¤§çš„æ¶ˆè€—ã€‚<br>æ‰€ä»¥åœ¨è¿™ç§éœ€è¦<strong>ç»å¸¸</strong> tick å¹¶ä¸”æ¡ä»¶<strong>æ¯”è¾ƒå›ºå®š</strong>çš„æƒ…å†µä¸‹ã€‚æˆ‘ä»¬å¯ä»¥åˆ›å»ºå¥½ predicate ç„¶åç›´æ¥é‡å¤ä½¿ç”¨(å¯ä»¥å­˜åœ¨æˆå‘˜å˜é‡é‡Œï¼Œè¿™é‡Œæ¼”ç¤ºå°±ç›´æ¥å­˜åœ¨æœ¬åœ°å˜é‡é‡Œäº†)ã€‚</p>
<img src="/2023/05/01/20230501-list-pass-predicate/20230501-pic002.png" class="" title="split">
<p>æœ€åé™„ä¸Šæµ‹è¯•ä»£ç å’Œç»“æœ æµ‹è¯• count ä¸º 100000</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">PredicateTempTest</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">struct</span> TempPack</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">int</span> tempValue;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> Random s_random = <span class="keyword">new</span> Random(DateTime.Now.Millisecond);</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> TempPack <span class="title">CreateTempPack</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            TempPack pack = <span class="keyword">default</span>;</span><br><span class="line">            <span class="keyword">if</span> (s_random == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                s_random = <span class="keyword">new</span> Random(DateTime.Now.Millisecond);</span><br><span class="line">            &#125;</span><br><span class="line">            pack.tempValue = s_random.Next(<span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line">            <span class="keyword">return</span> pack;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> List&lt;List&lt;TempPack&gt;&gt; s_tempListContainer = <span class="keyword">new</span> List&lt;List&lt;TempPack&gt;&gt;(<span class="number">10000</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">DoTest</span>(<span class="params"><span class="keyword">int</span> tempCount</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        FillTestData(tempCount);</span><br><span class="line">        DoTestLambda();</span><br><span class="line">        DoTestPassMethod();</span><br><span class="line">        DoTestPassExistPredicate();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">FillTestData</span>(<span class="params"><span class="keyword">int</span> tempCount</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        s_tempListContainer.Clear();</span><br><span class="line">        s_tempListContainer.Capacity = tempCount;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tempCount; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            List&lt;TempPack&gt; tempList = <span class="keyword">new</span> List&lt;TempPack&gt;(tempCount);</span><br><span class="line">            s_tempListContainer.Add(tempList);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; tempCount; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                tempList.Add(TempPack.CreateTempPack());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">DoTestLambda</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">""</span>);</span><br><span class="line">        Console.WriteLine(<span class="string">"TestLambda start"</span>);</span><br><span class="line">        Stopwatch stopWatch = <span class="keyword">new</span> Stopwatch();</span><br><span class="line">        stopWatch.Start();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, containerSize = s_tempListContainer.Count; i &lt; containerSize; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            List&lt;TempPack&gt; tempList = s_tempListContainer[i];</span><br><span class="line">            tempList.Find((existPack) =&gt; existPack.tempValue % <span class="number">5</span> == <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        stopWatch.Stop();</span><br><span class="line">        Console.WriteLine(<span class="string">$"TestLambda end, result_<span class="subst">&#123;stopWatch.ElapsedMilliseconds&#125;</span>ms"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">DoTestPassMethod</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">""</span>);</span><br><span class="line">        Console.WriteLine(<span class="string">"PassMethod start"</span>);</span><br><span class="line">        Stopwatch stopWatch = <span class="keyword">new</span> Stopwatch();</span><br><span class="line">        stopWatch.Start();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, containerSize = s_tempListContainer.Count; i &lt; containerSize; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            List&lt;TempPack&gt; tempList = s_tempListContainer[i];</span><br><span class="line">            tempList.Find(CheckPack);</span><br><span class="line">        &#125;</span><br><span class="line">        stopWatch.Stop();</span><br><span class="line">        Console.WriteLine(<span class="string">$"PassMethod end, result_<span class="subst">&#123;stopWatch.ElapsedMilliseconds&#125;</span>ms"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">DoTestPassExistPredicate</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">""</span>);</span><br><span class="line">        Console.WriteLine(<span class="string">"PassExistPredicate start"</span>);</span><br><span class="line">        Stopwatch stopWatch = <span class="keyword">new</span> Stopwatch();</span><br><span class="line">        stopWatch.Start();</span><br><span class="line">        Predicate&lt;TempPack&gt; predicate = <span class="keyword">new</span> Predicate&lt;TempPack&gt;(CheckPack);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, containerSize = s_tempListContainer.Count; i &lt; containerSize; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            List&lt;TempPack&gt; tempList = s_tempListContainer[i];</span><br><span class="line">            tempList.Find(predicate);</span><br><span class="line">        &#125;</span><br><span class="line">        stopWatch.Stop();</span><br><span class="line">        Console.WriteLine(<span class="string">$"PassExistPredicate end, result_<span class="subst">&#123;stopWatch.ElapsedMilliseconds&#125;</span>ms"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">bool</span> <span class="title">CheckPack</span>(<span class="params">TempPack pack</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> pack.tempValue % <span class="number">5</span> == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<img src="/2023/05/01/20230501-list-pass-predicate/20230501-pic003.png" class="" title="split">]]></content>
      <categories>
        <category>CSharp</category>
      </categories>
      <tags>
        <tag>CSharp</tag>
      </tags>
  </entry>
</search>
